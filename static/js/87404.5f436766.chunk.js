"use strict";(self.webpackChunkhelloworld=self.webpackChunkhelloworld||[]).push([[87404],{65023:(e,t,r)=>{r.d(t,{A:()=>f});var o=r(35143),l=r(39356),n=r(91967),i=r(18690),a=r(69098),u=r(19276),s=r(5632),d=r(50346),y=r(68134),p=r(46053),h=(r(81806),r(76460),r(85842)),c=r(58289),v=r(9912),_=r(3320);let b=class extends((0,a.O)((0,s.sA)(n.A))){constructor(e){super(e),this._loaded=!1,this._queryAbortController=null,this._queryPageAbortController=null,this._queryFeatureCountAbortController=null,this.featuresPerPage=10,this.description=null,this.graphic=null,this.layer=null,this.map=null,this.orderByFields=null,this.featureCount=0,this.relationshipId=null,this.showAllEnabled=!1,this.title=null,this._cancelQuery=()=>{const{_queryAbortController:e}=this;e&&e.abort(),this._queryAbortController=null},this._cancelQueryFeatureCount=()=>{const{_queryFeatureCountAbortController:e}=this;e&&e.abort(),this._queryFeatureCountAbortController=null},this._cancelQueryPage=()=>{const{_queryPageAbortController:e}=this;e&&e.abort(),this._queryPageAbortController=null},this._queryController=async()=>{this._cancelQuery();const e=new AbortController;this._queryAbortController=e,await(0,d.QZ)(this._query()),this._queryAbortController===e&&(this._queryAbortController=null)},this._queryFeatureCountController=async()=>{this._loaded=!1,this._cancelQueryFeatureCount();const e=new AbortController;this._queryFeatureCountAbortController=e,await(0,d.QZ)(this._queryFeatureCount()),this._queryFeatureCountAbortController===e&&(this._queryFeatureCountAbortController=null),this._loaded=!0},this._queryPageController=async()=>{const e=new AbortController;this._queryPageAbortController=e,await(0,d.QZ)(this._queryPage()),this._queryPageAbortController===e&&(this._queryPageAbortController=null)},this._queryDebounced=(0,d.sg)(this._queryController,100),this._queryFeatureCountDebounced=(0,d.sg)(this._queryFeatureCountController,100),this._queryPageDebounced=(0,d.sg)(this._queryPageController,100),this._query=async()=>{const{_queryAbortController:e,relatedFeatures:t}=this;this.featureCount&&(this._destroyRelatedFeatureViewModels(),this.featurePage=1,t.removeAll(),this.destroyed||t.addMany(this._sliceFeatures(await this._queryRelatedFeatures({signal:null===e||void 0===e?void 0:e.signal}))))},this.addHandles([(0,y.watch)((()=>{var e;return[this.displayCount,this.graphic,this.layer,null===(e=this.layer)||void 0===e?void 0:e.loaded,this.map,this.orderByFields,this.relationshipId,this.featuresPerPage,this.showAllEnabled,this.canQuery,this.featureCount]}),(()=>this._queryDebounced()),y.initial),(0,y.watch)((()=>[this.featurePage,this.showAllEnabled]),(()=>this._queryPageDebounced())),(0,y.watch)((()=>[this.layer,this.relationshipId,this.objectId,this.canQuery]),(()=>this._queryFeatureCountDebounced()))])}destroy(){this._destroyRelatedFeatureViewModels(),this.relatedFeatures.removeAll(),this._cancelQuery(),this._cancelQueryFeatureCount(),this._cancelQueryPage()}set featurePage(e){const{featuresPerPage:t,featureCount:r}=this,o=Math.ceil(r/t)||1;this._set("featurePage",Math.min(Math.max(e,1),o))}get featurePage(){return this._get("featurePage")}get orderByFieldsFixedCasing(){const{orderByFields:e,relatedLayer:t}=this;return e&&null!==t&&void 0!==t&&t.loaded?e.map((e=>{const r=e.clone();return r.field=(0,v.A4)(e.field,t),r})):null!==e&&void 0!==e?e:[]}get supportsCacheHint(){var e;return!(null===(e=this.layer)||void 0===e||null===(e=e.capabilities)||void 0===e||null===(e=e.queryRelated)||void 0===e||!e.supportsCacheHint)}get canLoad(){return!!this.map&&"number"==typeof this.relationshipId&&"number"==typeof this.objectId}get canQuery(){var e;const t=null===(e=this.layer)||void 0===e||null===(e=e.capabilities)||void 0===e?void 0:e.queryRelated;return!!(this.relatedLayer&&this.relationship&&"number"==typeof this.relationshipId&&"number"==typeof this.objectId&&null!==t&&void 0!==t&&t.supportsCount&&null!==t&&void 0!==t&&t.supportsPagination)}get itemDescriptionFieldName(){var e;return(null===(e=this.orderByFieldsFixedCasing[0])||void 0===e?void 0:e.field)||null}set displayCount(e){this._set("displayCount",Math.min(Math.max(e,0),10))}get displayCount(){return this._get("displayCount")}get objectId(){var e,t;return null!==(e=this.objectIdField&&(null===(t=this.graphic)||void 0===t||null===(t=t.attributes)||void 0===t?void 0:t[this.objectIdField]))&&void 0!==e?e:null}get objectIdField(){var e;return(null===(e=this.layer)||void 0===e?void 0:e.objectIdField)||null}get relatedFeatures(){return this._get("relatedFeatures")||new u.A}get relatedLayer(){var e;const{layer:t,map:r,relationship:o}=this;return null!==t&&void 0!==t&&t.loaded&&r&&o&&null!==(e=(0,v.cS)(r,t,o))&&void 0!==e?e:null}get relationship(){var e,t;const{relationshipId:r,layer:o}=this;return"number"==typeof r&&null!==(e=null===o||void 0===o||null===(t=o.relationships)||void 0===t?void 0:t.find((e=>{let{id:t}=e;return t===r})))&&void 0!==e?e:null}get relatedFeatureViewModels(){return this._get("relatedFeatureViewModels")||new u.A}get state(){const{_queryAbortController:e,_queryFeatureCountAbortController:t,_queryPageAbortController:r,canQuery:o,_loaded:l,canLoad:n}=this;return t||n&&!l?"loading":e||r?"querying":o?"ready":"disabled"}getRelatedFeatureByObjectId(e){return this.relatedFeatures.find((t=>t.getObjectId()===e))}refresh(){this._queryFeatureCountDebounced()}_destroyRelatedFeatureViewModels(){var e;null!==(e=this.relatedFeatureViewModels)&&void 0!==e&&e.forEach((e=>!e.destroyed&&e.destroy())),this.relatedFeatureViewModels.removeAll()}async _queryFeatureCount(){var e;const{layer:t,relatedLayer:r,relationshipId:o,objectId:l,_queryFeatureCountAbortController:n,canQuery:i,supportsCacheHint:a}=this;if(await(null===t||void 0===t?void 0:t.load()),await(null===r||void 0===r?void 0:r.load()),!i||!t||!r)return void this._set("featureCount",0);const u=r.createQuery(),s=new c.default({cacheHint:a,relationshipId:o,returnGeometry:!1,objectIds:[l],where:null!==(e=u.where)&&void 0!==e?e:void 0}),d=await t.queryRelatedFeaturesCount(s,{signal:null===n||void 0===n?void 0:n.signal});this._set("featureCount",d[l]||0)}_sliceFeatures(e){const{showAllEnabled:t,displayCount:r}=this;return t?e:r?e.slice(0,r):[]}async _queryPage(){const{relatedFeatures:e,featurePage:t,showAllEnabled:r,_queryPageAbortController:o,featureCount:l}=this;!r||t<2||!l||e.addMany(await this._queryRelatedFeatures({signal:null===o||void 0===o?void 0:o.signal}))}async _queryRelatedFeatures(e){var t,r;const{orderByFieldsFixedCasing:o,showAllEnabled:l,featuresPerPage:n,displayCount:a,layer:u,relationshipId:s,featurePage:d,featureCount:y,relatedLayer:p,supportsCacheHint:h}=this,{canQuery:v,objectId:b}=this;if(!v||!u||!p)return[];const f=l?((d-1)*n+y)%y:0,m=l?n:a,C=p.objectIdField,g=[...o.map((e=>e.field)),...(0,_.n4)(p),C].filter(i.Ru),F=o.map((e=>"".concat(e.field," ").concat(e.order))),q=p.createQuery(),A=new c.default({orderByFields:F,start:f,num:m,outFields:g,cacheHint:h,relationshipId:s,returnGeometry:!1,objectIds:[b],where:null!==(t=q.where)&&void 0!==t?t:void 0}),M=(null===(r=(await u.queryRelatedFeatures(A,{signal:null===e||void 0===e?void 0:e.signal}))[b])||void 0===r?void 0:r.features)||[];return M.forEach((e=>{e.sourceLayer=p,e.layer=p})),M}};(0,o._)([(0,p.MZ)()],b.prototype,"_loaded",void 0),(0,o._)([(0,p.MZ)()],b.prototype,"_queryAbortController",void 0),(0,o._)([(0,p.MZ)()],b.prototype,"_queryPageAbortController",void 0),(0,o._)([(0,p.MZ)()],b.prototype,"_queryFeatureCountAbortController",void 0),(0,o._)([(0,p.MZ)({value:1})],b.prototype,"featurePage",null),(0,o._)([(0,p.MZ)()],b.prototype,"featuresPerPage",void 0),(0,o._)([(0,p.MZ)({readOnly:!0})],b.prototype,"orderByFieldsFixedCasing",null),(0,o._)([(0,p.MZ)({readOnly:!0})],b.prototype,"supportsCacheHint",null),(0,o._)([(0,p.MZ)({readOnly:!0})],b.prototype,"canLoad",null),(0,o._)([(0,p.MZ)({readOnly:!0})],b.prototype,"canQuery",null),(0,o._)([(0,p.MZ)()],b.prototype,"description",void 0),(0,o._)([(0,p.MZ)({readOnly:!0})],b.prototype,"itemDescriptionFieldName",null),(0,o._)([(0,p.MZ)({value:3})],b.prototype,"displayCount",null),(0,o._)([(0,p.MZ)({type:l.A})],b.prototype,"graphic",void 0),(0,o._)([(0,p.MZ)()],b.prototype,"layer",void 0),(0,o._)([(0,p.MZ)()],b.prototype,"map",void 0),(0,o._)([(0,p.MZ)({readOnly:!0})],b.prototype,"objectId",null),(0,o._)([(0,p.MZ)({readOnly:!0})],b.prototype,"objectIdField",null),(0,o._)([(0,p.MZ)()],b.prototype,"orderByFields",void 0),(0,o._)([(0,p.MZ)({readOnly:!0})],b.prototype,"relatedFeatures",null),(0,o._)([(0,p.MZ)({readOnly:!0})],b.prototype,"relatedLayer",null),(0,o._)([(0,p.MZ)({readOnly:!0})],b.prototype,"relationship",null),(0,o._)([(0,p.MZ)()],b.prototype,"featureCount",void 0),(0,o._)([(0,p.MZ)({readOnly:!0})],b.prototype,"relatedFeatureViewModels",null),(0,o._)([(0,p.MZ)()],b.prototype,"relationshipId",void 0),(0,o._)([(0,p.MZ)()],b.prototype,"showAllEnabled",void 0),(0,o._)([(0,p.MZ)()],b.prototype,"state",null),(0,o._)([(0,p.MZ)()],b.prototype,"title",void 0),b=(0,o._)([(0,h.$)("esri.widgets.Feature.FeatureRelationship.FeatureRelationshipViewModel")],b);const f=b},3320:(e,t,r)=>{r.d(t,{CG:()=>_,CU:()=>I,DN:()=>b,Et:()=>p,Gq:()=>A,HG:()=>F,Iy:()=>m,Kl:()=>H,Kn:()=>D,LZ:()=>P,Ve:()=>Z,X6:()=>M,XI:()=>g,bx:()=>c,cU:()=>C,jt:()=>v,lB:()=>L,l_:()=>R,n4:()=>Q,nT:()=>h,of:()=>O,qD:()=>q,rf:()=>y,tM:()=>V,uW:()=>x});r(11265);var o=r(18690),l=r(4212),n=r(88685),i=r(15142),a=r(53430),u=r(42633),s=r(20639),d=r(39348);const y=e=>"field"===(null===e||void 0===e?void 0:e.type),p=e=>"group"===(null===e||void 0===e?void 0:e.type),h=e=>"relationship"===(null===e||void 0===e?void 0:e.type),c=e=>!p(e)&&null!=e.group,v=e=>"field"===e.type,_=e=>"group"===e.type,b=e=>"relationship"===e.type,f=e=>e.reduce(((e,t)=>p(t)?[...e,...t.inputs]:[...e,t]),[]),m=e=>f(e).filter(y),C=e=>f(e).filter(h),g=e=>null!=e&&(F(e,"combo-box")||F(e,"radio-buttons")),F=(e,t)=>{var r;return null!=e&&(null===(r=e.input)||void 0===r?void 0:r.type)===t},q=e=>null!=e&&(F(e,"text-box")||F(e,"text-area")),A=e=>{let{domain:t,inputType:r="text-box",dataType:o}=e;return"number"===o&&"text-box"===r&&(!t||"coded-value"!==t.type)},M=e=>"items"in e,w={typeFieldName:null,types:[]};function P(e){const{attributes:t,fieldsIndex:r,label:l,timeZone:i}=e;if(!t||"object"!=typeof t)return l;const a=Object.keys(t).filter((e=>(0,n.mk)(l,e))),u=a.map((e=>t[e])),s=a.map((e=>r.get(e))).filter(o.Ru);return function(e,t){return(0,n.HC)((0,n.HC)(e,(e=>"{".concat(e.toLowerCase(),"}"))),Object.fromEntries(Object.entries(t).map((e=>{let[t,r]=e;return[t.toLowerCase(),r]}))))}(l,Z({values:u,fields:s,timeZone:i}))}function Z(e){var t;const{fields:r,values:o}=e,l=null!==(t=e.timeZone)&&void 0!==t?t:void 0,n=r.map(((e,t)=>{let r=o[t];if(e.domain&&"coded-value"===e.domain.type){const t=e.domain.codedValues.find((e=>e.code===r));(null===t||void 0===t?void 0:t.name)&&(r=t.name)}return((0,u.fs)(e)||(0,a.OH)(e))&&(r=(0,s.ZP)(e,r,{timeZone:l,...(0,s.ZT)(e)})),[e.name,r]}));return Object.fromEntries(n)}const I=e=>{var t,r,o;return e?"subtype-sublayer"===e.type?{typeFieldName:null===(t=e.parent)||void 0===t?void 0:t.subtypeField,types:null!==(r=null===(o=e.parent)||void 0===o?void 0:o.subtypes)&&void 0!==r?r:[]}:"types"in e&&e.types?{typeFieldName:e.typeIdField,types:e.types.map((e=>{let{id:t,name:r,domains:o}=e;return{code:t,name:r,domains:o}}))}:w:w},O=(e,t)=>{if(!e)return!0;const{operations:r}=e;switch(t){case"INSERT":return r.supportsAdd;case"UPDATE":case"DELETE":return r.supportsUpdate;default:return!0}};var x;(x||(x={})).TOO_SHORT="length-validation-error::too-short";const E={type:"number"},j={type:"number",intlOptions:{notation:"scientific"}};function T(e){return e>=1e7||e<=-1e7}const V=(e,t,r)=>{const{dataType:o,error:l,minLength:n,value:u,required:y}=e,p=null===t||void 0===t?void 0:t.validationErrors;if(!p||!l)return null;if(y&&null===u)return p.cannotBeNull;if(l===i.Mh.VALUE_OUT_OF_RANGE||l===a.YF.OUT_OF_RANGE){const{field:l,range:n}=e,i={type:"date",intlOptions:{timeZone:"date"===l.type&&r?r:void 0,...(0,s.ZT)(l)}},a=function(e,t){let{validationErrors:r}=t;return null!=e.max&&null!=e.min?r.outsideRange:null!=e.max?r.outsideRangeMax:r.outsideRangeMin}(n,t);return(0,d.V)(a,n,{format:{max:"date"===o?i:null!=n.max&&T(n.max)?j:E,min:"date"===o?i:null!=n.min&&T(n.min)?j:E}})}return l===i.Mh.INVALID_CODED_VALUE?p.invalidCodedValue:l===a.iM.INVALID_TYPE?p.invalidType:l===x.TOO_SHORT?(0,d.V)(p.tooShort,{min:n}):null},R=e=>{var t;if(!e)return;const r=e.layer,o=r&&"geometryType"in r?r.geometryType:void 0,l=null===(t=e.geometry)||void 0===t?void 0:t.type;return"polyline"===l||"polyline"===o?"line":l||o||"table"},Q=e=>{const t=[];if(e.formTemplate){var r;const{description:o,title:l}=e.formTemplate;null===(r=e.fields)||void 0===r||r.forEach((e=>{const r=l&&(0,n.mk)(l,e.name),i=o&&(0,n.mk)(o,e.name);(r||i)&&t.push(e.name)}))}return t};function L(e,t){const r=null!==t&&void 0!==t?t:"formTemplate"in e&&e.formTemplate;var o,l;return!!r&&(null!==(o=null===(l=r.elements)||void 0===l?void 0:l.filter(v))&&void 0!==o?o:[]).some((t=>{let{fieldName:r}=t;return!e.fieldsIndex.get(r)}))}function D(e,t){return null==e||t.onValue!==e&&t.offValue!==e}function H(e,t){var r;switch(t.objectType){case"any":return!0;case"null":return null==e;case"code":return e===(null===(r=t.codedValue)||void 0===r?void 0:r.code);case"range":return null!=e&&null!=t.minValue&&null!=t.maxValue&&+e>=t.minValue&&+e<=t.maxValue;default:return(0,l.Xb)(t.objectType),!1}}}}]);
//# sourceMappingURL=87404.5f436766.chunk.js.map