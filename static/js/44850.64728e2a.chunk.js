"use strict";(self.webpackChunkhelloworld=self.webpackChunkhelloworld||[]).push([[44850,63733,91720],{55877:(e,t,i)=>{var o;i.d(t,{u:()=>o}),function(e){e[e.KILOBYTES=1024]="KILOBYTES",e[e.MEGABYTES=1048576]="MEGABYTES",e[e.GIGABYTES=1073741824]="GIGABYTES"}(o||(o={}))},60008:(e,t,i)=>{i.d(t,{A6:()=>g,B8:()=>u,Xd:()=>h,Xr:()=>v,Yc:()=>H,hZ:()=>y,lw:()=>p,t2:()=>S,x8:()=>d});var o=i(44680),n=i(4336),s=i(9392),r=i(53494),a=i(20664),l=i(43047);function d(e,t,i){i*=.5;const o=Math.sin(i);return e[0]=o*t[0],e[1]=o*t[1],e[2]=o*t[2],e[3]=Math.cos(i),e}function h(e,t){const i=2*Math.acos(t[3]),o=Math.sin(i/2);return o>(0,r.FD)()?(e[0]=t[0]/o,e[1]=t[1]/o,e[2]=t[2]/o):(e[0]=1,e[1]=0,e[2]=0),i}function p(e,t,i){const o=t[0],n=t[1],s=t[2],r=t[3],a=i[0],l=i[1],d=i[2],h=i[3];return e[0]=o*h+r*a+n*d-s*l,e[1]=n*h+r*l+s*a-o*d,e[2]=s*h+r*d+o*l-n*a,e[3]=r*h-o*a-n*l-s*d,e}function c(e,t,i,o){const n=t[0],s=t[1],a=t[2],l=t[3];let d,h,p,c,u,v=i[0],_=i[1],g=i[2],m=i[3];return h=n*v+s*_+a*g+l*m,h<0&&(h=-h,v=-v,_=-_,g=-g,m=-m),1-h>(0,r.FD)()?(d=Math.acos(h),p=Math.sin(d),c=Math.sin((1-o)*d)/p,u=Math.sin(o*d)/p):(c=1-o,u=o),e[0]=c*n+u*v,e[1]=c*s+u*_,e[2]=c*a+u*g,e[3]=c*l+u*m,e}function u(e,t){const i=t[0],o=t[1],n=t[2],s=t[3],r=i*i+o*o+n*n+s*s,a=r?1/r:0;return e[0]=-i*a,e[1]=-o*a,e[2]=-n*a,e[3]=s*a,e}function v(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function _(e,t){const i=t[0]+t[4]+t[8];let o;if(i>0)o=Math.sqrt(i+1),e[3]=.5*o,o=.5/o,e[0]=(t[5]-t[7])*o,e[1]=(t[6]-t[2])*o,e[2]=(t[1]-t[3])*o;else{let i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);const n=(i+1)%3,s=(i+2)%3;o=Math.sqrt(t[3*i+i]-t[3*n+n]-t[3*s+s]+1),e[i]=.5*o,o=.5/o,e[3]=(t[3*n+s]-t[3*s+n])*o,e[n]=(t[3*n+i]+t[3*i+n])*o,e[s]=(t[3*s+i]+t[3*i+s])*o}return e}function g(e,t,i,o){const n=.5*Math.PI/180;t*=n,i*=n,o*=n;const s=Math.sin(t),r=Math.cos(t),a=Math.sin(i),l=Math.cos(i),d=Math.sin(o),h=Math.cos(o);return e[0]=s*l*h-r*a*d,e[1]=r*a*h+s*l*d,e[2]=r*l*d-s*a*h,e[3]=r*l*h+s*a*d,e}const m=l.c,y=l.s,w=l.f,f=p,x=l.b,b=l.g,O=l.l,P=l.i,V=P,T=l.j,M=T,C=l.n,S=l.a,Z=l.e;function H(e,t,i){const o=(0,a.k)(t,i);return o<-.999999?((0,a.b)(A,E,t),(0,a.H)(A)<1e-6&&(0,a.b)(A,I,t),(0,a.n)(A,A),d(e,A,Math.PI),e):o>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):((0,a.b)(A,t,i),e[0]=A[0],e[1]=A[1],e[2]=A[2],e[3]=1+o,C(e,e))}const A=(0,s.vt)(),E=(0,s.fA)(1,0,0),I=(0,s.fA)(0,1,0);const D=(0,n.vt)(),L=(0,n.vt)();const U=(0,o.vt)();Object.freeze(Object.defineProperty({__proto__:null,add:w,calculateW:function(e,t){const i=t[0],o=t[1],n=t[2];return e[0]=i,e[1]=o,e[2]=n,e[3]=Math.sqrt(Math.abs(1-i*i-o*o-n*n)),e},conjugate:v,copy:m,dot:b,equals:Z,exactEquals:S,fromEuler:g,fromMat3:_,getAxisAngle:h,identity:function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},invert:u,len:V,length:P,lerp:O,mul:f,multiply:p,normalize:C,random:function(e){const t=r.Ov,i=t(),o=t(),n=t(),s=Math.sqrt(1-i),a=Math.sqrt(i);return e[0]=s*Math.sin(2*Math.PI*o),e[1]=s*Math.cos(2*Math.PI*o),e[2]=a*Math.sin(2*Math.PI*n),e[3]=a*Math.cos(2*Math.PI*n),e},rotateX:function(e,t,i){i*=.5;const o=t[0],n=t[1],s=t[2],r=t[3],a=Math.sin(i),l=Math.cos(i);return e[0]=o*l+r*a,e[1]=n*l+s*a,e[2]=s*l-n*a,e[3]=r*l-o*a,e},rotateY:function(e,t,i){i*=.5;const o=t[0],n=t[1],s=t[2],r=t[3],a=Math.sin(i),l=Math.cos(i);return e[0]=o*l-s*a,e[1]=n*l+r*a,e[2]=s*l+o*a,e[3]=r*l-n*a,e},rotateZ:function(e,t,i){i*=.5;const o=t[0],n=t[1],s=t[2],r=t[3],a=Math.sin(i),l=Math.cos(i);return e[0]=o*l+n*a,e[1]=n*l-o*a,e[2]=s*l+r*a,e[3]=r*l-s*a,e},rotationTo:H,scale:x,set:y,setAxes:function(e,t,i,o){const n=U;return n[0]=i[0],n[3]=i[1],n[6]=i[2],n[1]=o[0],n[4]=o[1],n[7]=o[2],n[2]=-t[0],n[5]=-t[1],n[8]=-t[2],C(e,_(e,n))},setAxisAngle:d,slerp:c,sqlerp:function(e,t,i,o,n,s){return c(D,t,n,s),c(L,i,o,s),c(e,D,L,2*s*(1-s)),e},sqrLen:M,squaredLength:T,str:function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}},Symbol.toStringTag,{value:"Module"}))},96820:(e,t,i)=>{i.d(t,{Cq:()=>h,Ee:()=>u,J1:()=>y,LF:()=>f,Me:()=>O,Mm:()=>v,Sz:()=>b,W4:()=>_,cs:()=>P,e_:()=>g,nD:()=>c,t_:()=>w,tr:()=>m,v7:()=>C,zJ:()=>p,zq:()=>x});var o=i(55877),n=i(73582),s=i(15941),r=i(24648),a=i(88685),l=i(31633),d=i(50265);function h(e,t,i){return e.units[t][i]}function p(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";return"".concat((0,d.ZV)(t,{minimumFractionDigits:o,maximumFractionDigits:o,signDisplay:t>0?"never":"exceptZero"})," ").concat(h(e,i,n))}function c(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";return"".concat((0,d.ZV)(t,{minimumFractionDigits:o,maximumFractionDigits:o,signDisplay:"exceptZero"})," ").concat(h(e,i,n))}function u(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const s=(0,l.x0)(t,i);return p(e,(0,l.oU)(t,i,s),s,o,n)}function v(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const s=(0,l.x0)(t,i);return c(e,(0,l.oU)(t,i,s),s,o,n)}function _(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const s=(0,l.x$)(t,i);return p(e,(0,l.oU)(t,i,s),s,o,n)}function g(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const s=(0,l.x$)(t,i);return c(e,(0,l.oU)(t,i,s),s,o,n)}function m(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const s=(0,l.OU)(t,i);return p(e,(0,l.oU)(t,i,s),s,o,n)}function y(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const s=(0,l.OU)(t,i);return c(e,(0,l.oU)(t,i,s),s,o,n)}function w(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const s=(0,l.y7)(t,i);return p(e,(0,l.oU)(t,i,s),s,o,n)}function f(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const s=(0,l.y7)(t,i);return c(e,(0,l.oU)(t,i,s),s,o,n)}function x(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const s=(0,l.wv)(t,i);return p(e,(0,l.oU)(t,i,s),s,o,n)}function b(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const s=(0,l.TL)(t,i);return p(e,(0,l.oU)(t,i,s),s,o,n)}function O(e,t,i,o,s){var a;s=null!==(a=s)&&void 0!==a?a:2;let h=n.ie.normalize((0,r.g2)((0,l.oU)(e,t,"degrees"),i,o),0,!0);const p={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:s,minimumFractionDigits:s,signDisplay:h>0?"never":"exceptZero"};return h=T(h,p),(0,d.ZV)(h,p)}function P(e,t,i,o,n){var s;i!==o&&(e=-e);const r={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:n=null!==(s=n)&&void 0!==s?s:2,minimumFractionDigits:n,signDisplay:"exceptZero"};let a=(0,l.oU)(e,t,"degrees")%360;return a=T(a,r),(0,d.ZV)(a,r)}const V=new Map;function T(e,t){const i=JSON.stringify(t);let o=V.get(i);return o||(o=new Intl.NumberFormat("en-US",t),V.set(i,o)),/\-?\+?360/.test(o.format(e))?0:e}const M=["B","kB","MB","GB","TB"];function C(e,t){let i=0===(t=Math.round(t))?0:Math.floor(Math.log(t)/Math.log(o.u.KILOBYTES));i=(0,s.qE)(i,0,M.length-1);const n=(0,d.ZV)(t/o.u.KILOBYTES**i,{maximumFractionDigits:2});return(0,a.HC)(e.units.bytes[M[i]],{fileSize:n})}},64232:(e,t,i)=>{i.d(t,{W:()=>a,g:()=>r});var o=i(9392),n=i(9624),s=i(45308);function r(e,t,i,o){var r,a;if((0,n.canProjectWithoutEngine)(e.spatialReference,i)){var d;l[0]=e.x,l[1]=e.y;const n=e.z;return l[2]=null!==(d=null!==n&&void 0!==n?n:o)&&void 0!==d?d:0,(0,s.projectBuffer)(l,e.spatialReference,0,t,i,0,1)}const h=(0,n.tryProjectWithZConversion)(e,i);return!!h&&(t[0]=null===h||void 0===h?void 0:h.x,t[1]=null===h||void 0===h?void 0:h.y,t[2]=null!==(r=null!==(a=null===h||void 0===h?void 0:h.z)&&void 0!==a?a:o)&&void 0!==r?r:0,!0)}async function a(e,t,i,o,s){return await(0,n.initializeProjection)(e.spatialReference,i,null,s),r(e,t,i,o)}const l=(0,o.vt)()},14487:(e,t,i)=>{i.d(t,{F:()=>s});i(9624);var o=i(13312),n=i(64232);function s(e,t,i,o,s){return!(null==t||null==o||e.length<2)&&(r.x=e[0],r.y=e[1],r.z=e[2],r.spatialReference=t,(0,n.g)(r,i,o,s))}const r=(0,i(18117).T)(0,0,0,o.A.WGS84)},63733:(e,t,i)=>{i.r(t),i.d(t,{default:()=>u});var o=i(35143),n=i(46053),s=(i(81806),i(76460),i(47249),i(85842)),r=i(5364),a=i(25515),l=i(65624),d=i(5682),h=i(64519),p=i(731);let c=class extends((0,l.d)((0,d.j)(a.A))){constructor(e){super(e),this.elevationInfo=null,this.graphics=new h.Y,this.screenSizePerspectiveEnabled=!0,this.type="graphics",this.internal=!1}destroy(){this.removeAll(),this.graphics.destroy()}add(e){return this.graphics.add(e),this}addMany(e){return this.graphics.addMany(e),this}removeAll(){return this.graphics.removeAll(),this}remove(e){this.graphics.remove(e)}removeMany(e){this.graphics.removeMany(e)}on(e,t){return super.on(e,t)}graphicChanged(e){this.emit("graphic-update",e)}};(0,o._)([(0,n.MZ)({type:p.A})],c.prototype,"elevationInfo",void 0),(0,o._)([(0,n.MZ)((0,r.C)(h.Y,"graphics"))],c.prototype,"graphics",void 0),(0,o._)([(0,n.MZ)({type:["show","hide"]})],c.prototype,"listMode",void 0),(0,o._)([(0,n.MZ)()],c.prototype,"screenSizePerspectiveEnabled",void 0),(0,o._)([(0,n.MZ)({readOnly:!0})],c.prototype,"type",void 0),(0,o._)([(0,n.MZ)({constructOnly:!0})],c.prototype,"internal",void 0),c=(0,o._)([(0,s.$)("esri.layers.GraphicsLayer")],c);const u=c},18117:(e,t,i)=>{function o(e,t,i,o){return{x:e,y:t,z:i,hasZ:null!=i,hasM:!1,spatialReference:o,type:"point"}}i.d(t,{T:()=>o})},12482:(e,t,i)=>{i.d(t,{$7:()=>b,B:()=>x,Fo:()=>y,M7:()=>V,NN:()=>c,Q5:()=>w,Tq:()=>M,Up:()=>f,XF:()=>P,Ze:()=>v,bK:()=>a,bh:()=>p,id:()=>_,ky:()=>h,qt:()=>T,tW:()=>O,w7:()=>l,wF:()=>r,wS:()=>g,xS:()=>m,ze:()=>d});var o=i(31633),n=i(59097);function s(e){return e?T:M}function r(e,t){return null!==t&&void 0!==t&&t.mode?t.mode:s(e).mode}function a(e,t){return null!=t?t:s(e)}function l(e,t){return r(null!=e&&e.hasZ,t)}function d(e,t){return a(null!=e&&!!e.hasZ,t)}function h(e){const t=u(e);return l(e.geometry,t)}function p(e){const t=u(e),i=l(e.geometry,t);return{mode:i,offset:null!=t&&"on-the-ground"!==i?V(t):0}}function c(e){if("on-the-ground"===h(e))return!1;const t=u(e),i=null!==t&&void 0!==t&&t.featureExpressionInfo?t.featureExpressionInfo.expression:null;return!(!i||"0"===i)}function u(e){return e.layer&&"elevationInfo"in e.layer?e.layer.elevationInfo:null}function v(e,t){if(null===e||void 0===e||!e.offset)return 0;const{offset:i,unit:n}=e;if("decimal-degrees"===n)return 0;const s="unknown"!==n&&n?n:"meters",r=(0,o.mq)(t);return r?(0,o.oU)(i,s,r):0}function _(e,t,i){var o,n;if(null===i||void 0===i||!i.mode)return;const s=e.hasZ?e.z:0,r=v(i,e.spatialReference);switch(i.mode){case"absolute-height":return s-r;case"on-the-ground":return 0;case"relative-to-ground":return s-((null!==(o=t.elevationProvider.getElevation(e.x,e.y,s,e.spatialReference,"ground"))&&void 0!==o?o:0)+r);case"relative-to-scene":return s-((null!==(n=t.elevationProvider.getElevation(e.x,e.y,s,e.spatialReference,"scene"))&&void 0!==n?n:0)+r)}}function g(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return y(e,t.x,t.y,t.hasZ?t.z:0,t.spatialReference,i,o)}function m(e,t,i,o){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return y(e,t[0],t[1],t.length>2?t[2]:0,i,o,n)}function y(e,t,i,o,n,s){let r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;if(null==s)return;const a=null!=r?r.mode:"absolute-height";if("on-the-ground"===a)return 0;const{absoluteZ:l}=w(t,i,o,n,e,s);return function(e,t,i,o,n,s,r,a){var l,d;const h=v(r,n);switch(a){case"absolute-height":return e-h;case"relative-to-ground":return e-((null!==(l=s.elevationProvider.getElevation(t,i,o,n,"ground"))&&void 0!==l?l:0)+h);case"relative-to-scene":return e-((null!==(d=s.elevationProvider.getElevation(t,i,o,n,"scene"))&&void 0!==d?d:0)+h)}}(l,t,i,o,n,e,r,a)}function w(e,t,i,o,n,s){const r=v(s,o);switch(s.mode){case"absolute-height":return{absoluteZ:i+r,elevation:0};case"on-the-ground":{var a;const i=null!==(a=n.elevationProvider.getElevation(e,t,0,o,"ground"))&&void 0!==a?a:0;return{absoluteZ:i,elevation:i}}case"relative-to-ground":{var l;const s=null!==(l=n.elevationProvider.getElevation(e,t,i,o,"ground"))&&void 0!==l?l:0;return{absoluteZ:i+s+r,elevation:s}}case"relative-to-scene":{var d;const s=null!==(d=n.elevationProvider.getElevation(e,t,i,o,"scene"))&&void 0!==d?d:0;return{absoluteZ:i+s+r,elevation:s}}}}function f(e,t){if(null==t)return!1;const{mode:i}=t;return null!=i&&("scene"===e&&"relative-to-scene"===i||"ground"===e&&"absolute-height"!==i)}function x(e,t,i){return i&&i.mode!==t?"".concat(e," only support ").concat(t," elevation mode"):null}function b(e,t,i){return(null===i||void 0===i?void 0:i.mode)===t?"".concat(e," do not support ").concat(t," elevation mode"):null}function O(e,t){return null!=(null===t||void 0===t?void 0:t.featureExpressionInfo)&&"0"!==t.featureExpressionInfo.expression?"".concat(e," do not support featureExpressionInfo"):null}function P(e,t){t&&e.warn(".elevationInfo=",t)}function V(e){var t;return(null!==(t=null===e||void 0===e?void 0:e.offset)&&void 0!==t?t:0)*(0,n.Ao)(null===e||void 0===e?void 0:e.unit)}const T={mode:"absolute-height",offset:0},M={mode:"on-the-ground",offset:null}},30048:(e,t,i)=>{i.d(t,{A:()=>W});var o,n=i(35143),s=i(91967),r=(i(81806),i(46053)),a=(i(76460),i(47249),i(85842)),l=(i(35238),i(50076),i(54099)),d=i(53084),h=i(30726),p=i(50346),c=i(76931),u=i(63733),v=i(18117),_=i(64465),g=i(53181),m=i(89238),y=i(974),w=i(87878),f=i(13284),x=i(14318);let b=o=class extends l.A.EventedAccessor{constructor(e){var t;super(e),this._hasZ=null,this._cursorScreenPoint=null,this._activePointerId=null,this._stagedVertexUnsnapped=null,this._lastVertexUnsnapped=null,this.interactiveUndoDisabled=!1,this.history=[],this.redoHistory=[],this.snapToScene=!1,this.view=null,this.elevationInfo=null,this.defaultZ=0,this._coordinateHelper=(0,m.BV)(!!e.hasZ,!1,e.view.spatialReference),this._snappingManager=e.snappingManager,this._editGeometryOperations=new w.p(new y.ZE(null!==(t=e.editGeometryType)&&void 0!==t?t:"polygon",this._coordinateHelper)),this._snappingGraphicsLayer=new u.default({id:o.SNAPPING_GRAPHICS_LAYER_ID,listMode:"hide",internal:!0}),this._snappingContext=new f.e({editGeometryOperations:this._editGeometryOperations,elevationInfo:{mode:"on-the-ground",offset:0},pointer:"mouse",visualizer:new g.J(this._snappingGraphicsLayer)}),this._activeComponent=new y.uA(e.view.spatialReference,_.RT.Local),this._editGeometryOperations.data.components.push(this._activeComponent)}normalizeCtorArgs(e){const t={...e};return delete t.editGeometryType,t}initialize(){this._snappingOperation=new x.O({view:this.view}),"2d"===this.view.type&&this.view.map.layers.add(this._snappingGraphicsLayer)}destroy(){this.view.map.layers.remove(this._snappingGraphicsLayer),this._snappingGraphicsLayer.destroy(),null!=this._snappingManager&&this._snappingManager.doneSnapping(),this._snappingOperation=(0,h.pR)(this._snappingOperation),this._editGeometryOperations.destroy()}get _committedVertices(){return this._editGeometryOperations.data.components[0].vertices.map((e=>e.pos))}get vertices(){return null!=this._stagedVertex?[...this._committedVertices,this._coordinateHelper.pointToArray(this._stagedVertex)]:this._committedVertices}get hasZ(){return null!=this._hasZ?this._hasZ:"3d"===this.view.type}set hasZ(e){this._hasZ=e,this.notifyChange("hasZ")}get _stagedVertex(){return this._snappingOperation.stagedPoint}set _stagedVertex(e){this._snappingOperation.stagedPoint=(0,d.o8)(e)}canUndo(){return this._editGeometryOperations.canUndo}canRedo(){return this._editGeometryOperations.canRedo}undo(){this.canUndo&&this._editGeometryOperations.undo()}redo(){this.canRedo&&this._editGeometryOperations.redo()}getCoordsFromScreenPoint(e){const t=e&&this.screenToMap(e);return null==t?null:t.hasZ?[t.x,t.y,t.z]:[t.x,t.y]}getCoordsAndPointFromScreenPoint(e){const t=this.screenToMap(e);return null==t?null:t.hasZ?{vertex:[t.x,t.y,t.z],mapPoint:t}:{vertex:[t.x,t.y],mapPoint:t}}screenToMap(e){let t=null;if("3d"===this.view.type)if(this.hasZ){var i;const o=null!==(i=this.elevationInfo)&&void 0!==i?i:O;t=this.view.sceneIntersectionHelper.intersectElevationFromScreen((0,c.gs)(e.x,e.y),o,this._getGeometryZValue())}else{var o;const i=null!==(o=this.elevationInfo)&&void 0!==o?o:P;t=this.view.sceneIntersectionHelper.intersectElevationFromScreen((0,c.gs)(e.x,e.y),i,0),null!=t&&(t.z=void 0)}else t=this.view.toMap(e),null!=t&&(t.z=this.hasZ?this._getGeometryZValue():void 0);return t}_pushCursorVertex(e,t){const i=(0,v.T)(e[0],e[1],void 0,this.view.spatialReference);this._stagedVertexUnsnapped=i;const o=this._snappingManager;if(null==o)return this._stagedVertex=i,void t();(0,p.QZ)(this._snappingOperation.snap({point:i},o,this._snappingContext)).then((()=>{t()}))}_popCursorVertex(){this._stagedVertexUnsnapped=null,this._stagedVertex=null}_getGeometryZValue(){return this.defaultZ}_abortSnapping(){this._snappingOperation.abort()}_isDuplicateOfLastVertex(e){var t;const i=null===(t=this._editGeometryOperations.data.components[0].getLastVertex())||void 0===t?void 0:t.pos;if(i&&e[0]===i[0]&&e[1]===i[1])return!0;const{x:o,y:n}=this._coordinateHelper.vectorToDehydratedPoint(e);return null!=this._lastVertexUnsnapped&&o===this._lastVertexUnsnapped.x&&n===this._lastVertexUnsnapped.y}_shouldHandlePointerEvent(e){return this._isPrimaryPointerAction(e)&&(null==this._activePointerId||this._activePointerId===e.pointerId)}_vertexAddHandler(e){const t=null!=this._stagedVertex?this._coordinateHelper.pointToArray(this._stagedVertex):this.getCoordsFromScreenPoint(this._cursorScreenPoint);null!=t&&this._addVertex(t,e.native)}_drawCompleteHandler(e){this._completeDrawing(e.native)}_isPrimaryPointerAction(e){return"mouse"!==e.pointerType||0===e.button}};b.SNAPPING_GRAPHICS_LAYER_ID="DrawAction-snapping-graphics-layer",(0,n._)([(0,r.MZ)({readOnly:!0})],b.prototype,"vertices",null),(0,n._)([(0,r.MZ)({type:Boolean,nonNullable:!0})],b.prototype,"interactiveUndoDisabled",void 0),(0,n._)([(0,r.MZ)({readOnly:!0})],b.prototype,"history",void 0),(0,n._)([(0,r.MZ)({readOnly:!0})],b.prototype,"redoHistory",void 0),(0,n._)([(0,r.MZ)()],b.prototype,"snapToScene",void 0),(0,n._)([(0,r.MZ)()],b.prototype,"view",void 0),(0,n._)([(0,r.MZ)()],b.prototype,"elevationInfo",void 0),(0,n._)([(0,r.MZ)({nonNullable:!0})],b.prototype,"defaultZ",void 0),(0,n._)([(0,r.MZ)()],b.prototype,"hasZ",null),(0,n._)([(0,r.MZ)()],b.prototype,"_snappingOperation",void 0),(0,n._)([(0,r.MZ)()],b.prototype,"_stagedVertex",null),b=o=(0,n._)([(0,a.$)("esri.views.draw.DrawAction")],b);const O={mode:"absolute-height",offset:0},P={mode:"on-the-ground",offset:0},V=b;class T{constructor(e,t,i){this.view=e,this.vertexIndex=t,this.vertices=i,this.defaultPrevented=!1,this.type="vertex-add"}preventDefault(){this.defaultPrevented=!0}}class M{constructor(e,t,i){this.view=e,this.vertexIndex=t,this.vertices=i,this.defaultPrevented=!1,this.type="vertex-remove"}preventDefault(){this.defaultPrevented=!0}}class C{constructor(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.view=e,this.vertexIndex=t,this.vertices=i,this.mapPoint=o,this.coordinates=null,this.defaultPrevented=!1,this.type="cursor-update",this.coordinates=1===i.length?i[0]:null}preventDefault(){this.defaultPrevented=!0}}class S{constructor(e){this.vertices=e,this.coordinates=null,this.defaultPrevented=!1,this.type="draw-complete",this.coordinates=1===e.length?e[0]:null}preventDefault(){this.defaultPrevented=!0}}var Z=i(57308),H=i(82307),A=i(11500),E=i(13904);const I=Symbol("view-handles"),D=Symbol("undo-redo-handles");let L=class extends V{constructor(e){super(e),this._popVertexOnPointerMove=!1,this._addVertexOnPointerUp=!1}initialize(){this._addViewHandles(),this._addUndoRedoHandles()}destroy(){this._removeViewHandles(),this._removeUndoRedoHandles(),this.emit("destroy")}undo(){super.undo(),this.notifyChange("vertices")}redo(){super.redo(),this.notifyChange("vertices")}complete(){this._completeDrawing()}_addViewHandles(){this._removeViewHandles(),this.addHandles([this.view.on("click",(e=>{e.stopPropagation()}),Z.o.TOOL),this.view.on("pointer-down",(e=>{this._shouldHandlePointerEvent(e)&&(this._abortSnapping(),this._activePointerId=e.pointerId,this._addVertexOnPointerUp=!0,this._cursorScreenPoint=(0,A.ZV)(e),"touch"===e.pointerType&&this._updateCursor())}),Z.o.TOOL),this.view.on("pointer-move",(e=>{this._popVertexOnPointerMove&&(this.undo(),this._popVertexOnPointerMove=!1),this._abortSnapping(),this._cursorScreenPoint=(0,A.ZV)(e),"touch"!==e.pointerType&&this._updateCursor()}),Z.o.TOOL),this.view.on("pointer-drag",(e=>{this._shouldHandlePointerEvent(e)&&(this._abortSnapping(),this._addVertexOnPointerUp=!1)}),Z.o.TOOL),this.view.on("pointer-up",(e=>{if(this._shouldHandlePointerEvent(e))if(this._abortSnapping(),this._activePointerId=null,this._addVertexOnPointerUp)this._vertexAddHandler(e);else{const t="touch"===e.pointerType;this._updateCursor(t)}}),Z.o.TOOL),this.view.on("drag",["Shift"],(e=>{e.stopPropagation()}),Z.o.TOOL),this.view.on("double-click",(e=>{e.stopPropagation(),this._drawCompleteHandler(e)}),Z.o.TOOL),this.view.on("double-click",["Control"],(e=>{e.stopPropagation(),this._drawCompleteHandler(e)}),Z.o.TOOL),this.view.on("key-down",(e=>{const{key:t,repeat:i}=e;t===H.NE.vertexAdd&&!i&&this._cursorScreenPoint?(e.stopPropagation(),this._abortSnapping(),this._vertexAddHandler(e)):t!==H.NE.complete||i?t!==H.NE.undo||this.interactiveUndoDisabled||i?t!==H.NE.redo||this.interactiveUndoDisabled||i?t!==H.NE.pan||i||e.stopPropagation():(e.stopPropagation(),this.redo()):(e.stopPropagation(),this.undo()):(e.stopPropagation(),this._drawCompleteHandler(e))}),Z.o.TOOL),this.view.on("key-up",(e=>{e.key===H.NE.pan&&e.stopPropagation()}),Z.o.TOOL)],I)}_addUndoRedoHandles(){this._removeUndoRedoHandles(),this.addHandles([this._editGeometryOperations.on("vertex-remove",(e=>{if(this.notifyChange("vertices"),"undo"===e.operation){const t=[...this._committedVertices];null!=this._stagedVertex&&t.push(this._coordinateHelper.pointToArray(this._stagedVertex)),this.emit("undo",new M(this.view,e.vertices[0].index,t))}})),this._editGeometryOperations.on("vertex-add",(e=>{if(this.notifyChange("vertices"),"apply"===e.operation){const e=this._committedVertices.length-1,t=new T(this.view,e,this.vertices);this.emit("vertex-add",t),t.defaultPrevented&&(this._popVertexOnPointerMove=!0)}else if("redo"===e.operation){const t=[...this._committedVertices];null!=this._stagedVertex&&t.push(this._coordinateHelper.pointToArray(this._stagedVertex)),this.emit("redo",new T(this.view,e.vertices[0].index,t))}}))],D)}_removeViewHandles(){this.removeHandles(I)}_removeUndoRedoHandles(){this.removeHandles(D)}_addVertex(e){const t=this._coordinateHelper.arrayToVector(e);this._isDuplicateOfLastVertex(t)||this._editGeometryOperations.appendVertex(t)}_updateCursor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._popCursorVertex(),!this._cursorScreenPoint)return;const t=this.getCoordsAndPointFromScreenPoint(this._cursorScreenPoint);null==t||e||this._pushCursorVertex(t.vertex,(()=>this.emit("cursor-update",new C(this.view,this._activeComponent.vertices.length,this.vertices,null!=this._stagedVertex?new E.A(this._stagedVertex):null))))}_completeDrawing(){if(this._activePointerId=null,this._popCursorVertex(),this._abortSnapping(),null!=this._snappingManager&&this._snappingManager.doneSnapping(),this.vertices.length<1)return;const e=new S(this.vertices);this.emit("draw-complete",e),e.defaultPrevented||this._removeViewHandles()}};L=(0,n._)([(0,a.$)("esri.views.draw.MultipointDrawAction")],L);var U=i(12482),k=i(35384),G=i(66812),R=i(56829);let z=class extends(l.A.EventedMixin(R.g)){constructor(e){super(e),this.defaultZ=0,this.elevationInfo=null,this.hasZ=!0,this.mode=null,this.snapToScene=null,this.type="draw-3d"}initialize(){const e=this.view,t=(0,U.bK)(this.hasZ,this.elevationInfo);this.drawOperation=new k.O0({view:e,manipulators:this.manipulators,geometryType:this.geometryType,drawingMode:this.mode,hasZ:this.hasZ,defaultZ:this.defaultZ,snapToSceneEnabled:this.snapToScene,drawSurface:"3d"===e.type?new G.IX(e,t):null,elevationDrawSurface:"3d"===e.type?new G.rT(t,this.defaultZ,e):null,hasM:!1,elevationInfo:t}),this.addHandles([this.drawOperation.on("vertex-add",(e=>this.onVertexAdd(e))),this.drawOperation.on("vertex-remove",(e=>this.onVertexRemove(e))),this.drawOperation.on("vertex-update",(e=>this.onVertexUpdate(e))),this.drawOperation.on("cursor-update",(e=>this.onCursorUpdate(e))),this.drawOperation.on("complete",(e=>this.onComplete(e)))]),this.finishToolCreation()}destroy(){this.drawOperation=(0,h.pR)(this.drawOperation),this._set("view",null)}set enabled(e){this.drawOperation.interactive=e,this._set("enabled",e)}get updating(){var e,t;return null!==(e=null===(t=this.drawOperation)||void 0===t?void 0:t.updating)&&void 0!==e&&e}completeCreateOperation(){this.drawOperation.complete()}onDeactivate(){this.drawOperation.isCompleted||this.drawOperation.cancel()}getVertexCoords(){return this.drawOperation.geometryIncludingUncommittedVertices}onInputEvent(e){this.drawOperation.onInputEvent(e)}canRedo(){return this.drawOperation.canRedo}canUndo(){return this.drawOperation.canUndo}redo(){this.drawOperation.redo()}reset(){}undo(){this.drawOperation.undo()}onComplete(e){this.emit("complete",e)}onCursorUpdate(e){this.emit("cursor-update",e)}onVertexAdd(e){this.emit("vertex-add",e)}onVertexRemove(e){this.emit("vertex-remove",e)}onVertexUpdate(e){this.emit("vertex-update",e)}};(0,n._)([(0,r.MZ)({constructOnly:!0,nonNullable:!0})],z.prototype,"defaultZ",void 0),(0,n._)([(0,r.MZ)()],z.prototype,"drawOperation",void 0),(0,n._)([(0,r.MZ)({constructOnly:!0})],z.prototype,"elevationInfo",void 0),(0,n._)([(0,r.MZ)({value:!0})],z.prototype,"enabled",null),(0,n._)([(0,r.MZ)({constructOnly:!0})],z.prototype,"geometryType",void 0),(0,n._)([(0,r.MZ)({constructOnly:!0})],z.prototype,"hasZ",void 0),(0,n._)([(0,r.MZ)({constructOnly:!0})],z.prototype,"mode",void 0),(0,n._)([(0,r.MZ)()],z.prototype,"snapToScene",void 0),(0,n._)([(0,r.MZ)({readOnly:!0})],z.prototype,"type",void 0),(0,n._)([(0,r.MZ)({readOnly:!0})],z.prototype,"updating",null),(0,n._)([(0,r.MZ)({constructOnly:!0,nonNullable:!0})],z.prototype,"view",void 0),z=(0,n._)([(0,a.$)("esri.views.draw.DrawTool")],z);let N=class extends V{constructor(e){super(e),this._addVertexOnPointerUp=!1,this._drawTool=null}initialize(){this._addViewHandles(),"3d"===this.view.type&&this._addDrawTool()}destroy(){this._removeDrawTool(),this.emit("destroy")}complete(){this._completeDrawing()}_addViewHandles(){this._addViewHandles2DOnly(),this.addHandles([this.view.on("key-down",(e=>{e.key===H.NE.complete&&(this._drawTool?this.complete():(this._abortSnapping(),this._vertexAddHandler(e)))}),Z.o.TOOL)])}_addViewHandles2DOnly(){"2d"===this.view.type&&this.addHandles([this.view.on("pointer-down",(e=>{this._shouldHandlePointerEvent(e)&&(this._abortSnapping(),this._activePointerId=e.pointerId,this._addVertexOnPointerUp=!0,this._cursorScreenPoint=(0,A.ZV)(e),"touch"===e.pointerType&&this._updateCursor())}),Z.o.TOOL),this.view.on("pointer-move",(e=>{this._abortSnapping(),this._cursorScreenPoint=(0,A.ZV)(e),"touch"!==e.pointerType&&this._updateCursor()}),Z.o.TOOL),this.view.on("pointer-drag",(e=>{this._shouldHandlePointerEvent(e)&&(this._abortSnapping(),this._addVertexOnPointerUp=!1)}),Z.o.TOOL),this.view.on("pointer-up",(e=>{if(this._shouldHandlePointerEvent(e))if(this._abortSnapping(),this._activePointerId=null,this._addVertexOnPointerUp)e.stopPropagation(),this._vertexAddHandler(e);else{const t="touch"===e.pointerType;this._updateCursor(t)}}),Z.o.TOOL),this.view.on("drag",["Shift"],(e=>{e.stopPropagation()}),Z.o.TOOL)])}_addDrawTool(){const e=new z({view:this.view,elevationInfo:this.elevationInfo,hasZ:this.hasZ,geometryType:"point",mode:"click"});this._drawTool=e,this.view.addAndActivateTool(e),this.addHandles([e.on("cursor-update",(t=>{1===t.vertices.length&&this.emit("cursor-update",new C(this.view,t.vertices[0].vertexIndex,e.getVertexCoords()))})),e.on("complete",(t=>{this.emit("draw-complete",new S(e.getVertexCoords())),this._removeDrawTool(),this.removeAllHandles()}))])}_removeDrawTool(){this._drawTool&&(this.view.tools.remove(this._drawTool),this._drawTool=null)}_addVertex(e){const t=this._coordinateHelper.arrayToVector(e);this._isDuplicateOfLastVertex(t)||(this._lastVertexUnsnapped=this._stagedVertexUnsnapped,this._popCursorVertex(),this._editGeometryOperations.appendVertex(t),this.notifyChange("vertices"),this._completeDrawing())}_updateCursor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._popCursorVertex(),!this._cursorScreenPoint)return;const t=this.getCoordsAndPointFromScreenPoint(this._cursorScreenPoint);null==t||e||this._pushCursorVertex(t.vertex,(()=>this.emit("cursor-update",new C(this.view,this._activeComponent.vertices.length,this.vertices,null!=this._stagedVertex?new E.A(this._stagedVertex):null))))}_completeDrawing(){if(this._drawTool)return void this._drawTool.completeCreateOperation();this._activePointerId=null,this._popCursorVertex(),this._abortSnapping(),null!=this._snappingManager&&this._snappingManager.doneSnapping();const e=new S(this.vertices);this.emit("draw-complete",e),e.defaultPrevented||this.removeAllHandles()}};N=(0,n._)([(0,a.$)("esri.views.draw.PointDrawAction")],N);var F=i(56061);let K=class extends V{constructor(e){super(e),this._panEnabled=!1,this._popVertexOnPointerMove=!1,this._addVertexOnPointerUp=!1,this._drawTool=null,this.mode=F.t}initialize(){this._addViewHandles(),"3d"===this.view.type&&this._addDrawTool()}destroy(){this._removeDrawTool(),this.emit("destroy")}get _dragEnabled(){return"freehand"===this.mode||"hybrid"===this.mode}get _clickEnabled(){return"click"===this.mode||"hybrid"===this.mode}undo(){this._drawTool?this._drawTool.undo():(super.undo(),this.notifyChange("vertices"))}redo(){this._drawTool?this._drawTool.redo():(super.redo(),this.notifyChange("vertices"))}canUndo(){var e,t;return null!==(e=null===(t=this._drawTool)||void 0===t?void 0:t.canUndo())&&void 0!==e?e:super.canUndo()}canRedo(){var e,t;return null!==(e=null===(t=this._drawTool)||void 0===t?void 0:t.canRedo())&&void 0!==e?e:super.canRedo()}complete(){this._completeDrawing()}_getGeometryZValue(){return this.hasZ&&this.vertices.length>0?this.vertices[0][2]:this.defaultZ}_addViewHandles(){this._addViewHandles2DOnly(),this.addHandles(this.view.on("key-down",(e=>{const{key:t,repeat:i}=e;t!==H.NE.vertexAdd||i?t!==H.NE.complete||i?t!==H.NE.undo||this.interactiveUndoDisabled||i?t!==H.NE.redo||this.interactiveUndoDisabled||i||(e.stopPropagation(),this.redo()):(e.stopPropagation(),this.undo()):(e.stopPropagation(),this._drawCompleteHandler(e)):(e.stopPropagation(),this._handleVertexAddKey(e))}),Z.o.TOOL))}_addViewHandles2DOnly(){"2d"===this.view.type&&(this.addHandles([this.view.on("click",(e=>{e.stopPropagation()}),Z.o.TOOL),this.view.on("pointer-down",(e=>{this._shouldHandlePointerEvent(e)&&(this._abortSnapping(),this._activePointerId=e.pointerId,this._addVertexOnPointerUp=!0,this._cursorScreenPoint=(0,A.ZV)(e),"touch"===e.pointerType&&this._updateCursor())}),Z.o.TOOL),this.view.on("pointer-move",(e=>{this._abortSnapping(),this._popVertexOnPointerMove&&(this.undo(),this._popVertexOnPointerMove=!1),this._cursorScreenPoint=(0,A.ZV)(e),"touch"!==e.pointerType&&this._updateCursor()}),Z.o.TOOL),this.view.on("pointer-drag",(e=>{this._shouldHandlePointerEvent(e)&&(this._abortSnapping(),this._cursorScreenPoint=(0,A.ZV)(e),this._dragEnabled&&!this._panEnabled?this._vertexAddHandler(e):this._addVertexOnPointerUp=!1)}),Z.o.TOOL),this.view.on("pointer-up",(e=>{if(this._shouldHandlePointerEvent(e))if(this._abortSnapping(),this._activePointerId=null,this._addVertexOnPointerUp){if(!this._clickEnabled)return 1===this.vertices.length&&this.vertices.pop(),void this._drawCompleteHandler(e);this._vertexAddHandler(e)}else{const t="touch"===e.pointerType;this._updateCursor(t)}}),Z.o.TOOL),this.view.on("drag",(e=>{this._dragEnabled&&null!=this._activePointerId&&!this._panEnabled&&e.stopPropagation()}),Z.o.TOOL),this.view.on("drag",["Shift"],(e=>{e.stopPropagation()}),Z.o.TOOL),this.view.on("double-click",(e=>{e.stopPropagation(),this._drawCompleteHandler(e)}),Z.o.TOOL),this.view.on("double-click",["Control"],(e=>{e.stopPropagation(),this._drawCompleteHandler(e)}),Z.o.TOOL),this.view.on("key-down",(e=>{const{key:t,repeat:i}=e;t!==H.NE.pan||i||(e.stopPropagation(),this._panEnabled=!0)}),Z.o.TOOL),this.view.on("key-up",(e=>{e.key===H.NE.pan&&(e.stopPropagation(),this._panEnabled=!1)}),Z.o.TOOL)]),this._addUndoRedoHandles())}_handleVertexAddKey(e){this._drawTool?this._drawTool.drawOperation.commitStagedVertex():this._cursorScreenPoint&&(this._abortSnapping(),this._vertexAddHandler(e))}_addUndoRedoHandles(){this.addHandles([this._editGeometryOperations.on("vertex-remove",(e=>{if(this.notifyChange("vertices"),"undo"===e.operation){const t=[...this._committedVertices];null!=this._stagedVertex&&t.push(this._coordinateHelper.pointToArray(this._stagedVertex)),this.emit("undo",new M(this.view,e.vertices[0].index,t))}})),this._editGeometryOperations.on("vertex-add",(e=>{if(this.notifyChange("vertices"),"apply"===e.operation){const e=this._committedVertices.length-1,t=new T(this.view,e,this.vertices);this.emit("vertex-add",t),t.defaultPrevented&&(this._popVertexOnPointerMove=!0)}else if("redo"===e.operation){const t=[...this._committedVertices];null!=this._stagedVertex&&t.push(this._coordinateHelper.pointToArray(this._stagedVertex)),this.emit("redo",new T(this.view,e.vertices[0].index,t))}}))])}_addDrawTool(){const e=new z({view:this.view,elevationInfo:this.elevationInfo,hasZ:this.hasZ,geometryType:"polygon",mode:this.mode});this._drawTool=e,this.view.addAndActivateTool(e),e.on("vertex-add",(t=>{if(1===t.vertices.length){const{view:i}=this,o=t.vertices[0].vertexIndex,n=e.getVertexCoords();this.emit("vertex-add",new T(i,o,n)),"undo"!==t.operation&&"redo"!==t.operation||this.emit(t.operation,new T(i,o,n))}})),e.on("vertex-remove",(t=>{if(1===t.vertices.length){const{view:i}=this,o=t.vertices[0].vertexIndex,n=e.getVertexCoords();this.emit("vertex-remove",new M(i,o,n)),"undo"!==t.operation&&"redo"!==t.operation||this.emit(t.operation,new M(i,o,n))}})),e.on("cursor-update",(t=>{1===t.vertices.length&&this.emit("cursor-update",new C(this.view,t.vertices[0].vertexIndex,e.getVertexCoords()))})),e.on("complete",(t=>{this.emit("draw-complete",new S(e.getVertexCoords())),this._removeDrawTool(),this.removeAllHandles()}))}_removeDrawTool(){this._drawTool&&(this.view.tools.remove(this._drawTool),this._drawTool=null)}_addVertex(e){const t=this._coordinateHelper.arrayToVector(e);this._isDuplicateOfLastVertex(t)||(this._lastVertexUnsnapped=this._stagedVertexUnsnapped,this._popCursorVertex(),this._editGeometryOperations.appendVertex(t))}_updateCursor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._popCursorVertex(),!this._cursorScreenPoint)return;const t=this.getCoordsAndPointFromScreenPoint(this._cursorScreenPoint);null==t||e||this._pushCursorVertex(t.vertex,(()=>this.emit("cursor-update",new C(this.view,this._activeComponent.vertices.length,this.vertices,null!=this._stagedVertex?new E.A(this._stagedVertex):null))))}_completeDrawing(){if(this._drawTool)return void this._drawTool.completeCreateOperation();if(this._activePointerId=null,this._popCursorVertex(),this._committedVertices.length<3)return;this._abortSnapping(),null!=this._snappingManager&&this._snappingManager.doneSnapping();const e=new S(this.vertices);this.emit("draw-complete",e),e.defaultPrevented||this.removeAllHandles()}};(0,n._)([(0,r.MZ)()],K.prototype,"_dragEnabled",null),(0,n._)([(0,r.MZ)()],K.prototype,"_clickEnabled",null),(0,n._)([(0,r.MZ)({type:F.x})],K.prototype,"mode",void 0),K=(0,n._)([(0,a.$)("esri.views.draw.PolygonDrawAction")],K);let B=class extends V{constructor(e){super(e),this._panEnabled=!1,this._popVertexOnPointerMove=!1,this._addVertexOnPointerUp=!1,this._drawTool=null,this.mode=F.t}initialize(){this._addViewHandles(),"3d"===this.view.type&&this._addDrawTool()}destroy(){this._removeDrawTool(),this.emit("destroy")}get _clickEnabled(){return"click"===this.mode||"hybrid"===this.mode}get _dragEnabled(){return"freehand"===this.mode||"hybrid"===this.mode}undo(){this._drawTool?this._drawTool.undo():(super.undo(),this.notifyChange("vertices"))}redo(){this._drawTool?this._drawTool.redo():(super.redo(),this.notifyChange("vertices"))}canUndo(){var e,t;return null!==(e=null===(t=this._drawTool)||void 0===t?void 0:t.canUndo())&&void 0!==e?e:super.canUndo()}canRedo(){var e,t;return null!==(e=null===(t=this._drawTool)||void 0===t?void 0:t.canRedo())&&void 0!==e?e:super.canRedo()}complete(){this._completeDrawing()}_addViewHandles(){this._addViewHandles2DOnly(),this.addHandles([this.view.on("key-down",(e=>{const{key:t,repeat:i}=e;t!==H.NE.vertexAdd||i?t!==H.NE.complete||i?t!==H.NE.undo||this.interactiveUndoDisabled||i?t!==H.NE.redo||this.interactiveUndoDisabled||i||(e.stopPropagation(),this.redo()):(e.stopPropagation(),this.undo()):(e.stopPropagation(),this._drawCompleteHandler(e)):(e.stopPropagation(),this._handleVertexAddKey(e))}),Z.o.TOOL)])}_addViewHandles2DOnly(){"2d"===this.view.type&&(this.addHandles([this.view.on("click",(e=>{e.stopPropagation()}),Z.o.TOOL),this.view.on("pointer-down",(e=>{this._shouldHandlePointerEvent(e)&&!this._panEnabled&&(this._abortSnapping(),this._activePointerId=e.pointerId,this._addVertexOnPointerUp=!0,this._cursorScreenPoint=(0,A.ZV)(e),"touch"===e.pointerType&&this._updateCursor())}),Z.o.TOOL),this.view.on("pointer-move",(e=>{this._popVertexOnPointerMove&&(this.undo(),this._popVertexOnPointerMove=!1),this._abortSnapping(),this._cursorScreenPoint=(0,A.ZV)(e),"touch"!==e.pointerType&&this._updateCursor()}),Z.o.TOOL),this.view.on("pointer-drag",(e=>{this._shouldHandlePointerEvent(e)&&(this._abortSnapping(),this._cursorScreenPoint=(0,A.ZV)(e),this._dragEnabled&&!this._panEnabled?this._vertexAddHandler(e):this._addVertexOnPointerUp=!1)}),Z.o.TOOL),this.view.on("pointer-up",(e=>{if(this._shouldHandlePointerEvent(e))if(this._abortSnapping(),this._activePointerId=null,this._addVertexOnPointerUp){if(!this._clickEnabled)return 1===this.vertices.length&&this.vertices.pop(),void this._drawCompleteHandler(e);this._vertexAddHandler(e)}else{const t="touch"===e.pointerType;this._updateCursor(t)}}),Z.o.TOOL),this.view.on("drag",(e=>{this._dragEnabled&&null!=this._activePointerId&&!this._panEnabled&&e.stopPropagation()}),Z.o.TOOL),this.view.on("drag",["Shift"],(e=>{e.stopPropagation()}),Z.o.TOOL),this.view.on("double-click",(e=>{e.stopPropagation(),this._drawCompleteHandler(e)}),Z.o.TOOL),this.view.on("double-click",["Control"],(e=>{e.stopPropagation(),this._drawCompleteHandler(e)}),Z.o.TOOL),this.view.on("key-down",(e=>{const{key:t,repeat:i}=e;t!==H.NE.pan||i||(e.stopPropagation(),this._panEnabled=!0)}),Z.o.TOOL),this.view.on("key-up",(e=>{e.key===H.NE.pan&&(e.stopPropagation(),this._panEnabled=!1)}),Z.o.TOOL)]),this._addUndoRedoHandles())}_handleVertexAddKey(e){this._drawTool?this._drawTool.drawOperation.commitStagedVertex():this._cursorScreenPoint&&(this._abortSnapping(),this._vertexAddHandler(e))}_addUndoRedoHandles(){this.addHandles([this._editGeometryOperations.on("vertex-remove",(e=>{if(this.notifyChange("vertices"),"undo"===e.operation){const t=[...this._committedVertices];null!=this._stagedVertex&&t.push(this._coordinateHelper.pointToArray(this._stagedVertex)),this.emit("undo",new M(this.view,e.vertices[0].index,t))}})),this._editGeometryOperations.on("vertex-add",(e=>{if(this.notifyChange("vertices"),"apply"===e.operation){const e=this._committedVertices.length-1,t=new T(this.view,e,this.vertices);this.emit("vertex-add",t),t.defaultPrevented&&(this._popVertexOnPointerMove=!0)}else if("redo"===e.operation){const t=[...this._committedVertices];null!=this._stagedVertex&&t.push(this._coordinateHelper.pointToArray(this._stagedVertex)),this.emit("redo",new T(this.view,e.vertices[0].index,t))}}))])}_addDrawTool(){const e=new z({view:this.view,elevationInfo:this.elevationInfo,hasZ:this.hasZ,geometryType:"polyline",mode:this.mode});this._drawTool=e,this.view.addAndActivateTool(e),this.addHandles([e.on("vertex-add",(t=>{if(1!==t.vertices.length)return;const{view:i}=this,o=t.vertices[0].vertexIndex,n=e.getVertexCoords();this.emit("vertex-add",new T(i,o,n)),"undo"!==t.operation&&"redo"!==t.operation||this.emit(t.operation,new T(i,o,n))})),e.on("vertex-remove",(t=>{if(1!==t.vertices.length)return;const{view:i}=this,o=t.vertices[0].vertexIndex,n=e.getVertexCoords();this.emit("vertex-remove",new M(i,o,n)),"undo"!==t.operation&&"redo"!==t.operation||this.emit(t.operation,new M(i,o,n))})),e.on("cursor-update",(t=>{1===t.vertices.length&&this.emit("cursor-update",new C(this.view,t.vertices[0].vertexIndex,e.getVertexCoords()))})),e.on("complete",(t=>{this.emit("draw-complete",new S(e.getVertexCoords())),this._removeDrawTool(),this.removeAllHandles()}))])}_removeDrawTool(){this._drawTool&&(this.view.tools.remove(this._drawTool),this._drawTool=null)}_addVertex(e){const t=this._coordinateHelper.arrayToVector(e);this._isDuplicateOfLastVertex(t)||(this._lastVertexUnsnapped=this._stagedVertexUnsnapped,this._popCursorVertex(),this._editGeometryOperations.appendVertex(t))}_updateCursor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._popCursorVertex(),!this._cursorScreenPoint)return;const t=this.getCoordsAndPointFromScreenPoint(this._cursorScreenPoint);null==t||e||this._pushCursorVertex(t.vertex,(()=>this.emit("cursor-update",new C(this.view,this._activeComponent.vertices.length,this.vertices,null!=this._stagedVertex?new E.A(this._stagedVertex):null))))}_completeDrawing(){if(this._drawTool)return void this._drawTool.completeCreateOperation();if(this._activePointerId=null,this._popCursorVertex(),this._committedVertices.length<2)return;this._abortSnapping(),null!=this._snappingManager&&this._snappingManager.doneSnapping();const e=new S(this.vertices);this.emit("draw-complete",e),e.defaultPrevented||this.removeAllHandles()}};(0,n._)([(0,r.MZ)()],B.prototype,"_clickEnabled",null),(0,n._)([(0,r.MZ)()],B.prototype,"_dragEnabled",null),(0,n._)([(0,r.MZ)({type:F.x})],B.prototype,"mode",void 0),B=(0,n._)([(0,a.$)("esri.views.draw.PolylineDrawAction")],B);var q=i(42151);let Y=class extends V{constructor(e){super(e),this._isDragging=!1,this._panEnabled=!1,this._addVertexOnPointerUp=!1,this._drawTool=null,this.viewAlignedCoordinateSystem=null,this.mode="freehand"}initialize(){"2d"===this.view.type?this._addViewHandles():this._addDrawTool()}destroy(){this._removeDrawTool(),this.emit("destroy")}complete(){this._completeDrawing()}_getGeometryZValue(){return this.hasZ&&this.vertices.length>0?this.vertices[0][2]:this.defaultZ}_addViewHandles(){"click"===this.mode?this.addHandles(this._getClickModeViewHandles()):this.addHandles(this._getDragModeViewHandles())}_getDragModeViewHandles(){return[this.view.on("immediate-click",(e=>{e.stopPropagation(),e.mapPoint&&!this._panEnabled&&null!=this.getCoordsFromScreenPoint((0,A.ZV)(e))&&(this._vertexAddHandler(e),this._drawCompleteHandler(e))}),Z.o.TOOL),this.view.on("pointer-down",(e=>{this._shouldHandlePointerEvent(e)&&(this._abortSnapping(),this._panEnabled||(this._resetGeometry(),this._addVertexOnPointerUp=!0,this._cursorScreenPoint=(0,A.ZV)(e),this._activePointerId=e.pointerId,this._vertexAddHandler(e),this._isDragging=!1,"touch"===e.pointerType&&this._updateCursor()))}),Z.o.TOOL),this.view.on("pointer-move",(e=>{this._abortSnapping(),null==this._activePointerId&&"touch"!==e.pointerType&&(this._cursorScreenPoint=(0,A.ZV)(e),this._updateCursor())}),Z.o.TOOL),this.view.on("pointer-drag",(e=>{this._shouldHandlePointerEvent(e)&&(this._abortSnapping(),this._isDragging=!0,this._cursorScreenPoint=(0,A.ZV)(e),this._updateCursor())}),Z.o.TOOL),this.view.on("pointer-up",(e=>{this._shouldHandlePointerEvent(e)&&this._addVertexOnPointerUp&&(this._abortSnapping(),this._activePointerId=null,this._isDragging&&this._vertexAddHandler(e),2===this._committedVertices.length&&this._drawCompleteHandler(e),this._isDragging=!1)}),Z.o.TOOL),this.view.on("key-down",(e=>{e.key===H.NE.complete&&this._cursorScreenPoint?(this._abortSnapping(),this._vertexAddHandler(e),this._drawCompleteHandler(e)):e.key===H.NE.pan&&(this._panEnabled=!0)}),Z.o.TOOL),this.view.on("key-up",(e=>{e.key===H.NE.pan&&(this._panEnabled=!1)}),Z.o.TOOL),this.view.on("drag",(e=>{null!=this._activePointerId&&e.stopPropagation()}),Z.o.TOOL),this.view.on("drag",["Shift"],(e=>{e.stopPropagation()}),Z.o.TOOL)]}_getClickModeViewHandles(){return[this.view.on("pointer-down",(e=>{this._abortSnapping(),this._cursorScreenPoint=(0,A.ZV)(e),this._activePointerId=e.pointerId,this._isDragging=!1,"touch"===e.pointerType&&this._updateCursor()}),Z.o.TOOL),this.view.on("pointer-move",(e=>{this._abortSnapping(),this._cursorScreenPoint=(0,A.ZV)(e),null==this._activePointerId&&"touch"!==e.pointerType&&this._updateCursor()}),Z.o.TOOL),this.view.on("pointer-drag",(e=>{this._shouldHandlePointerEvent(e)&&(this._abortSnapping(),this._isDragging=!0)}),Z.o.TOOL),this.view.on("pointer-up",(e=>{this._shouldHandlePointerEvent(e)&&(this._abortSnapping(),this._activePointerId=null,e.stopPropagation(),this._isDragging||this._vertexAddHandler(e),2!==this.vertices.length||this._isDragging||this._drawCompleteHandler(e),this._isDragging=!1)}),Z.o.TOOL),this.view.on("key-down",(e=>{e.key===H.NE.vertexAdd&&this._cursorScreenPoint&&(this._vertexAddHandler(e),2===this.vertices.length&&this._drawCompleteHandler(e)),e.key===H.NE.complete&&this._cursorScreenPoint&&2===this.vertices.length&&(this._vertexAddHandler(e),this._drawCompleteHandler(e))}),Z.o.TOOL)]}_addDrawTool(){const e=new z({view:this.view,elevationInfo:this.elevationInfo,hasZ:this.hasZ,geometryType:"segment",mode:this.mode});this._drawTool=e,this.view.addAndActivateTool(e),this.addHandles([e.on("vertex-add",(t=>{1===t.vertices.length&&this.emit("vertex-add",new T(this.view,t.vertices[0].vertexIndex,e.getVertexCoords()))})),e.on("cursor-update",(t=>{1===t.vertices.length&&this.emit("cursor-update",new C(this.view,t.vertices[0].vertexIndex,e.getVertexCoords()))})),e.on("complete",(t=>{this.emit("draw-complete",new S(e.getVertexCoords())),this._removeDrawTool()})),this.view.on("key-down",(t=>{t.key!==H.NE.vertexAdd||t.repeat||"click"!==this.mode?t.key!==H.NE.complete||t.repeat||e.completeCreateOperation():e.drawOperation.numCommittedVertices>0?e.completeCreateOperation():e.drawOperation.commitStagedVertex()}),Z.o.TOOL)])}_removeDrawTool(){this._drawTool&&(this.view.tools.remove(this._drawTool),this._drawTool=null)}_addVertex(e){const t=this._coordinateHelper.arrayToVector(e);if(this._isDuplicateOfLastVertex(t))return;this._lastVertexUnsnapped=this._stagedVertexUnsnapped,this._popCursorVertex(),this._editGeometryOperations.appendVertex(t),1===this._committedVertices.length&&(this.viewAlignedCoordinateSystem=(0,q.ZP)(this.view,this._committedVertices[0]));const i=this._committedVertices.length-1,o=new T(this.view,i,this.vertices);this.emit("vertex-add",o)}_updateCursor(){if(this._popCursorVertex(),!this._cursorScreenPoint)return;const e=this.getCoordsAndPointFromScreenPoint(this._cursorScreenPoint);null!=e&&this._pushCursorVertex(e.vertex,(()=>this.emit("cursor-update",new C(this.view,this._activeComponent.vertices.length,this.vertices,null!=this._stagedVertex?new E.A(this._stagedVertex):null))))}_completeDrawing(){if(this._drawTool)return this._drawTool.completeCreateOperation(),void this.removeAllHandles();if(this._activePointerId=null,this._popCursorVertex(),this._cursorScreenPoint=null,this._isDragging=!1,this._abortSnapping(),null!=this._snappingManager&&this._snappingManager.doneSnapping(),this.vertices.length<1)return;const e=new S(this.vertices);this.emit("draw-complete",e),e.defaultPrevented||this.removeAllHandles()}_resetGeometry(){this._editGeometryOperations.destroy(),this._editGeometryOperations=new w.p(new y.ZE("polygon",this._coordinateHelper)),this._activeComponent=new y.uA(this._coordinateHelper.spatialReference,_.RT.Local),this._editGeometryOperations.data.components.push(this._activeComponent)}};(0,n._)([(0,r.MZ)({type:["freehand","click"]})],Y.prototype,"mode",void 0),Y=(0,n._)([(0,a.$)("esri/views/2d/engine/markup/SegmentDrawAction")],Y);let $=class extends s.A{constructor(){super(...arguments),this.activeAction=null,this.type="draw",this.view=null}destroy(){this.activeAction&&(this.activeAction.destroy(),this.activeAction=null)}create(e,t){this.reset();const i={view:this.view,...t};switch(e){case"point":i.editGeometryType="point",this.activeAction=new N(i);break;case"polyline":i.editGeometryType="polyline",this.activeAction=new B(i);break;case"multipoint":i.editGeometryType="polygon",this.activeAction=new L(i);break;case"polygon":i.editGeometryType="polygon",this.activeAction=new K(i);break;case"rectangle":case"circle":case"ellipse":case"triangle":i.editGeometryType="polygon",this.activeAction=new Y(i)}return this.activeAction}complete(){this.activeAction&&this.activeAction.complete(),this.activeAction=null}reset(){this.activeAction&&this.activeAction.destroy(),this.activeAction=null}};(0,n._)([(0,r.MZ)()],$.prototype,"activeAction",void 0),(0,n._)([(0,r.MZ)({readOnly:!0})],$.prototype,"type",void 0),(0,n._)([(0,r.MZ)()],$.prototype,"view",void 0),$=(0,n._)([(0,a.$)("esri.views.draw.Draw")],$);const W=$},91720:(e,t,i)=>{i.d(t,{l:()=>f});var o=i(35143),n=i(91967),s=i(54099),r=i(68134),a=i(76931),l=i(46053),d=(i(81806),i(76460),i(47249),i(85842)),h=i(19555),p=i(20664),c=i(9392),u=i(9624),v=i(64232),_=i(12482),g=i(84202),m=i(731),y=i(22579),w=i(55754);let f=class extends n.A{set graphic(e){this._circleCollisionCache=null,this._originalSymbol=e.symbol,this._set("graphic",e),this.attachSymbolChanged()}get elevationInfo(){const{layer:e}=this.graphic,t=e&&"elevationInfo"in e?e.elevationInfo:null,i=(0,_.ky)(this.graphic),o=t?t.offset:0;return new m.A({mode:i,offset:o})}set focusedSymbol(e){e!==this._get("focusedSymbol")&&(this._set("focusedSymbol",e),this._updateGraphicSymbol(),this._circleCollisionCache=null)}grabbableForEvent(){return!0}set grabbing(e){e!==this._get("grabbing")&&(this._set("grabbing",e),this._updateGraphicSymbol())}set hovering(e){e!==this._get("hovering")&&(this._set("hovering",e),this._updateGraphicSymbol())}set selected(e){e!==this._get("selected")&&(this._set("selected",e),this._updateGraphicSymbol(),this.events.emit("select-changed",{action:e?"select":"deselect"}))}get _focused(){return this._get("hovering")||this._get("grabbing")}constructor(e){super(e),this.layer=null,this.interactive=!0,this.selectable=!1,this.grabbable=!0,this.dragging=!1,this.cursor=null,this.consumesClicks=!0,this.events=new s.A.EventEmitter,this._circleCollisionCache=null,this._graphicSymbolChangedHandle=null,this._originalSymbol=null}destroy(){this.detachSymbolChanged(),this._resetGraphicSymbol(),this._set("view",null)}intersectionDistance(e){const t=this.graphic;if(!1===t.visible)return null;const i=t.geometry;if(null==i)return null;const o=this._get("focusedSymbol"),n=null!=o?o:t.symbol;return"2d"===this.view.type?this._intersectDistance2D(this.view,e,i,n):this._intersectDistance3D(this.view,e,t)}attach(){this.attachSymbolChanged(),null!=this.layer&&this.layer.add(this.graphic)}detach(){this.detachSymbolChanged(),this._resetGraphicSymbol(),null!=this.layer&&this.layer.remove(this.graphic)}attachSymbolChanged(){this.detachSymbolChanged(),this._graphicSymbolChangedHandle=(0,r.watch)((()=>{var e;return null===(e=this.graphic)||void 0===e?void 0:e.symbol}),(e=>{null!=e&&e!==this.focusedSymbol&&e!==this._originalSymbol&&(this._originalSymbol=e,this._focused&&null!=this.focusedSymbol&&(this.graphic.symbol=this.focusedSymbol))}),r.sync)}detachSymbolChanged(){null!=this._graphicSymbolChangedHandle&&(this._graphicSymbolChangedHandle.remove(),this._graphicSymbolChangedHandle=null)}onElevationChange(){}onViewChange(){}_updateGraphicSymbol(){this.graphic.symbol=this._focused&&null!=this.focusedSymbol?this.focusedSymbol:this._originalSymbol}_resetGraphicSymbol(){this.graphic.symbol=this._originalSymbol}_intersectDistance2D(e,t,i,o){var n;if(null==(o=o||(0,g.SF)(i)))return null;let s=this._circleCollisionCache;if("point"===i.type&&"cim"===o.type&&"CIMPointSymbol"===(null===(n=o.data.symbol)||void 0===n?void 0:n.type)&&o.data.symbol.symbolLayers){const{offsetX:n,offsetY:s,size:r}=(0,y.T)(o),l=(0,a.WA)(t,b),d=r/2,p=e.toScreen(i),c=p.x+n,u=p.y+s;return(0,h.hG)(l,[c,u])<d*d?1:null}if("point"!==i.type||"simple-marker"!==o.type)return(0,w.t)(t,i,e)?1:null;if(null==s||!s.originalPoint.equals(i)){const t=i,n=e.spatialReference;if((0,u.canProjectWithoutEngine)(t.spatialReference,n)){const e=(0,u.project)(t,n);s={originalPoint:t.clone(),mapPoint:e,radiusPx:(0,a.Lz)(o.size)},this._circleCollisionCache=s}}if(null!=s){var r;const i=(0,a.WA)(t,b),n=null===(r=e.toScreen)||void 0===r?void 0:r.call(e,s.mapPoint);if(!n)return null;const l=s.radiusPx,d=n.x+(0,a.Lz)(o.xoffset),p=n.y-(0,a.Lz)(o.yoffset);return(0,h.hG)(i,[d,p])<l*l?1:null}return null}_intersectDistance3D(e,t,i){const o=e.toMap(t,{include:[i]});return o&&(0,v.g)(o,x,e.renderSpatialReference)?(0,p.q)(x,e.state.camera.eye):null}};(0,o._)([(0,l.MZ)({constructOnly:!0,nonNullable:!0})],f.prototype,"graphic",null),(0,o._)([(0,l.MZ)()],f.prototype,"elevationInfo",null),(0,o._)([(0,l.MZ)({constructOnly:!0,nonNullable:!0})],f.prototype,"view",void 0),(0,o._)([(0,l.MZ)({value:null})],f.prototype,"focusedSymbol",null),(0,o._)([(0,l.MZ)({constructOnly:!0})],f.prototype,"layer",void 0),(0,o._)([(0,l.MZ)()],f.prototype,"interactive",void 0),(0,o._)([(0,l.MZ)()],f.prototype,"selectable",void 0),(0,o._)([(0,l.MZ)()],f.prototype,"grabbable",void 0),(0,o._)([(0,l.MZ)({value:!1})],f.prototype,"grabbing",null),(0,o._)([(0,l.MZ)()],f.prototype,"dragging",void 0),(0,o._)([(0,l.MZ)()],f.prototype,"hovering",null),(0,o._)([(0,l.MZ)({value:!1})],f.prototype,"selected",null),(0,o._)([(0,l.MZ)()],f.prototype,"cursor",void 0),f=(0,o._)([(0,d.$)("esri.views.interactive.GraphicManipulator")],f);const x=(0,c.vt)(),b=(0,a.gs)()},95327:(e,t,i)=>{i.d(t,{A:()=>l});var o=i(35143),n=i(91967),s=i(46053),r=(i(81806),i(76460),i(47249),i(85842));let a=class extends n.A{constructor(e){super(e),this.enabled=!1}};(0,o._)([(0,s.MZ)({type:Boolean,nonNullable:!0})],a.prototype,"enabled",void 0),a=(0,o._)([(0,r.$)("esri.views.interactive.sketch.SketchLabelOptions")],a);const l=a},22579:(e,t,i)=>{i.d(t,{T:()=>n});var o=i(76931);function n(e){let t=0,i=0,n=0;return e?("cim"===e.type&&e.data.symbol&&"symbolLayers"in e.data.symbol&&e.data.symbol.symbolLayers&&e.data.symbol.symbolLayers.map((e=>{"CIMVectorMarker"===e.type&&e.anchorPoint&&(Math.abs(e.anchorPoint.x)>t&&(t=e.anchorPoint.x),Math.abs(e.anchorPoint.y)>i&&(i=e.anchorPoint.y),null!=e.size&&e.size>n&&(n=e.size))})),t=(0,o.Lz)(t),i=(0,o.Lz)(i),n=(0,o.Lz)(n),{offsetX:t,offsetY:i,size:n}):{offsetX:t,offsetY:i,size:n}}},69124:(e,t,i)=>{i.d(t,{j:()=>d});var o=i(35143),n=i(91967),s=i(76460),r=i(68134),a=i(46053),l=(i(81806),i(47249),i(85842));let d=class extends n.A{constructor(e){super(e),this.tool=null,this._loggedUnsupportedErrorOnce=!1,this.logger=s.A.getLogger(this),null!=(null===e||void 0===e?void 0:e.visible)&&(this.visible=e.visible)}initialize(){this.addHandles((0,r.watch)((()=>({ready:null!=this.view&&this.view.ready,supported:this.supported})),(e=>{let{ready:t,supported:i}=e;!t||i||this._loggedUnsupportedErrorOnce||(this.logError(this.unsupportedErrorMessage),this._loggedUnsupportedErrorOnce=!0)}),r.syncAndInitial))}destroy(){this.removeTool(),this.view=null}get active(){return null!=this.tool&&this.tool.active}get disabled(){return null==this.view||!this.view.ready||!this.supported}get supported(){return null==this.view||this.view.type===this.supportedViewType}get view(){return this._get("view")}set view(e){if(e===this.view)return;this.removeTool(),this._set("view",e);const t="tools";this.removeHandles(t),null!=e&&this.addHandles(e.tools.on("after-remove",(e=>{e.item===this.tool&&this._set("tool",null)})),t)}set visible(e){this._set("visible",e),null!=this.tool&&(this.tool.visible=e)}createTool(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{interactive:!1};if(this.removeTool(),null==this.view||!this.view.ready||!this.supported)return;const t=this.constructTool();t.created?(this._set("tool",t),this.view.tools.add(t)):e.interactive?(this._set("tool",t),this.view.addAndActivateTool(t),(0,r.when)((()=>t.created),(()=>{t.active&&null!=this.view&&(this.view.activeTool=null)}),{initial:!0,once:!0})):t.destroy()}removeTool(){var e;const t=this.tool;if(null==t)return;const i=null===(e=this.view)||void 0===e?void 0:e.tools;null!=i?i.remove(t):t.destroy(),this._set("tool",null)}logError(){this.logger.error(...arguments)}};(0,o._)([(0,a.MZ)({constructOnly:!0})],d.prototype,"tool",void 0),(0,o._)([(0,a.MZ)()],d.prototype,"active",null),(0,o._)([(0,a.MZ)()],d.prototype,"disabled",null),(0,o._)([(0,a.MZ)()],d.prototype,"supported",null),(0,o._)([(0,a.MZ)({value:null})],d.prototype,"view",null),(0,o._)([(0,a.MZ)({type:Boolean,value:!0})],d.prototype,"visible",null),d=(0,o._)([(0,l.$)("esri.widgets.support.InteractiveToolViewModel")],d)},33353:(e,t,i)=>{i.d(t,{I:()=>c});var o=i(35143),n=i(46053),s=(i(81806),i(76460),i(47249),i(85842)),r=i(25329),a=i(77666),l=i(47370),d=(i(76099),i(54761));const h="esri-measurement-widget-content",p={base:h,actions:"".concat(h,"__actions"),error:"".concat(h,"__error"),hint:"".concat(h,"__hint"),hintText:"".concat(h,"__hint-text"),panelError:"".concat(h,"__panel--error"),settings:"".concat(h,"__settings"),measurement:"".concat(h,"__measurement"),measurementItem:"".concat(h,"__measurement-item"),measurementItemDisabled:"".concat(h,"__measurement-item--disabled"),measurementItemTitle:"".concat(h,"__measurement-item__title"),measurementItemValue:"".concat(h,"__measurement-item__value")};let c=class extends r.A{constructor(e,t){super(e,t)}loadDependencies(){return(0,a.W)({button:()=>Promise.all([i.e(39879),i.e(62785),i.e(95203),i.e(75151),i.e(11309)]).then(i.bind(i,11309))})}render(){return(0,d.K)("div",{class:p.base},this._renderContent())}_renderContent(){const{supported:e,active:t,state:i}=this;switch(i){case"disabled":case"ready":return e?t?this._renderHint():this._renderActions():this._renderUnsupportedMessage();case"measuring":case"measured":return[this._renderSettings(),this._renderMeasurement(),this._renderActions()]}}_renderUnsupportedMessage(){return(0,d.K)("section",{class:p.error,key:"unsupported"},(0,d.K)("p",null,this.messages.unsupported))}_renderHint(){const{messages:e}=this;return(0,d.K)("section",{class:p.hint,key:"hint"},(0,d.K)("p",{class:p.hintText},e.hint))}_renderSettings(){return(0,d.K)("div",{class:p.settings,key:"settings"},(0,d.K)(l.t,{options:this.unitOptions,selectLabel:this.messages.unit,value:this.unit,onChange:this.onUnitChange}))}_renderMeasurement(){return(0,d.K)("section",{class:p.measurement,key:"measurement"},this.measurementItems.map((e=>this._renderMeasurementItem(e))))}_renderMeasurementItem(e){let{key:t,title:i,value:o}=e;return(0,d.K)("div",{class:this.classes(p.measurementItem,null==o&&p.measurementItemDisabled),key:t},(0,d.K)("span",{class:p.measurementItemTitle},i),(0,d.K)("span",{"aria-live":"polite",class:p.measurementItemValue},null!==o&&void 0!==o?o:this.messages.notApplicable))}_renderActions(){const{messages:e}=this;return(0,d.K)("div",{class:p.actions},(0,d.K)("calcite-button",{class:this.newMeasurementButtonClass,disabled:"disabled"===this.state,onclick:this.onNewMeasurementClick},e.newMeasurement))}};(0,o._)([(0,n.MZ)()],c.prototype,"active",void 0),(0,o._)([(0,n.MZ)()],c.prototype,"measurementItems",void 0),(0,o._)([(0,n.MZ)()],c.prototype,"messages",void 0),(0,o._)([(0,n.MZ)()],c.prototype,"newMeasurementButtonClass",void 0),(0,o._)([(0,n.MZ)()],c.prototype,"onNewMeasurementClick",void 0),(0,o._)([(0,n.MZ)()],c.prototype,"onUnitChange",void 0),(0,o._)([(0,n.MZ)()],c.prototype,"state",void 0),(0,o._)([(0,n.MZ)()],c.prototype,"supported",void 0),(0,o._)([(0,n.MZ)()],c.prototype,"unit",void 0),(0,o._)([(0,n.MZ)()],c.prototype,"unitOptions",void 0),c=(0,o._)([(0,s.$)("esri.widgets.support.MeasurementWidgetContent")],c)},47370:(e,t,i)=>{i.d(t,{t:()=>u});var o=i(35143),n=i(31633),s=i(46053),r=(i(81806),i(76460),i(47249),i(85842)),a=i(25329),l=i(77666),d=(i(76099),i(63582)),h=i(54761);const p="esri-unit-select",c={base:p,label:"".concat(p,"__label"),select:"".concat(p,"__select")};let u=class extends a.A{constructor(e,t){super(e,t),this._onSelectChange=e=>{this.onChange(e.target.value)}}loadDependencies(){return(0,l.W)({label:()=>Promise.all([i.e(39879),i.e(65423)]).then(i.bind(i,65423)),option:()=>i.e(70383).then(i.bind(i,92764)),select:()=>Promise.all([i.e(39879),i.e(95203),i.e(81381)]).then(i.bind(i,81381))})}render(){const{messages:e,options:t,selectLabel:i,value:o,_onSelectChange:s}=this;return(0,h.K)("div",{class:c.base,key:"units"},(0,h.K)("calcite-label",{class:c.label},i,(0,h.K)("calcite-select",{class:c.select,label:i,onCalciteSelectChange:s},t.map((t=>{var i;return(0,h.K)("calcite-option",{key:t,selected:t===o,value:t},(0,n.GT)(t)?e.systems[t]:null===(i=e.units[t])||void 0===i?void 0:i.pluralCapitalized)})))))}};(0,o._)([(0,s.MZ)()],u.prototype,"options",void 0),(0,o._)([(0,s.MZ)()],u.prototype,"onChange",void 0),(0,o._)([(0,s.MZ)()],u.prototype,"selectLabel",void 0),(0,o._)([(0,s.MZ)()],u.prototype,"value",void 0),(0,o._)([(0,s.MZ)(),(0,d.G)("esri/core/t9n/Units")],u.prototype,"messages",void 0),u=(0,o._)([(0,r.$)("esri.widgets.support.UnitSelect")],u)}}]);
//# sourceMappingURL=44850.64728e2a.chunk.js.map