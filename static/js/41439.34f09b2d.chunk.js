"use strict";(self.webpackChunkhelloworld=self.webpackChunkhelloworld||[]).push([[41439,33106],{41439:(e,t,i)=>{i.r(t),i.d(t,{default:()=>tt});var r=i(35143),s=i(55171),n=i(58963),o=i(48053),a=i(19276),l=i(50076),d=i(53084),p=i(49304),u=i(27741),c=i(76460),h=i(30726),y=i(77717),g=i(91291),v=i(50346),m=i(68134),_=i(90534),w=i(46053),b=(i(81806),i(28379)),f=i(85842),A=i(17707),E=i(37888),S=i(6527),T=i(76797),I=i(91605),L=i(9624),R=i(13312),M=i(47700),C=i(19902),N=i(80963),O=i(65308),P=i(70652),k=i(79942),U=i(72945),j=i(86300),F=i(61941),Z=i(72027);function x(){return new l.A("webscene:failed-to-copy-embedded-resources","Copying of embedded resources is currently not supported")}function V(e){return new l.A("webscene:schema-validation","Failed to save webscene due to schema validation errors. See 'details.errors' for more detailed information",{errors:e})}var D,G=i(64465),B=i(59801),Y=i(61701),q=i(79880),W=i(65526),$=i(24907),H=i(94200),K=i(42553),Q=(i(47249),i(3232));let J=D=class extends K.oY{constructor(e){super(e),this.viewing=null}clone(){return new D({viewing:this.viewing?this.viewing.clone():null})}};(0,r._)([(0,w.MZ)({type:Q.A,json:{write:!0}})],J.prototype,"viewing",void 0),J=D=(0,r._)([(0,f.$)("esri.webscene.ApplicationProperties")],J);const X=J;var z,ee=i(41653);let te=z=class extends K.oY{constructor(e){super(e),this.environment=new ee.A,this.spatialReference=null,this.viewpoint=null}set viewingMode(e){this._set("viewingMode",e)}clone(){return new z({environment:this.environment.clone(),spatialReference:this.spatialReference?this.spatialReference.clone():null,viewingMode:this.viewingMode,viewpoint:this.viewpoint?this.viewpoint.clone():null})}};(0,r._)([(0,w.MZ)({type:ee.A,json:{write:{isRequired:!0}}})],te.prototype,"environment",void 0),(0,r._)([(0,w.MZ)({type:R.A})],te.prototype,"spatialReference",void 0),(0,r._)([(0,w.MZ)({type:["local","global"]})],te.prototype,"viewingMode",null),(0,r._)([(0,w.MZ)({type:o.A,json:{write:{isRequired:!0}}})],te.prototype,"viewpoint",void 0),te=z=(0,r._)([(0,f.$)("esri.webscene.InitialViewProperties")],te);const ie=te;var re,se=i(3975),ne=i(21403),oe=i(194),ae=i(98773),le=i(15941),de=i(40565),pe=i(20664),ue=i(9392),ce=i(25515),he=i(59752),ye=i(994),ge=i(98277),ve=i(99372);let me=re=class extends K.oY{constructor(){super(...arguments),this.text=""}clone(){return new re({text:this.text})}};(0,r._)([(0,w.MZ)({type:String,json:{write:!0}})],me.prototype,"text",void 0),me=re=(0,r._)([(0,f.$)("esri.webscene.support.Description")],me);const _e=me;var we,be=i(68814),fe=i(53203),Ae=i(30650);let Ee=we=class extends K.oY{constructor(){super(...arguments),this.lighting=new ge.A,this.weather=new be.A}clone(){return new we({lighting:(0,d.o8)(this.lighting),weather:(0,d.o8)(this.weather)})}};(0,r._)([(0,w.MZ)({types:Ae.S,json:{write:!0}})],Ee.prototype,"lighting",void 0),(0,r._)([(0,w.MZ)({types:fe.eM,json:{write:!0}})],Ee.prototype,"weather",void 0),Ee=we=(0,r._)([(0,f.$)("esri.webscene.Environment")],Ee);var Se,Te=i(18364),Ie=i(2183);let Le=Se=class extends K.oY{constructor(){super(...arguments),this.opacity=null}clone(){return new Se({opacity:this.opacity})}cloneAndApplyTo(e){var t,i;return null==this.opacity||((e=null!==(t=null===(i=e)||void 0===i?void 0:i.clone())&&void 0!==t?t:new Te.A).opacity=this.opacity),e}static fromGround(e){return new Se({opacity:e.opacity})}};(0,r._)([(0,w.MZ)({type:Number,json:{type:de.jz,read:{reader:Ie.D,source:"transparency"},write:{writer:(e,t)=>{t.transparency=(0,Ie.p)(e)},target:"transparency"}}})],Le.prototype,"opacity",void 0),Le=Se=(0,r._)([(0,f.$)("esri.webscene.support.SlideGround")],Le);const Re=Le;var Me;let Ce=Me=class extends K.oY{constructor(e){super(e),this.id="",this.sublayerIds=null}clone(){return new Me({id:this.id,sublayerIds:(0,d.o8)(this.sublayerIds)})}};var Ne;(0,r._)([(0,w.MZ)({type:String,json:{write:!0}})],Ce.prototype,"id",void 0),(0,r._)([(0,w.MZ)({type:[de.jz],json:{read:{source:"subLayerIds"},write:{target:"subLayerIds"}}})],Ce.prototype,"sublayerIds",void 0),Ce=Me=(0,r._)([(0,f.$)("esri.webscene.support.SlideVisibleLayer")],Ce);let Oe=Ne=class extends K.oY{constructor(){super(...arguments),this.text=""}clone(){return new Ne({text:this.text})}};(0,r._)([(0,w.MZ)({type:String,json:{write:{isRequired:!0}}})],Oe.prototype,"text",void 0),Oe=Ne=(0,r._)([(0,f.$)("esri.webscene.support.Title")],Oe);const Pe=Oe;let ke=0;const Ue=a.A.ofType(Ce);let je=class extends K.oY{constructor(e){super(e),this.id=Date.now().toString(16)+"-slide-"+ke++,this.title=new Pe,this.description=new _e,this.hidden=!1,this.thumbnail=new ye.o,this.viewpoint=null,this.basemap=null,this.ground=null,this.environment=new Ee,this.visibleLayers=new Ue}destroy(){this.visibleLayers.removeAll(),this.basemap=null,this.thumbnail=(0,h.pR)(this.thumbnail),this.description=null,this.title=null,this.thumbnail=null}castTitle(e){return"string"==typeof e?new Pe({text:e}):(0,de.dp)(Pe,e)}castDescription(e){return"string"==typeof e?new _e({text:e}):(0,de.dp)(_e,e)}castThumbnail(e){return"string"==typeof e?new ye.o({url:e}):(0,de.dp)(ye.o,e)}castBasemap(e){return(0,j.dp)(e)}set visibleLayers(e){this._set("visibleLayers",(0,se.V)(e,this._get("visibleLayers"),Ue))}castVisibleLayers(e){return e&&"function"==typeof e.map?e.map((e=>{if("string"==typeof e)return{id:e};if(e instanceof ce.A){const t=Ze(e);return{id:e.id,sublayerIds:t}}return e.id?{id:e.id,sublayerIds:"sublayerIds"in e?e.sublayerIds:void 0}:(c.A.getLogger(this).warn('Invalid visible layer, expected { id }, Layer or "id"'),e)})):null}clone(){var e,t;return new(0,this.constructor)({id:this.id,title:this.title.clone(),thumbnail:this.thumbnail.clone(),description:this.description&&this.description.clone()||null,viewpoint:this.viewpoint&&this.viewpoint.clone()||null,basemap:(null===(e=this.basemap)||void 0===e?void 0:e.clone())||null,ground:(null===(t=this.ground)||void 0===t?void 0:t.clone())||null,visibleLayers:this.visibleLayers.clone(),environment:this.environment&&this.environment.clone()||null,hidden:this.hidden})}async _updateVisibleLayersFrom(e){const t=[];await Promise.allSettled(this._getLayers(e.map).map((i=>e.whenLayerView(i).then((e=>{if(e.visible){const r=Ze(i);t.push(new Ce({id:e.layer.id,sublayerIds:r}))}})))).toArray()),this.visibleLayers.removeAll(),this.visibleLayers.addMany(t)}updateFrom(e,t){const i={format:"png",quality:80,width:120,height:75,disableDecorations:!0,...null===t||void 0===t?void 0:t.screenshot};return e.when((()=>(this.viewpoint=e.viewpoint.clone(),this.environment.lighting="virtual"===e.environment.lighting.type?ve.A.prototype.clone.apply(e.environment.lighting):ge.A.prototype.clone.apply(e.environment.lighting),this.environment.weather=e.environment.weather.clone(),this.basemap=e.map.basemap&&e.map.basemap.clone()||null,this.ground=e.map.ground?Re.fromGround(e.map.ground):null,this._updateVisibleLayersFrom(e)))).then((()=>e.takeScreenshot(i))).then((e=>(this.thumbnail=new ye.o({url:e.dataUrl}),this)))}async applyTo(e,t){null!=this._applyToController&&this._applyToController.abort();let i=new AbortController;this._applyToController=i;const r=(0,v.NY)(t,(()=>{var e;return null===(e=i)||void 0===e?void 0:e.abort()})),s=()=>{this._applyToController===i&&(this._applyToController=null),i=null,null===r||void 0===r||r.remove()};try{await(0,m.whenOnce)((()=>e.ready),i.signal)}catch(Ye){throw s(),Ye}if(i.signal.aborted)throw s(),(0,v.NK)();const n=e.resourceController.scheduler.registerTask(he.W6.SLIDE);let o=!1;const a={animate:!0,...t,signal:this._applyToController.signal},l=await(0,ae.Ke)(e.addUpdatingPromise((async()=>{await Promise.all([n.schedule((async()=>o=await this._setViewpointOfInterest(e,a))),n.schedule((()=>this._applyBasemap(e,a)),a.signal)]),await this._loadLayersWithSublayerVisibility(e),await Promise.all([n.schedule((()=>this._applyLayerVisibility(e)),a.signal),n.schedule((()=>this._applyGround(e)),a.signal),n.schedule((()=>this._applyViewpoint(e,a)),a.signal)]),await n.schedule((()=>e.environment.weather=this.environment.weather.clone()))})()));if(o&&(e.contentCamera=null),n.remove(),s(),!1===l.ok)throw l.error;return this}async _applyBasemap(e,t){if(this.basemap){try{await this.basemap.load(t)}catch(D){if((0,v.zf)(D))throw D}e.map.basemap=(0,j.d0)(this.basemap,e.map.basemap)}}_applyGround(e){this.ground&&(e.map.ground=this.ground.cloneAndApplyTo(e.map.ground))}_getLayers(e){const t=new a.A;return this._collectLayers(e,t),this._collectLayers(e.ground,t),t}_collectLayers(e,t){e.layers.forEach((e=>{e.persistenceEnabled&&(t.add(e),"layers"in e&&this._collectLayers(e,t))}))}async _loadLayersWithSublayerVisibility(e){this.visibleLayers&&await Promise.allSettled(this._getLayers(e.map).items.map((e=>{var t;return(null===(t=this.visibleLayers.find((t=>t.id===e.id)))||void 0===t?void 0:t.sublayerIds)?e.load():null})))}_applyLayerVisibility(e){this.visibleLayers&&this._getLayers(e.map).forEach((e=>{const t=this.visibleLayers.find((t=>t.id===e.id));e.visible=null!=t;const i=null===t||void 0===t?void 0:t.sublayerIds,r=Fe(e);i&&r&&r.forEach((e=>e.visible=i.includes(e.id)))}))}async _setViewpointOfInterest(e,t){if(e.state.fixedContentCamera||!this.viewpoint||null!==t&&void 0!==t&&t.ignoreViewpoint||null===t||void 0===t||!t.useDestinationCamera)return!1;const{toCameraAsync:r}=await Promise.all([i.e(36134),i.e(59231),i.e(38987),i.e(17881)]).then(i.bind(i,38987)),s=await r(e,this.viewpoint);return e.contentCamera=s,null!=s}async _applyViewpoint(e,t){if(this._applyCachedCameraTrackingEnabled(e),this.viewpoint&&!t.ignoreViewpoint){null!=this.viewpoint.camera&&(this.viewpoint.camera.fov=e.camera.fov);const i=this.environment.lighting;if(t.animate&&"sun"===i.type&&i.date)return this._animateToLighting(e,t);t.animate&&(e.environment.applyLighting(i.clone()),await e.goTo(this.viewpoint,t)),e.viewpoint=this.viewpoint}e.environment.applyLighting(this.environment.lighting.clone())}async _animateToLighting(e,t){let i=null;return"virtual"!==e.environment.lighting.type&&"virtual"!==this.environment.lighting.type&&("global"===e.viewingMode&&(i=this._animateLightingWithCamera(e,e.environment.lighting,this.environment.lighting)),e.environment.cachedCameraTrackingEnabled=e.environment.lighting.cameraTrackingEnabled,e.environment.lighting.cameraTrackingEnabled=!1),e.environment.lighting.directShadowsEnabled=this.environment.lighting.directShadowsEnabled,"virtual"===this.environment.lighting.type||"virtual"===e.environment.lighting.type?(e.environment.applyLighting(this.environment.lighting.clone()),"virtual"!==e.environment.lighting.type&&(e.environment.cachedCameraTrackingEnabled=e.environment.lighting.cameraTrackingEnabled,e.environment.lighting.cameraTrackingEnabled=!1)):null!=this.environment.lighting.displayUTCOffset&&(e.environment.lighting.displayUTCOffset=this.environment.lighting.displayUTCOffset),e.goTo(this.viewpoint,t).then((()=>{this._applyCachedCameraTrackingEnabled(e),e.environment.applyLighting(this.environment.lighting.clone())})).catch((t=>{throw null==e.animation&&this._applyCachedCameraTrackingEnabled(e),t})).finally((()=>{(0,h.xt)(i)}))}_applyCachedCameraTrackingEnabled(e){null!=e.environment.cachedCameraTrackingEnabled&&(e.environment.lighting.cameraTrackingEnabled=e.environment.cachedCameraTrackingEnabled,e.environment.cachedCameraTrackingEnabled=null)}_getTime(e){return[e.getTime(),3600*e.getUTCHours()+60*e.getUTCMinutes()+e.getUTCSeconds()]}_setTime(e,t,i){return e.setTime(t),e.setUTCHours(i/3600),e.setUTCMinutes(i%3600/60),e.setUTCSeconds(i%3600%60),e}_animateLightingWithCamera(e,t,i){const r=new Date(t.date.toString()),[s,n]=this._getTime(r),[o,a]=this._getTime(i.date),l=function(e,t){let i=t-e;return i>Ve&&(i-=xe),i<-Ve&&(i+=xe),i}(n,a),d=e.renderCoordsHelper,p=(0,ue.vt)();d.toRenderCoords(e.camera.position,p);const u=(0,ue.vt)(),c=(0,ue.vt)();null!=this.viewpoint.camera&&d.toRenderCoords(this.viewpoint.camera.position,u);const h=new Date;return(0,m.when)((()=>e.camera),(e=>{d.toRenderCoords(e.position,c);const i=(0,pe.a)(p,c),r=(0,pe.a)(u,c);let a=0;i+r!==0&&(a=i/(i+r));const y=s+(o-s)*a,g=function(e,t){return(0,le.OS)(e+t,xe)}(n,l*a);t.date=this._setTime(h,y,g)}))}static createFrom(e,t){return(new this).updateFrom(e,t)}};function Fe(e){if("building-scene"===e.type||"map-image"===e.type)return e.allSublayers.toArray()}function Ze(e){const t=Fe(e);if(t)return t.filter((e=>e.visible)).map((e=>e.id))}(0,r._)([(0,w.MZ)({type:String,json:{write:{isRequired:!0}}})],je.prototype,"id",void 0),(0,r._)([(0,w.MZ)({type:Pe,json:{default:()=>new Pe({text:""}),write:{isRequired:!0}}})],je.prototype,"title",void 0),(0,r._)([(0,ne.w)("title")],je.prototype,"castTitle",null),(0,r._)([(0,w.MZ)({type:_e,json:{write:{overridePolicy:e=>({enabled:!(!e||!e.text)})}}})],je.prototype,"description",void 0),(0,r._)([(0,ne.w)("description")],je.prototype,"castDescription",null),(0,r._)([(0,w.MZ)({type:Boolean,nonNullable:!0,json:{write:!0,default:!1}})],je.prototype,"hidden",void 0),(0,r._)([(0,w.MZ)({type:ye.o,json:{default:()=>new ye.o({url:""}),write:{isRequired:!0}}})],je.prototype,"thumbnail",void 0),(0,r._)([(0,ne.w)("thumbnail")],je.prototype,"castThumbnail",null),(0,r._)([(0,w.MZ)({type:o.A,nonNullable:!0,json:{write:{isRequired:!0}}})],je.prototype,"viewpoint",void 0),(0,r._)([(0,w.MZ)({type:oe.default,json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],je.prototype,"basemap",void 0),(0,r._)([(0,ne.w)("basemap")],je.prototype,"castBasemap",null),(0,r._)([(0,w.MZ)({type:Re,json:{write:!0}})],je.prototype,"ground",void 0),(0,r._)([(0,w.MZ)({type:Ue,json:{write:{isRequired:!0}}})],je.prototype,"visibleLayers",null),(0,r._)([(0,ne.w)("visibleLayers")],je.prototype,"castVisibleLayers",null),(0,r._)([(0,w.MZ)({type:Ee,json:{write:!0}})],je.prototype,"environment",void 0),je=(0,r._)([(0,f.$)("esri.webscene.Slide")],je);const xe=86400,Ve=43200;const De=je,Ge=a.A.ofType(De);let Be=class extends K.oY{constructor(e){super(e),this.slides=new Ge}destroy(){this.slides.forEach((e=>e.destroy())),this.slides.removeAll()}set slides(e){e&&(e=e.filter((e=>!!e.viewpoint))),this._set("slides",(0,se.V)(e,this._get("slides"),Ge))}clone(){return new(0,this.constructor)({slides:this.slides.clone()})}};(0,r._)([(0,w.MZ)({type:Ge,nonNullable:!0,json:{write:!0}}),(0,ne.w)(se.H)],Be.prototype,"slides",null),Be=(0,r._)([(0,f.$)("esri.webscene.Presentation")],Be);const Ye=Be;var qe;let We=qe=class extends K.oY{constructor(e){super(e)}clone(){return new qe({name:this.name,path:this.path,title:this.title})}};(0,r._)([(0,w.MZ)({type:String,json:{write:!0}})],We.prototype,"name",void 0),(0,r._)([(0,w.MZ)({type:String,json:{write:!0}})],We.prototype,"path",void 0),(0,r._)([(0,w.MZ)({type:String,json:{write:!0}})],We.prototype,"title",void 0),We=qe=(0,r._)([(0,f.$)("esri.webscene.TransportationNetwork")],We);const $e=We;var He=i(19898);class Ke extends He.R{constructor(e,t){super(e,t,"webscene")}get supportsGround(){return this.since(1,8)}get supportsVisibleElevationLayersInSlides(){return this.lessThan(1,8)}}let Qe=null;var Je;const Xe=new Ke(1,33),ze="Web Scene";let et=class extends(p.A.LoadableMixin((0,g.g)((0,y.P)(n.A)))){constructor(e){super(e),this[Je]=!0,this._layersIdGCTimeoutId=void 0,this._updateFromPromise=null,this.applicationProperties=null,this.clippingArea=null,this.clippingEnabled=!1,this.floorInfo=null,this.heightModelInfo=void 0,this.sourceVersion=null,this.transportationNetworks=null,this.presentation=new Ye,this.initialViewProperties=new ie,this.portalItem=null,this.resourceInfo=null,this._debouncedSaveOperations=(0,v.sg)((async(e,t,i)=>{switch(e){case Y.X.SAVE:return this._saveImpl(t);case Y.X.SAVE_AS:return this._saveAsImpl(i,t)}})),this._resourceReferences={portalItem:null,paths:[]},this.authoringApp=null,this.authoringAppVersion=null,this._isAuthoringAppSetByUser=!1,this._isAuthoringAppVersionSetByUser=!1}initialize(){if(this.when().catch((e=>{c.A.getLogger(this).error("#load()","Failed to load web scene",e)})),this.resourceInfo){let e;try{e=this._validateJSON(this.resourceInfo)}catch(re){return void this.addResolvingPromise(Promise.reject(re))}this.read(e),this.addResolvingPromise(this._validateSpatialReference()),this.addResolvingPromise(this._validateHeightModelInfo())}this.addHandles((0,m.on)((()=>this.allLayers),"change",(()=>this._scheduleLayersIdGC())))}destroy(){this._unscheduleLayersIdGC(),this.presentation&&this.presentation.destroy(),this.portalItem=(0,h.pR)(this.portalItem)}writeClippingArea(e,t){t.clippingArea||(t.clippingArea={}),t.clippingArea.geometry=e.toJSON()}readClippingEnabled(e,t){return!!t.clippingArea&&!!t.clippingArea.clip}writeClippingEnabled(e,t){this.clippingArea&&(t.clippingArea||(t.clippingArea={}),t.clippingArea.clip=e)}writeLayers(e,t,i,r){t[i]=this._layersToJSON(e,"operational-layers",r)}readSourceVersion(e,t){const[i,r]=t.version.split(".");return new Ke(parseInt(i,10),parseInt(r,10))}writeSourceVersion(e,t,i){t[i]="".concat(Xe.major,".").concat(Xe.minor)}writeTables(e,t,i,r){const s=this._layersToJSON(e,"tables",r);s.length&&(t[i]=s)}get thumbnailUrl(){var e,t;return null!==(e=null===(t=this.portalItem)||void 0===t?void 0:t.thumbnailUrl)&&void 0!==e?e:null}set thumbnailUrl(e){e?this._override("thumbnailUrl",e):(this._clearOverride("thumbnailUrl"),this.clear("thumbnailUrl","user"))}set authoringApp(e){this._isAuthoringAppSetByUser=!0,this._set("authoringApp",e)}writeAuthoringApp(e,t){e&&this._isAuthoringAppSetByUser?t.authoringApp=e:t.authoringApp="ArcGIS API for JavaScript"}set authoringAppVersion(e){this._isAuthoringAppVersionSetByUser=!0,this._set("authoringAppVersion",e)}writeAuthoringAppVersion(e,t){e&&this._isAuthoringAppVersionSetByUser?t.authoringAppVersion=e:t.authoringAppVersion=s.rE}writeGround(e,t,i,r){t[i]=e?e.write({},r):{transparency:0,layers:[]}}readInitialViewProperties(e,t){var i,r,s;const n={};return null!==(i=t.initialState)&&void 0!==i&&i.environment&&(n.environment=ee.A.fromJSON(t.initialState.environment)),n.spatialReference=t.spatialReference?R.A.fromJSON(t.spatialReference):R.A.WebMercator,n.viewingMode=null!==(r=t.viewingMode)&&void 0!==r?r:"global",null!==(s=t.initialState)&&void 0!==s&&s.viewpoint&&(n.viewpoint=o.A.fromJSON(t.initialState.viewpoint)),new ie(n)}get spatialReference(){var e,t;return null!==(e=null===(t=this.initialViewProperties)||void 0===t?void 0:t.spatialReference)&&void 0!==e?e:R.A.WebMercator}get viewingMode(){var e,t;return null!==(e=null===(t=this.initialViewProperties)||void 0===t?void 0:t.viewingMode)&&void 0!==e?e:"global"}load(e){const t=this.ground;return this.addResolvingPromise(this._loadFromSource().then((()=>{t&&t!==this.ground&&t.destroy()}))),Promise.resolve(this)}loadAll(){return(0,u.g)(this,(e=>{const t=this.presentation&&this.presentation.slides;e(this.ground,this.basemap,this.layers,t&&t.map((e=>e.basemap)),this.tables)}))}read(e,t){var i;t={...t,origin:"web-scene"};const r=this._isAuthoringAppVersionSetByUser,s=this._isAuthoringAppSetByUser;if((0,S.t)(this,e,(t=>super.read(e,t)),t),s||(this._isAuthoringAppSetByUser=!1),r||(this._isAuthoringAppVersionSetByUser=!1),e.baseMap&&Array.isArray(e.baseMap.elevationLayers)&&null!==(i=this.sourceVersion)&&void 0!==i&&i.supportsVisibleElevationLayersInSlides){const t=e.baseMap.elevationLayers.map((e=>({id:e.id}))),i=this.presentation.slides,r=(e,t)=>e.visibleLayers.some((e=>e.id===t)),s=t.filter((e=>!i.some((t=>r(t,e.id)))));i.forEach((e=>{e.visibleLayers.addMany(s)}))}}_writeBasemapElevationLayers(e){var t;const i=null===(t=e.ground)||void 0===t?void 0:t.layers;!e.baseMap&&null!==i&&void 0!==i&&i.length&&(e.baseMap={title:"Basemap",baseMapLayers:[]}),e.baseMap&&(e.baseMap.elevationLayers=(0,d.o8)(i))}_layersToJSON(e,t,i){const r={...i,layerContainerType:t};return e.map((e=>this._verifyWritableLayer(e,i)?e.write({},r):null)).filter((e=>!!e)).toArray()}_verifyWritableLayer(e,t){return!!e.persistenceEnabled&&("write"in e||(null!==t&&void 0!==t&&t.messages&&t.messages.push(new l.A("layer:unsupported","Layers (".concat(e.title,", ").concat(e.id,") of type '").concat(e.declaredClass,"' cannot be persisted in web scenes"),{layer:e})),!1))}write(e,t){var i;if("loaded"!==this.loadStatus){const e=new l.A("webscene:not-loaded","Web scene must be loaded before it can be serialized");throw c.A.getLogger(this).error("#toJSON()","Web scene must be loaded before it can be serialized",this.loadError||this.loadStatus),e}this._runLayersIdGC();const r=!(null!==(i=t)&&void 0!==i&&i.messages);t={messages:[],...t,origin:"web-scene"};const s=super.write(e,t);if(r){var n,o;const e=null!==(n=null===(o=t.messages)||void 0===o?void 0:o.filter((e=>"web-document-write:property-required"===e.name)))&&void 0!==n?n:[];if(e.length){const t=new l.A("web-document:property-required","One or more properties that are required in the webscene JSON are missing, see details for the specific errors",{errors:e});throw c.A.getLogger(this).error("#toJSON()","One or more properties that are required in the webscene JSON are missing",e),t}}return this._writeBasemapElevationLayers(s),s}async save(e){return this._debouncedSaveOperations(Y.X.SAVE,e)}async _saveImpl(e){var t;if(!this.portalItem)throw new l.A("webscene:portal-item-not-set","Portal item to save to has not been set on the WebScene");if((0,W.X)(this.portalItem),(null===(t=this.portalItem)||void 0===t?void 0:t.type)!==ze)throw new l.A("webscene:portal-item-wrong-type",'Portal item needs to have type "'.concat(ze,'"'));const i=this._updateFromPromise;await this._ensureLoadBeforeSave();const r=this._enableVerifyItemRelativeUrls((0,k.m)(this.portalItem,"web-scene",!0)),s=this.write({},r);return await Promise.all(r.resources.pendingOperations),await this._verifySave(s,r,e),this._updateTypeKeywords(this.portalItem),await(0,q.S)(this.portalItem,s,this._resourceReferences,r),(0,E.v)(r),i&&await i,await this._saveThumbnail(),this.portalItem}async saveAs(e,t){return this._debouncedSaveOperations(Y.X.SAVE_AS,t,e)}async _saveAsImpl(e,t){let i=P.default.from(e);if(!i)throw new l.A("webscene:portal-item-required","saveAs requires a portal item to save to");(0,W.X)(i),i.id&&(i=i.clone(),i.id=null);const r=i.portal||O.A.getDefault();await this._ensureLoadBeforeSave(),i.type=ze,i.portal=r;const s=this._enableVerifyItemRelativeUrls((0,k.m)(i,"web-scene",!0)),n=this.write({},s);await Promise.all(s.resources.pendingOperations),await this._verifySaveAs(n,s,t);const o=this.thumbnailUrl,a=!this._isOverridden("thumbnailUrl");if(this._updateTypeKeywords(i),await r.signIn(),!r.user)throw new l.A("webscene:user-not-signed-in","saveAs requires a user to be signed in to the portal");return await r.user.addItem({item:i,folder:null===t||void 0===t?void 0:t.folder,data:n}),await(0,q.r)(this._resourceReferences,s),this.portalItem=i,y.L.prototype.read.call(this,{version:n.version,authoringApp:n.authoringApp,authoringAppVersion:n.authoringAppVersion},{name:"web-scene",ignoreDefaults:!0,url:i.itemUrl?(0,_.An)(i.itemUrl):void 0}),(0,E.v)(s),o&&(this.thumbnailUrl=a?(0,_.rs)(o,"w","8192"):o),s.portalItem=i,await this._saveThumbnail(),i}async _saveThumbnail(){var e;this._isOverridden("thumbnailUrl")&&(await(null===(e=this.portalItem)||void 0===e?void 0:e.updateThumbnail({thumbnail:this.thumbnailUrl})),this._clearOverride("thumbnailUrl"),this.clear("thumbnailUrl","user"))}async _verifySave(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!(0,N.B3)(this.spatialReference))throw new l.A("webscene:unsupported-spatial-reference","Webscenes using spatial reference systems from Mars or Moon can not be saved currently.");const{ignoreUnsupported:s,requiredPropertyChecksDisabled:n,strictSchemaValidationEnabled:o}=i||{};(0,$.c)(t,{errorName:"webscene:save"},{ignoreUnsupported:s,supplementalUnsupportedErrors:["scenemodification:unsupported"],requiredPropertyChecksDisabled:n});const a=Qe;if(o&&a){const t=(await a()).validate(e);if(!t.length)return;const i="webscene did not validate:\n".concat(t.join("\n"));c.A.getLogger(this).error("".concat(r?"saveAs":"save","(): ").concat(i));const s=t.map((e=>new l.A("webscene:schema-validation",e)));throw V(s)}}_verifySaveAs(e,t,i){return this.canNotSaveAs(t)?Promise.reject(x()):this._verifySave(e,t,i,!0)}verifySaveAs(e){const t=this._enableVerifyItemRelativeUrls({origin:"web-scene",messages:[]}),i=this.write({},t);return this._verifySaveAs(i,t,e)}canNotSaveAs(e){var t,i;return e||(e=this._enableVerifyItemRelativeUrls({origin:"web-scene",messages:[]}),this.write({},e)),(null!==(t=null===(i=e.verifyItemRelativeUrls)||void 0===i||null===(i=i.writtenUrls)||void 0===i?void 0:i.length)&&void 0!==t?t:0)>0}async updateFrom(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=this._updateFrom(e,t);this._updateFromPromise=i,await i,this._updateFromPromise===i&&(this._updateFromPromise=null)}async _updateFrom(e){var t;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(await e.whenReady(),!i.environmentExcluded&&e.environment&&(this.initialViewProperties.environment=ee.A.prototype.clone.apply(e.environment)),!i.viewpointExcluded&&e.viewpoint&&(this.initialViewProperties.viewpoint=e.viewpoint.clone()),this.initialViewProperties.spatialReference=e.spatialReference.clone(),this.initialViewProperties.viewingMode=e.viewingMode,null!=e.clippingArea?e.clippingArea!==this.clippingArea&&(this.clippingArea=e.clippingArea.clone(),this.clippingEnabled=!0):this.clippingEnabled=!1,e.heightModelInfo&&(this.heightModelInfo=e.heightModelInfo.clone()),e.map===this)for(const r of e.allLayerViews){const e="visible";e in r&&e in r.layer&&r._isOverridden(e)&&(r.layer[e]=r[e])}(!1===i.thumbnailExcluded||null==i.thumbnailExcluded&&!i.viewpointExcluded)&&await this._updateFromThumbnail(e,null!==(t=i.thumbnailSize)&&void 0!==t?t:void 0)}async _updateFromThumbnail(e,t){const i=(0,H.S)(e,t),r=await e.takeScreenshot({format:"jpg",width:i.width,height:i.height,disableDecorations:!0});this.thumbnailUrl=r.dataUrl}_loadFromSource(){var e;return this.resourceInfo?this._loadFromJSON(this.resourceInfo,{origin:"web-scene"}):null!==(e=this.portalItem)&&void 0!==e&&e.id?this._loadFromItem(this.portalItem):this._loadObjectsWithLayers()}_readAndLoadFromJSON(e,t){const i=this._validateJSON(e);return this.read(i,t),this._loadFromJSON(i,t)}_extractOperationalLayers(e){var t;const i=[];if((null===(t=this.sourceVersion)||void 0===t||!t.supportsGround)&&e.baseMap&&Array.isArray(e.baseMap.elevationLayers))for(const n of e.baseMap.elevationLayers)i.push(n);const r=[],s=e=>{var t;return e.layers&&(e.layers=e.layers.filter(s)),"ArcGISTiledElevationServiceLayer"!==e.layerType||(null!==(t=this.sourceVersion)&&void 0!==t&&t.supportsGround||r.push(e),!1)};return{operationalLayers:e.operationalLayers?e.operationalLayers.filter(s):[],operationalElevationLayers:r,basemapElevationLayers:i}}async _loadFromJSON(e,t){var r;const s=new a.A;await this._validateSpatialReference(),await this._validateHeightModelInfo();const{populateOperationalLayers:n}=await Promise.all([i.e(2487),i.e(82620)]).then(i.bind(i,60239)),{operationalLayers:o,operationalElevationLayers:l,basemapElevationLayers:d}=this._extractOperationalLayers(e),p=[],u={context:{...t,layerContainerType:"operational-layers"}};if(this.portalItem&&(u.context.portal=this.portalItem.portal||O.A.getDefault()),d.length>0){const e={...u,context:{...u.context,layerContainerType:"ground"}};e.defaultLayerType="ArcGISTiledElevationServiceLayer",p.push(n(this.ground.layers,d,e))}if(l.length>0){const e={...u,context:{...u.context,layerContainerType:"ground"}};e.defaultLayerType="ArcGISTiledElevationServiceLayer",p.push(n(s,l,e))}o&&o.length>0&&p.push(n(this.layers,o,u)),null!==(r=e.tables)&&void 0!==r&&r.length&&p.push(n(this.tables,e.tables,{...u,context:{...u.context,layerContainerType:"tables"},defaultLayerType:"ArcGISFeatureLayer"})),await Promise.allSettled(p),await this._loadObjectsWithLayers(),this.ground.layers.addMany(s)}async _ensureLoadBeforeSave(){await this.load(),await this._loadObjectsWithLayers();const e=[],t=[...this.allLayers.items];for(const{basemap:i}of this.presentation.slides.items)i&&(t.push(...i.baseLayers.items),t.push(...i.referenceLayers.items));for(const i of t)if("beforeSave"in i&&"function"==typeof i.beforeSave){const t=i.beforeSave();t&&e.push(t)}await Promise.allSettled(e)}async _loadObjectsWithLayers(){const e=[];this.ground&&e.push(this.ground.load()),this.basemap&&e.push(this.basemap.load()),this.presentation.slides.forEach((t=>{t.basemap&&e.push(t.basemap.load())})),await Promise.allSettled(e)}async _loadFromItem(e){var t;if(await e.load().catch((e=>{throw new l.A("webscene:load-portal-item","Failed to load portal item",{error:e})})),"Web Scene"!==e.type)throw new l.A("webscene:invalid-portal-item","Invalid portal item type '${type}', expected 'Web Scene'",{type:e.type});const i=await e.fetchData();this.resourceInfo=i;const r={origin:"web-scene",url:(0,_.An)(e.itemUrl),portal:e.portal||O.A.getDefault(),portalItem:e,readResourcePaths:[]};await this._readAndLoadFromJSON(i,r),this._resourceReferences={portalItem:e,paths:null!==(t=r.readResourcePaths)&&void 0!==t?t:[]}}_validateSpatialReference(){const e=this.initialViewProperties,t=this._sceneSpatialReference;let i;if("local"!==e.viewingMode){if(!(0,B.M)(t,G.RT.Global))return Promise.reject(new l.A("webscene:unsupported-spatial-reference","Unsupported spatial reference (${spatialReference.wkid}) in global mode, only Web Mercator, WGS84 GCS or CGCS2000 are supported",{spatialReference:t,viewingMode:e.viewingMode}));i=e=>!e||(0,L.canProjectWithoutEngine)(e,t)}else{if(!(0,B.M)(t,G.RT.Local))return Promise.reject(new l.A("webscene:unsupported-spatial-reference","Unsupported spatial reference (${spatialReference.wkid}) in local mode, only projected coordinate systems are supported",{spatialReference:t,viewingMode:e.viewingMode}));i=e=>!e||e.equals(t)}const r=e=>{var t,i,r;return null!==(t=null===e||void 0===e||null===(i=e.camera)||void 0===i?void 0:i.position.spatialReference)&&void 0!==t?t:null===e||void 0===e||null===(r=e.targetGeometry)||void 0===r?void 0:r.spatialReference},s=e.viewpoint,n=r(s);if(n&&!i(n))return Promise.reject(new l.A("webscene:incompatible-camera-spatial-reference","Camera spatial reference (${cameraSpatialReference.wkid}) is incompatible with the scene spatial reference (${sceneSpatialReference.wkid})",{cameraSpatialReference:n,sceneSpatialReference:t,viewingMode:e.viewingMode}));const o=this.presentation.slides.find((e=>!i(r(e.viewpoint))));if(o){const i=r(o.viewpoint);return Promise.reject(new l.A("webscene:incompatible-slide-spatial-reference","Slide spatial reference (${slideSpatialReference.wkid}) is incompatible with the scene spatial reference (${sceneSpatialReference.wkid})",{slideSpatialReference:i,sceneSpatialReference:t,viewingMode:e.viewingMode}))}return Promise.resolve()}_validateHeightModelInfo(){const e=this._sceneSpatialReference,t=(0,M.TR)(this.heightModelInfo,e);return t?Promise.reject(t):Promise.resolve()}_validateJSON(e){const t=Ke.parse(e.version||"","webscene");return Xe.validate(t),e.version="".concat(t.major,".").concat(t.minor),1===t.major&&t.minor<=2&&(e.spatialReference=R.A.WebMercator.toJSON()),e}_updateTypeKeywords(e){(0,U.Sm)(e,U.mm.LOCAL_SCENE,"local"===this.initialViewProperties.viewingMode),(0,U.Sm)(e,U.mm.DEVELOPER_BASEMAP,(0,j.Rc)(this.basemap)||this.presentation.slides.some((e=>{let{basemap:t}=e;return!!t&&(0,j.Rc)(t)}))),e.typeKeywords&&(e.typeKeywords=e.typeKeywords.filter(((e,t,i)=>i.indexOf(e)===t)))}get _sceneSpatialReference(){return this.initialViewProperties.spatialReference||R.A.WebMercator}get _verifyItemRelativeRootPath(){var e;return null!==(e=this.portalItem)&&void 0!==e&&e.itemUrl?(0,_.An)(this.portalItem.itemUrl).path:null}_enableVerifyItemRelativeUrls(e){const t=this._verifyItemRelativeRootPath;return t&&(e.verifyItemRelativeUrls={rootPath:t,writtenUrls:[]}),e}_unscheduleLayersIdGC(){this._layersIdGCTimeoutId&&(clearTimeout(this._layersIdGCTimeoutId),this._layersIdGCTimeoutId=0)}_scheduleLayersIdGC(){this._unscheduleLayersIdGC(),this._layersIdGCTimeoutId=setTimeout((()=>{this._layersIdGCTimeoutId=0,this._runLayersIdGC()}),3e3)}_runLayersIdGC(){var e;this._unscheduleLayersIdGC();const t=null===(e=this.applicationProperties)||void 0===e||null===(e=e.viewing)||void 0===e?void 0:e.search,i=e=>this.allLayers.some((t=>t.id===e&&t.persistenceEnabled));t&&t.layers&&(t.layers=t.layers.filter((e=>i(e.id))));const r=this.presentation&&this.presentation.slides;r&&r.forEach((e=>{e.visibleLayers&&(e.visibleLayers=e.visibleLayers.filter((e=>i(e.id))))}))}static fromJSON(e){if(!e)throw new l.A("webscene:empty-resource","Expected a JSON resource but got nothing");return new this({resourceInfo:e})}};Je=Z.X,et.version="".concat(Xe.major,".").concat(Xe.minor),(0,r._)([(0,w.MZ)({type:X,json:{write:!0}})],et.prototype,"applicationProperties",void 0),(0,r._)([(0,w.MZ)({type:T.A,json:{read:{source:"clippingArea.geometry",reader:C.rS},write:{target:"clippingArea.geometry"}}})],et.prototype,"clippingArea",void 0),(0,r._)([(0,A.K)("clippingArea")],et.prototype,"writeClippingArea",null),(0,r._)([(0,w.MZ)({type:Boolean,json:{write:{target:"clippingArea.clip"}}})],et.prototype,"clippingEnabled",void 0),(0,r._)([(0,b.w)("clippingEnabled",["clippingArea"])],et.prototype,"readClippingEnabled",null),(0,r._)([(0,A.K)("clippingEnabled")],et.prototype,"writeClippingEnabled",null),(0,r._)([(0,w.MZ)({type:F.A,json:{read:{source:"mapFloorInfo"},write:{target:"mapFloorInfo"}}})],et.prototype,"floorInfo",void 0),(0,r._)([(0,w.MZ)({type:I.A,json:{write:!0}})],et.prototype,"heightModelInfo",void 0),(0,r._)([(0,w.MZ)({json:{write:{target:"operationalLayers",ignoreOrigin:!0}}})],et.prototype,"layers",void 0),(0,r._)([(0,A.K)("layers")],et.prototype,"writeLayers",null),(0,r._)([(0,w.MZ)({readOnly:!0,type:Ke,json:{type:(()=>{const e=[],t=Xe.major;for(let i=8;i<=Xe.minor;i++)e.push("".concat(t,".").concat(i));return e})(),write:{ignoreOrigin:!0,target:"version",isRequired:!0,overridePolicy:()=>({enabled:!0,allowNull:!0,ignoreOrigin:!0})}}})],et.prototype,"sourceVersion",void 0),(0,r._)([(0,b.w)("sourceVersion",["version"])],et.prototype,"readSourceVersion",null),(0,r._)([(0,A.K)("sourceVersion")],et.prototype,"writeSourceVersion",null),(0,r._)([(0,w.MZ)({json:{read:!1,write:{enabled:!0,ignoreOrigin:!0}}})],et.prototype,"tables",void 0),(0,r._)([(0,A.K)("tables")],et.prototype,"writeTables",null),(0,r._)([(0,w.MZ)()],et.prototype,"thumbnailUrl",null),(0,r._)([(0,w.MZ)({type:String,json:{write:{writerEnsuresNonNull:!0,ignoreOrigin:!0}}})],et.prototype,"authoringApp",null),(0,r._)([(0,A.K)("authoringApp")],et.prototype,"writeAuthoringApp",null),(0,r._)([(0,w.MZ)({type:String,json:{write:{writerEnsuresNonNull:!0,ignoreOrigin:!0}}})],et.prototype,"authoringAppVersion",null),(0,r._)([(0,A.K)("authoringAppVersion")],et.prototype,"writeAuthoringAppVersion",null),(0,r._)([(0,w.MZ)({json:{write:{isRequired:!0,allowNull:!0,ignoreOrigin:!0,enabled:!0}}})],et.prototype,"ground",void 0),(0,r._)([(0,A.K)("ground")],et.prototype,"writeGround",null),(0,r._)([(0,w.MZ)({type:a.A.ofType($e),json:{write:!0}})],et.prototype,"transportationNetworks",void 0),(0,r._)([(0,w.MZ)({type:Ye,nonNullable:!0,json:{write:{ignoreOrigin:!0,writer:(e,t,i,r)=>{if(e.slides&&e.slides.length>0){const i={...r,isPresentation:!0};t.presentation=e.write({},i)}}}}})],et.prototype,"presentation",void 0),(0,r._)([(0,w.MZ)({type:ie,nonNullable:!0,json:{write:{target:"initialState",isRequired:!0,ignoreOrigin:!0},default:()=>new ie({viewingMode:"global",spatialReference:R.A.WebMercator})}})],et.prototype,"initialViewProperties",void 0),(0,r._)([(0,b.w)("initialViewProperties",["initialState.environment","initialState.viewpoint","spatialReference","viewingMode"])],et.prototype,"readInitialViewProperties",null),(0,r._)([(0,w.MZ)({type:R.A,json:{read:!1,write:{isRequired:!0,ignoreOrigin:!0}}})],et.prototype,"spatialReference",null),(0,r._)([(0,w.MZ)({type:["local","global"],json:{read:!1,write:{isRequired:!0,ignoreOrigin:!0}}})],et.prototype,"viewingMode",null),(0,r._)([(0,w.MZ)({type:P.default})],et.prototype,"portalItem",void 0),(0,r._)([(0,w.MZ)()],et.prototype,"resourceInfo",void 0),et=(0,r._)([(0,f.$)("esri.WebScene")],et);const tt=et},37888:(e,t,i)=>{i.d(t,{v:()=>s});var r=i(24387);function s(e){(null===e||void 0===e?void 0:e.writtenProperties)&&e.writtenProperties.forEach((e=>{let{target:t,propName:i,newOrigin:s}=e;(0,r.H)(t)&&s&&t.originOf(i)!==s&&t.updateOrigin(i,s)}))}},24387:(e,t,i)=>{function r(e){return e&&"getAtOrigin"in e&&"originOf"in e}i.d(t,{H:()=>r})},84031:(e,t,i)=>{i.d(t,{T:()=>o});var r=i(50346),s=i(75540),n=i(22856);class o{constructor(){this._tasks=new Array,this._runningTasks=(0,s.v)(0)}get length(){return this._tasks.length}get running(){return this._runningTasks.value>0}destroy(){this.cancelAll()}runTask(e){if(0===this.length)return n.G;for(;!e.done&&this._process(e);)e.madeProgress()}push(e,t,i){return++this._runningTasks.value,new Promise(((r,s)=>this._tasks.push(new a(r,s,e,t,i)))).finally((()=>--this._runningTasks.value))}unshift(e,t,i){return++this._runningTasks.value,new Promise(((r,s)=>this._tasks.unshift(new a(r,s,e,t,i)))).finally((()=>--this._runningTasks.value))}_process(e){if(0===this._tasks.length)return!1;const t=this._tasks.shift();try{const s=(0,r.G4)(t.signal);if(s&&!t.abortCallback)t.reject((0,r.NK)());else{var i;const n=s?null===(i=t.abortCallback)||void 0===i?void 0:i.call(t,(0,r.NK)()):t.callback(e);(0,r.$X)(n)?n.then(t.resolve,t.reject):t.resolve(n)}}catch(o){t.reject(o)}return!0}cancelAll(){const e=(0,r.NK)();for(const t of this._tasks)if(t.abortCallback){const i=t.abortCallback(e);t.resolve(i)}else t.reject(e);this._tasks.length=0}}class a{constructor(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;this.resolve=e,this.reject=t,this.callback=i,this.signal=r,this.abortCallback=s}}},79942:(e,t,i)=>{i.d(t,{m:()=>o,v:()=>n});var r=i(90534),s=i(65308);function n(e,t){return{...a(e,t),readResourcePaths:[]}}function o(e,t,i){const s=(0,r.An)(e.itemUrl);return{...a(e,t),messages:[],writtenProperties:[],blockedRelativeUrls:[],verifyItemRelativeUrls:s?{rootPath:s.path,writtenUrls:[]}:null,resources:i?{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}:null}}function a(e,t){return{origin:t,url:(0,r.An)(e.itemUrl),portal:e.portal||s.A.getDefault(),portalItem:e}}},33106:(e,t,i)=>{i.d(t,{addOrUpdateResources:()=>a,bg:()=>h,cL:()=>c,fetchResources:()=>o,removeAllResources:()=>d,removeResource:()=>l});var r=i(3825),s=i(50076),n=i(90534);async function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;await e.load(i);const r=(0,n.fj)(e.itemUrl,"resources"),{start:s=1,num:o=10,sortOrder:a="asc",sortField:l="resource"}=t,d={query:{start:s,num:o,sortOrder:a,sortField:l,token:e.apiKey},signal:null===i||void 0===i?void 0:i.signal},p=await e.portal.request(r,d);return{total:p.total,nextStart:p.nextStart,resources:p.resources.map((t=>{let{created:i,size:r,resource:s}=t;return{created:new Date(i),size:r,resource:e.resourceFromPath(s)}}))}}async function a(e,t,i,r){const o=new Map;for(const{resource:n,content:l,compress:d,access:u}of t){if(!n.hasPath())throw new s.A("portal-item-resource-".concat(i,":invalid-path"),"Resource does not have a valid path");const[e,t]=p(n.path),r="".concat(e,"/").concat(null!==d&&void 0!==d?d:"","/").concat(null!==u&&void 0!==u?u:"");o.has(r)||o.set(r,{prefix:e,compress:d,access:u,files:[]}),o.get(r).files.push({fileName:t,content:l})}await e.load(r);const a=(0,n.fj)(e.userItemUrl,"add"===i?"addResources":"updateResources");for(const{prefix:s,compress:n,access:l,files:d}of o.values()){const t=25;for(let i=0;i<d.length;i+=t){const o=d.slice(i,i+t),p=new FormData;s&&"."!==s&&p.append("resourcesPrefix",s),n&&p.append("compress","true"),l&&p.append("access",l);let u=0;for(const{fileName:e,content:t}of o)p.append("file"+ ++u,t,e);p.append("f","json"),await e.portal.request(a,{method:"post",body:p,signal:null===r||void 0===r?void 0:r.signal})}}}async function l(e,t,i){if(!t.hasPath())throw new s.A("portal-item-resources-remove:invalid-path","Resource does not have a valid path");await e.load(i);const r=(0,n.fj)(e.userItemUrl,"removeResources");await e.portal.request(r,{method:"post",query:{resource:t.path},signal:null===i||void 0===i?void 0:i.signal}),t.portalItem=null}async function d(e,t){await e.load(t);const i=(0,n.fj)(e.userItemUrl,"removeResources");return e.portal.request(i,{method:"post",query:{deleteAll:!0},signal:null===t||void 0===t?void 0:t.signal})}function p(e){const t=e.lastIndexOf("/");return-1===t?[".",e]:[e.slice(0,t),e.slice(t+1)]}function u(e){const[t,i]=function(e){const t=(0,n.Zo)(e);return null==t?[e,""]:[e.slice(0,e.length-t.length-1),".".concat(t)]}(e),[r,s]=p(t);return[r,s,i]}async function c(e){return"blob"===e.type?e.blob:"json"===e.type?new Blob([e.jsonString],{type:"application/json"}):(await(0,r.A)(e.url,{responseType:"blob"})).data}function h(e,t){if(!e.hasPath())return null;const[i,,r]=u(e.path);return e.portalItem.resourceFromPath((0,n.fj)(i,t+r))}},61941:(e,t,i)=>{i.d(t,{A:()=>y});var r=i(35143),s=i(42553),n=i(46053),o=(i(81806),i(76460),i(47249),i(85842));let a=class extends s.oY{constructor(e){super(e),this.facilityIdField=null,this.layerId=null,this.nameField=null,this.siteIdField=null,this.sublayerId=null}};(0,r._)([(0,n.MZ)({type:String,json:{write:!0}})],a.prototype,"facilityIdField",void 0),(0,r._)([(0,n.MZ)({type:String,json:{write:!0}})],a.prototype,"layerId",void 0),(0,r._)([(0,n.MZ)({type:String,json:{write:!0}})],a.prototype,"nameField",void 0),(0,r._)([(0,n.MZ)({type:String,json:{write:!0}})],a.prototype,"siteIdField",void 0),(0,r._)([(0,n.MZ)({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],a.prototype,"sublayerId",void 0),a=(0,r._)([(0,o.$)("esri.layers.support.FacilityLayerInfo")],a);const l=a;let d=class extends s.oY{constructor(e){super(e),this.facilityIdField=null,this.layerId=null,this.levelIdField=null,this.levelNumberField=null,this.longNameField=null,this.shortNameField=null,this.sublayerId=null,this.verticalOrderField=null}};(0,r._)([(0,n.MZ)({type:String,json:{write:!0}})],d.prototype,"facilityIdField",void 0),(0,r._)([(0,n.MZ)({type:String,json:{write:!0}})],d.prototype,"layerId",void 0),(0,r._)([(0,n.MZ)({type:String,json:{write:!0}})],d.prototype,"levelIdField",void 0),(0,r._)([(0,n.MZ)({type:String,json:{write:!0}})],d.prototype,"levelNumberField",void 0),(0,r._)([(0,n.MZ)({type:String,json:{write:!0}})],d.prototype,"longNameField",void 0),(0,r._)([(0,n.MZ)({type:String,json:{write:!0}})],d.prototype,"shortNameField",void 0),(0,r._)([(0,n.MZ)({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],d.prototype,"sublayerId",void 0),(0,r._)([(0,n.MZ)({type:String,json:{write:!0}})],d.prototype,"verticalOrderField",void 0),d=(0,r._)([(0,o.$)("esri.layers.support.LevelLayerInfo")],d);const p=d;let u=class extends s.oY{constructor(e){super(e),this.layerId=null,this.nameField=null,this.siteIdField=null,this.sublayerId=null}};(0,r._)([(0,n.MZ)({type:String,json:{write:!0}})],u.prototype,"layerId",void 0),(0,r._)([(0,n.MZ)({type:String,json:{write:!0}})],u.prototype,"nameField",void 0),(0,r._)([(0,n.MZ)({type:String,json:{write:!0}})],u.prototype,"siteIdField",void 0),(0,r._)([(0,n.MZ)({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],u.prototype,"sublayerId",void 0),u=(0,r._)([(0,o.$)("esri.layers.support.SiteLayerInfo")],u);const c=u;let h=class extends s.oY{constructor(e){super(e),this.levelLayer=null,this.facilityLayer=null,this.siteLayer=null}};(0,r._)([(0,n.MZ)({type:p,json:{write:!0}})],h.prototype,"levelLayer",void 0),(0,r._)([(0,n.MZ)({type:l,json:{write:!0}})],h.prototype,"facilityLayer",void 0),(0,r._)([(0,n.MZ)({type:c,json:{write:!0}})],h.prototype,"siteLayer",void 0),h=(0,r._)([(0,o.$)("esri.support.MapFloorInfo")],h);const y=h},72027:(e,t,i)=>{i.d(t,{X:()=>r});const r=Symbol("WebScene")},4216:(e,t,i)=>{i.d(t,{A:()=>p});var r,s=i(35143),n=i(42553),o=i(46053),a=(i(81806),i(76460),i(47249),i(6409)),l=i(85842);let d=r=class extends n.oY{constructor(e){super(e),this.type="cloudy",this.cloudCover=.5}clone(){return new r({cloudCover:this.cloudCover})}};(0,s._)([(0,a.e)({cloudy:"cloudy"})],d.prototype,"type",void 0),(0,s._)([(0,o.MZ)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],d.prototype,"cloudCover",void 0),d=r=(0,s._)([(0,l.$)("esri.views.3d.environment.CloudyWeather")],d);const p=d},23695:(e,t,i)=>{i.d(t,{A:()=>p});var r,s=i(35143),n=i(42553),o=i(46053),a=(i(81806),i(76460),i(47249),i(6409)),l=i(85842);let d=r=class extends n.oY{constructor(e){super(e),this.type="foggy",this.fogStrength=.5}clone(){return new r({fogStrength:this.fogStrength})}};(0,s._)([(0,a.e)({foggy:"foggy"})],d.prototype,"type",void 0),(0,s._)([(0,o.MZ)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],d.prototype,"fogStrength",void 0),d=r=(0,s._)([(0,l.$)("esri.views.3d.environment.FoggyWeather")],d);const p=d},20728:(e,t,i)=>{i.d(t,{A:()=>p});var r,s=i(35143),n=i(42553),o=i(46053),a=(i(81806),i(76460),i(47249),i(6409)),l=i(85842);let d=r=class extends n.oY{constructor(e){super(e),this.type="rainy",this.cloudCover=.5,this.precipitation=.5}clone(){return new r({cloudCover:this.cloudCover,precipitation:this.precipitation})}};(0,s._)([(0,a.e)({rainy:"rainy"})],d.prototype,"type",void 0),(0,s._)([(0,o.MZ)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],d.prototype,"cloudCover",void 0),(0,s._)([(0,o.MZ)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],d.prototype,"precipitation",void 0),d=r=(0,s._)([(0,l.$)("esri.views.3d.environment.RainyWeather")],d);const p=d},92521:(e,t,i)=>{i.d(t,{A:()=>p});var r,s=i(35143),n=i(42553),o=i(46053),a=(i(81806),i(76460),i(47249),i(6409)),l=i(85842);let d=r=class extends n.oY{constructor(e){super(e),this.type="snowy",this.cloudCover=.5,this.precipitation=.5,this.snowCover="disabled"}clone(){return new r({cloudCover:this.cloudCover,precipitation:this.precipitation,snowCover:this.snowCover})}};(0,s._)([(0,a.e)({snowy:"snowy"})],d.prototype,"type",void 0),(0,s._)([(0,o.MZ)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],d.prototype,"cloudCover",void 0),(0,s._)([(0,o.MZ)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],d.prototype,"precipitation",void 0),(0,s._)([(0,o.MZ)({type:["enabled","disabled"],nonNullable:!0,json:{write:!0}})],d.prototype,"snowCover",void 0),d=r=(0,s._)([(0,l.$)("esri.views.3d.environment.SnowyWeather")],d);const p=d},68814:(e,t,i)=>{i.d(t,{A:()=>p});var r,s=i(35143),n=i(42553),o=i(46053),a=(i(81806),i(76460),i(47249),i(6409)),l=i(85842);let d=r=class extends n.oY{constructor(e){super(e),this.type="sunny",this.cloudCover=.5}clone(){return new r({cloudCover:this.cloudCover})}};(0,s._)([(0,a.e)({sunny:"sunny"})],d.prototype,"type",void 0),(0,s._)([(0,o.MZ)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],d.prototype,"cloudCover",void 0),d=r=(0,s._)([(0,l.$)("esri.views.3d.environment.SunnyWeather")],d);const p=d},53203:(e,t,i)=>{i.d(t,{TJ:()=>p,eM:()=>l,k9:()=>c,l2:()=>d,ni:()=>u});var r=i(4216),s=i(23695),n=i(20728),o=i(92521),a=i(68814);const l={key:"type",base:a.A,typeMap:{sunny:a.A,cloudy:r.A,rainy:n.A,snowy:o.A,foggy:s.A}},d=Object.keys(l.typeMap);function p(e,t){return!!d.includes(e)||(t.error('"'.concat(e,'" is not a valid weather type')),!1)}const u=1e4,c=1e5},98476:(e,t,i)=>{var r;i.d(t,{M:()=>r}),function(e){e[e.ANIMATING=0]="ANIMATING",e[e.INTERACTING=1]="INTERACTING",e[e.IDLE=2]="IDLE"}(r||(r={}))},59752:(e,t,i)=>{i.d(t,{Bb:()=>R,W6:()=>r,mj:()=>_,nu:()=>M});var r,s,n=i(88321),o=(i(81806),i(76460)),a=i(30726),l=i(32634),d=i(30015),p=i(50346),u=i(68134),c=i(75540),h=i(91417),y=i(84031),g=i(5551),v=i(98476),m=i(22856);function _(){return new I.Scheduler}(s=r||(r={})).RESOURCE_CONTROLLER_IMMEDIATE="immediate",s.RESOURCE_CONTROLLER="schedule",s.SLIDE="slide",s.STREAM_DATA_LOADER="stream loader",s.ELEVATION_QUERY="elevation query",s.TERRAIN_SURFACE="terrain",s.SURFACE_GEOMETRY_UPDATES="surface geometry updates",s.LOD_RENDERER="LoD renderer",s.GRAPHICS_CORE="Graphics3D",s.I3S_CONTROLLER="I3S",s.POINT_CLOUD_LAYER="point cloud",s.FEATURE_TILE_FETCHER="feature fetcher",s.OVERLAY="overlay",s.STAGE="stage",s.GRAPHICS_DECONFLICTOR="graphics deconflictor",s.FILTER_VISIBILITY="Graphics3D filter visibility",s.SCALE_VISIBILITY="Graphics3D scale visibility",s.FRUSTUM_VISIBILITY="Graphics3D frustum visibility",s.POINT_OF_INTEREST_FREQUENT="POI frequent",s.POINT_OF_INTEREST_INFREQUENT="POI infrequent",s.LABELER="labeler",s.FEATURE_QUERY_ENGINE="feature query",s.FEATURE_TILE_TREE="feature tile tree",s.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree",s.ELEVATION_ALIGNMENT="elevation alignment",s.ELEVATION_ALIGNMENT_SCENE="elevation alignment scene",s.TEXT_TEXTURE_ATLAS="text texture atlas",s.TEXTURE_UNLOAD="texture unload",s.LINE_OF_SIGHT_TOOL="line of sight tool",s.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool",s.ELEVATION_PROFILE="elevation profile",s.SNAPPING="snapping",s.SHADOW_ACCUMULATOR="shadow accumulator",s.CLOUDS_GENERATOR="clouds generator",s[s.NONE=0]="NONE",s[s.TEST_PRIO=1]="TEST_PRIO";const w=new Map([[r.RESOURCE_CONTROLLER_IMMEDIATE,0],[r.RESOURCE_CONTROLLER,4],[r.SLIDE,0],[r.STREAM_DATA_LOADER,0],[r.ELEVATION_QUERY,0],[r.TERRAIN_SURFACE,1],[r.SURFACE_GEOMETRY_UPDATES,1],[r.LOD_RENDERER,2],[r.GRAPHICS_CORE,2],[r.I3S_CONTROLLER,2],[r.POINT_CLOUD_LAYER,2],[r.FEATURE_TILE_FETCHER,2],[r.OVERLAY,4],[r.STAGE,4],[r.GRAPHICS_DECONFLICTOR,4],[r.FILTER_VISIBILITY,4],[r.SCALE_VISIBILITY,4],[r.FRUSTUM_VISIBILITY,4],[r.CLOUDS_GENERATOR,4],[r.POINT_OF_INTEREST_FREQUENT,6],[r.POINT_OF_INTEREST_INFREQUENT,30],[r.LABELER,8],[r.FEATURE_QUERY_ENGINE,8],[r.FEATURE_TILE_TREE,16],[r.FEATURE_TILE_TREE_ACTIVE,0],[r.ELEVATION_ALIGNMENT,12],[r.ELEVATION_ALIGNMENT_SCENE,14],[r.TEXT_TEXTURE_ATLAS,12],[r.TEXTURE_UNLOAD,12],[r.LINE_OF_SIGHT_TOOL,16],[r.LINE_OF_SIGHT_TOOL_INTERACTIVE,0],[r.SNAPPING,0],[r.SHADOW_ACCUMULATOR,30]]);function b(e){return w.has(e)?w.get(e):"number"==typeof e?e:1}const f=(0,h.l5)(6.5),A=(0,h.l5)(1),E=(0,h.l5)(30),S=(0,h.l5)(1e3/30),T=(0,h.l5)(100);var I,L;!function(e){e.Scheduler=class{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some((e=>e.needsUpdate))}constructor(){this._updating=(0,c.v)(!0),this._microTaskQueued=!1,this._frameNumber=0,this.performanceInfo={total:new l.A("total"),tasks:new Map},this._frameTaskTimes=new Map,this._budget=new i,this._state=v.M.INTERACTING,this._tasks=new d.A,this._runQueue=new d.A,this._load=0,this._idleStateCallbacks=new d.A,this._idleUpdatesStartFired=!1,this._forceTask=!1,this._debug=!1,this._debugHandle=(0,u.watch)((()=>g.A.SCHEDULER_LOG_SLOW_TASKS),(e=>this._debug=e),u.initial);for(const t of Object.keys(r))this.performanceInfo.tasks.set(r[t],new l.A(r[t]));const e=this;this._test={FRAME_SAFETY_BUDGET:f,INTERACTING_BUDGET:S,IDLE_BUDGET:T,get availableBudget(){return e._budget.budget},usedBudget:0,getBudget:()=>e._budget,setBudget:t=>e._budget=t,updateTask:e=>this._updateTask(e),getState:e=>this._getState(e),getRuntime:e=>this._getRuntime(e),frameTaskTimes:this._frameTaskTimes,resetRuntimes:()=>this._resetRuntimes(),getRunning:()=>this._getRunning()}}destroy(){this._tasks.toArray().forEach((e=>e.remove())),this._tasks.clear(),(0,a.xt)(this._debugHandle),this._microTaskQueued=!1,this._updatingChanged()}taskRunningChanged(e){this._updatingChanged(),e&&this._budget.remaining>0&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask((()=>{this._microTaskQueued&&(this._microTaskQueued=!1,this._budget.remaining>0&&this._schedule()&&this.frame())})))}registerTask(e,i){const r=new t(this,e,i);return this._tasks.push(r),this._updatingChanged(),this.performanceInfo.tasks.has(e)||this.performanceInfo.tasks.set(e,new l.A(e)),r}registerIdleStateCallbacks(e,t){const i={idleBegin:e,idleEnd:t};this._idleStateCallbacks.push(i),this.state===v.M.IDLE&&this._idleUpdatesStartFired&&i.idleBegin();const r=this;return{remove:()=>this._removeIdleStateCallbacks(i),set idleBegin(e){r._idleUpdatesStartFired&&(i.idleEnd(),r._state===v.M.IDLE&&e()),i.idleBegin=e},set idleEnd(e){i.idleEnd=e}}}get load(){return this._load}set state(e){this._state!==e&&(this._state=e,this.state!==v.M.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll((e=>e.idleEnd()))))}get state(){return this._state}updateBudget(e){this._test.usedBudget=0,++this._frameNumber;let t=f,i=e.frameDuration,r=A;switch(this.state){case v.M.IDLE:t=(0,h.l5)(0),i=(0,h.l5)(Math.max(T,e.frameDuration)),r=E;break;case v.M.INTERACTING:i=(0,h.l5)(Math.max(S,e.frameDuration));case v.M.ANIMATING:}return i=(0,h.l5)(i-e.elapsedFrameTime-t),this.state!==v.M.IDLE&&i<A&&!this._forceTask?(this._forceTask=!0,!1):(i=(0,h.l5)(Math.max(i,r)),this._budget.reset(i,this.state),this._updateLoad(),this._schedule())}frame(){switch(this._forceTask=!1,this._microTaskQueued=!1,this.state){case v.M.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll((e=>e.idleBegin()))),this._runIdle();break;case v.M.INTERACTING:this._runInteracting();break;default:this._runAnimating()}this._test.usedBudget=this._budget.elapsed}stopFrame(){this._budget.reset((0,h.l5)(0),this._state),this._budget.madeProgress()}_removeIdleStateCallbacks(e){this._idleUpdatesStartFired&&e.idleEnd(),this._idleStateCallbacks.removeUnordered(e)}removeTask(e){this._tasks.removeUnordered(e),this._runQueue.removeUnordered(e),this._updatingChanged()}_updateTask(e){this._tasks.forAll((t=>{t.name===e&&t.setPriority(e)}))}_getState(e){if(this._runQueue.some((t=>t.name===e)))return L.SCHEDULED;let t=L.IDLE;return this._tasks.forAll((i=>{i.name===e&&i.needsUpdate&&(i.schedulePriority<=1?t=L.READY:t!==L.READY&&(t=L.WAITING))})),t}_getRuntime(e){let t=0;return this._tasks.forAll((i=>{i.name===e&&(t+=i.runtime)})),t}_resetRuntimes(){this._tasks.forAll((e=>e.runtime=0))}_getRunning(){const e=new Map;if(this._tasks.forAll((t=>{t.needsUpdate&&e.set(t.name,(e.get(t.name)||0)+1)})),0===e.size)return null;let t="";return e.forEach(((e,i)=>{t+=e>1?" ".concat(e,"x ").concat(i):" ".concat(i)})),t}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const e=this._tasks.reduce(((e,t)=>t.needsUpdate?++e:e),0);this._load=.9*this._load+e*(1-.9)}_schedule(){for(this._runQueue.filterInPlace((e=>!!e.needsUpdate||(e.schedulePriority=e.basePriority,!1))),this._tasks.forAll((e=>{0===e.basePriority&&e.needsUpdate&&!this._runQueue.includes(e)&&e.blockFrame!==this._frameNumber&&this._runQueue.unshift(e)}));0===this._runQueue.length;){let e=!1,t=0;if(this._tasks.forAll((i=>{i.needsUpdate&&0!==i.schedulePriority&&0!==i.basePriority&&i.blockFrame!==this._frameNumber&&(e=!0,t=Math.max(t,i.basePriority),1===i.schedulePriority?(i.schedulePriority=0,this._runQueue.push(i)):--i.schedulePriority)})),!e)return this._updatingChanged(),!1}return this._updatingChanged(),!0}_run(){const e=this._budget.now();this._startFrameTaskTimes();do{for(;this._runQueue.length>0;){const i=this._budget.now(),s=this._runQueue.pop();this._budget.resetProgress();try{s.task.runTask(this._budget)===m.G&&(s.blockFrame=this._frameNumber)}catch(t){o.A.getLogger("esri.views.support.Scheduler").error('Exception in task "'.concat(s.name,'"'),t),s.blockFrame=this._frameNumber}!this._budget.hasProgressed&&s.blockFrame!==this._frameNumber&&s.needsUpdate&&(s.name,r.I3S_CONTROLLER,s.blockFrame=this._frameNumber),s.schedulePriority=s.basePriority;const n=this._budget.now()-i;if(s.runtime+=n,this._frameTaskTimes.set(s.priority,this._frameTaskTimes.get(s.priority)+n),this._debug&&n>2*this._budget.budget&&console.log("Task",s.name,"used",n,"of max",this._budget.budget,"ms"),this._budget.remaining<=0)return this._updatingChanged(),void this._recordFrameTaskTimes(this._budget.now()-e)}}while(this._schedule());this._updatingChanged(),this._recordFrameTaskTimes(this._budget.now()-e)}_startFrameTaskTimes(){for(const e of Object.keys(r))this._frameTaskTimes.set(r[e],0)}_recordFrameTaskTimes(e){this._frameTaskTimes.forEach(((e,t)=>this.performanceInfo.tasks.get(t).record(e))),this.performanceInfo.total.record(e)}get test(){return this._test}};class t{get task(){return this._task.value}get updating(){return this._queue.running}constructor(e,t,i){this._scheduler=e,this.name=t,this.blockFrame=0,this.runtime=0,this._queue=new y.T,this._handles=new n.A,this._basePriority=b(t),this.schedulePriority=this._basePriority,this._task=(0,c.v)(null!=i?i:this._queue),this._handles.add((0,u.when)((()=>this.task.running),(t=>e.taskRunningChanged(t))))}remove(){this.processQueue(R),this._scheduler.removeTask(this),this.schedule=M.schedule,this.reschedule=M.reschedule,this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(e){if(this.name===e)return;this.name=e;const t=b(e);0!==this._basePriority&&0===this.schedulePriority||(this.schedulePriority=t),this._basePriority=t}get priority(){return this.name}set priority(e){this.setPriority(e)}get needsUpdate(){return this.updating||this.task.running}schedule(e,t,i){return this._queue.push(e,t,i)}reschedule(e,t,i){return this._queue.unshift(e,t,i)}processQueue(e){return this._queue.runTask(e)}}class i{constructor(){this._begin="undefined"!=typeof performance?performance.now():0,this._budget=0,this._state=v.M.IDLE,this._done=!1,this._progressed=!1,this._enabled=!0}run(e){return!this.done&&(!0===e()&&this.madeProgress(),!0)}get done(){return this._done}get budget(){return this._budget}madeProgress(){return this._progressed=!0,this._done=this.elapsed>=this._budget&&this._enabled,this._done}get state(){return this._state}get enabled(){return this._enabled}set enabled(e){this._enabled=e}reset(e,t){this._begin=this.now(),this._budget=e,this._state=t,this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return performance.now()-this._begin}resetProgress(){this._progressed=!1,this._done=!1}get hasProgressed(){return this._progressed}}e.Budget=i}(I||(I={})),function(e){e.SCHEDULED="s",e.READY="r",e.WAITING="w",e.IDLE="i"}(L||(L={}));const R=(()=>{const e=new I.Budget;return e.enabled=!1,e})();const M=new class{remove(){}processQueue(){}schedule(e,t,i){try{if((0,p.G4)(t)){const e=(0,p.NK)();return i?Promise.resolve(i(e)):Promise.reject(e)}return(0,p.z7)(e(R))}catch(r){return Promise.reject(r)}}reschedule(e,t,i){return this.schedule(e,t,i)}}},22856:(e,t,i)=>{i.d(t,{G:()=>r});const r=Symbol("Yield")},5551:(e,t,i)=>{i.d(t,{A:()=>l});var r=i(35143),s=i(91967),n=i(46053),o=(i(81806),i(76460),i(47249),i(85842));let a=class extends s.A{constructor(){super(...arguments),this.SCHEDULER_LOG_SLOW_TASKS=!1,this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1}};(0,r._)([(0,n.MZ)()],a.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),(0,r._)([(0,n.MZ)()],a.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0),a=(0,r._)([(0,o.$)("esri.views.support.DebugFlags")],a);const l=new a},59801:(e,t,i)=>{i.d(t,{M:()=>n});var r=i(34038),s=i(64465);function n(e,t){return null!=e&&(null==t||(t===s.RT.Local?!e.isGeographic||e.isWGS84||e.wkid===r.Y.CGCS2000:e.isWebMercator||e.isWGS84||e.wkid===r.Y.CGCS2000||e.wkid===r.Y.GCSMARS2000||e.wkid===r.Y.GCSMARS2000_SPHERE||e.wkid===r.Y.GCSMOON2000))}},3232:(e,t,i)=>{i.d(t,{A:()=>k});var r=i(35143),s=i(42553),n=i(53084),o=i(46053),a=(i(81806),i(76460),i(85842)),l=i(19276),d=i(28379),p=i(17707);function u(e){return{enabled:!(null===e||void 0===e||!e.length)}}var c,h=i(40565),y=(i(47249),i(6409)),g=i(6127);let v=c=class extends s.oY{constructor(e){super(e),this.exactMatch=!1,this.name=null,this.type=null}clone(){return new c({exactMatch:this.exactMatch,type:this.type,name:this.name})}};(0,r._)([(0,o.MZ)({type:Boolean,json:{write:!0}})],v.prototype,"exactMatch",void 0),(0,r._)([(0,o.MZ)({type:String,json:{write:!0}})],v.prototype,"name",void 0),(0,r._)([(0,y.e)(g.m)],v.prototype,"type",void 0),v=c=(0,r._)([(0,a.$)("esri.webdoc.applicationProperties.SearchLayerField")],v);const m=v;var _;let w=_=class extends s.oY{constructor(e){super(e),this.field=null,this.id=null,this.subLayer=null}clone(){return new _((0,n.o8)({field:this.field,id:this.id,subLayer:this.subLayer}))}};(0,r._)([(0,o.MZ)({type:m,json:{write:{isRequired:!0}}})],w.prototype,"field",void 0),(0,r._)([(0,o.MZ)({type:String,json:{write:{isRequired:!0}}})],w.prototype,"id",void 0),(0,r._)([(0,o.MZ)({type:h.jz,json:{write:!0}})],w.prototype,"subLayer",void 0),w=_=(0,r._)([(0,a.$)("esri.webdoc.applicationProperties.SearchLayer")],w);const b=w;var f;let A=f=class extends s.oY{constructor(e){super(e),this.exactMatch=!1,this.name=null,this.type=null}clone(){return new f({exactMatch:this.exactMatch,type:this.type,name:this.name})}};(0,r._)([(0,o.MZ)({type:Boolean,json:{write:!0}})],A.prototype,"exactMatch",void 0),(0,r._)([(0,o.MZ)({type:String,json:{write:!0}})],A.prototype,"name",void 0),(0,r._)([(0,y.e)(g.m)],A.prototype,"type",void 0),A=f=(0,r._)([(0,a.$)("esri.webdoc.applicationProperties.SearchTableField")],A);const E=A;var S;let T=S=class extends s.oY{constructor(e){super(e),this.field=null,this.id=null}clone(){return new S((0,n.o8)({field:this.field,id:this.id}))}};(0,r._)([(0,o.MZ)({type:E,json:{write:{isRequired:!0}}})],T.prototype,"field",void 0),(0,r._)([(0,o.MZ)({type:String,json:{write:{isRequired:!0}}})],T.prototype,"id",void 0),T=S=(0,r._)([(0,a.$)("esri.webdoc.applicationProperties.SearchTable")],T);const I=T;var L;const R=l.A.ofType(b),M=l.A.ofType(I);let C=L=class extends s.oY{constructor(e){super(e),this.addressSearchEnabled=!0,this.enabled=!0,this.hintText=null,this.layers=new R,this.tables=new M}readAddressSearchEnabled(e){return!e}writeAddressSearchEnabled(e,t,i){t[i]=!e}clone(){return new L((0,n.o8)({addressSearchEnabled:this.addressSearchEnabled,enabled:this.enabled,hintText:this.hintText,layers:this.layers,tables:this.tables}))}};(0,r._)([(0,o.MZ)({type:Boolean,nonNullable:!0,json:{read:{source:"disablePlaceFinder"},write:{target:"disablePlaceFinder",isRequired:!0},origins:{"web-scene":{read:!1,write:!1}}}})],C.prototype,"addressSearchEnabled",void 0),(0,r._)([(0,d.w)("addressSearchEnabled")],C.prototype,"readAddressSearchEnabled",null),(0,r._)([(0,p.K)("addressSearchEnabled")],C.prototype,"writeAddressSearchEnabled",null),(0,r._)([(0,o.MZ)({type:Boolean,nonNullable:!0,json:{write:!0,origins:{"web-map":{write:{isRequired:!0}},"web-scene":{default:!0,write:!0}}}})],C.prototype,"enabled",void 0),(0,r._)([(0,o.MZ)({type:String,json:{write:!0}})],C.prototype,"hintText",void 0),(0,r._)([(0,o.MZ)({type:R,json:{write:{overridePolicy:u},origins:{"web-scene":{write:{isRequired:!0}}}}})],C.prototype,"layers",void 0),(0,r._)([(0,o.MZ)({type:M,json:{read:!0,write:{overridePolicy:u}}})],C.prototype,"tables",void 0),C=L=(0,r._)([(0,a.$)("esri.webdoc.applicationProperties.Search")],C);const N=C;var O;let P=O=class extends s.oY{constructor(e){super(e),this.search=null}clone(){return new O((0,n.o8)({search:this.search}))}};(0,r._)([(0,o.MZ)({type:N,json:{write:!0}})],P.prototype,"search",void 0),P=O=(0,r._)([(0,a.$)("esri.webdoc.applicationProperties.Viewing")],P);const k=P},61701:(e,t,i)=>{var r;i.d(t,{X:()=>r}),function(e){e[e.SAVE=0]="SAVE",e[e.SAVE_AS=1]="SAVE_AS"}(r||(r={}))},994:(e,t,i)=>{i.d(t,{o:()=>d});var r,s=i(35143),n=i(42553),o=i(46053),a=(i(81806),i(76460),i(47249),i(85842)),l=i(68897);let d=r=class extends n.oY{constructor(){super(...arguments),this.url=""}destroy(){this.url=""}get isSecureUrl(){return(0,l.z3)(this.url)}get isDataURI(){return(0,l.zL)(this.url)}clone(){return new r({url:this.url})}};(0,s._)([(0,o.MZ)({type:String,json:{write:{isRequired:!0}}})],d.prototype,"url",void 0),(0,s._)([(0,o.MZ)()],d.prototype,"isSecureUrl",null),(0,s._)([(0,o.MZ)()],d.prototype,"isDataURI",null),d=r=(0,s._)([(0,a.$)("esri.webdoc.support.SlideThumbnail")],d)},79880:(e,t,i)=>{i.d(t,{S:()=>l,r:()=>a});var r=i(50076),s=i(50346),n=i(49723),o=i(33106);async function a(e,t,i){const r=await d(e,t,i);await p(r,t,i)}async function l(e,t,i,r,s){const n=await d(i,r,s);await e.update({data:t}),await p(n,r,s)}async function d(e,t,a){if(null===t||void 0===t||!t.resources)return;const l=t.portalItem===e.portalItem?new Set(e.paths):new Set;e.paths.length=0,e.portalItem=t.portalItem;const d=new Set(t.resources.toKeep.map((e=>e.resource.path))),p=new Set,u=[];d.forEach((t=>{l.delete(t),e.paths.push(t)}));const c=[],h=[],y=[];for(const i of t.resources.toUpdate)if(l.delete(i.resource.path),d.has(i.resource.path)||p.has(i.resource.path)){const{resource:t,content:r,finish:s}=i,a=(0,o.bg)(t,(0,n.lk)());e.paths.push(a.path),c.push({resource:a,content:await(0,o.cL)(r),compress:i.compress}),s&&y.push((()=>s(a)))}else{e.paths.push(i.resource.path),h.push({resource:i.resource,content:await(0,o.cL)(i.content),compress:i.compress});const t=i.finish;t&&y.push((()=>t(i.resource))),p.add(i.resource.path)}for(const i of t.resources.toAdd)if(e.paths.push(i.resource.path),l.has(i.resource.path))l.delete(i.resource.path);else{c.push({resource:i.resource,content:await(0,o.cL)(i.content),compress:i.compress});const e=i.finish;e&&y.push((()=>e(i.resource)))}if(c.length||h.length){const{addOrUpdateResources:e}=await Promise.resolve().then(i.bind(i,33106));await e(t.portalItem,c,"add",a),await e(t.portalItem,h,"update",a)}if(y.forEach((e=>e())),0===u.length)return l;const g=await(0,s.Ol)(u);if((0,s.Te)(a),g.length>0)throw new r.A("save:resources","Failed to save one or more resources",{errors:g});return l}async function p(e,t,i){if(!e||!t.portalItem)return;const r=[];for(const s of e){const e=t.portalItem.resourceFromPath(s);r.push(e.portalItem.removeResource(e,i))}await(0,s.Lx)(r)}},65526:(e,t,i)=>{i.d(t,{X:()=>o});var r=i(86560),s=i(50076),n=i(90924);function o(e){if(r.A.apiKey&&(0,n.Q)(e.portal.url))throw new s.A("save-api-key-utils:api-key-not-supported","Saving is not supported on ".concat(e.portal.url," when using an api key"))}},24907:(e,t,i)=>{i.d(t,{c:()=>o,d:()=>s});var r=i(50076);async function s(e){const t=[];for(const i of e.allLayers)if("beforeSave"in i&&"function"==typeof i.beforeSave){const e=i.beforeSave();e&&t.push(e)}await Promise.allSettled(t)}const n=new Set(["layer:unsupported","property:unsupported","symbol:unsupported","symbol-layer:unsupported","url:unsupported"]);function o(e,t,i){var s;let o=(null!==(s=e.messages)&&void 0!==s?s:[]).filter((e=>{let{type:t}=e;return"error"===t})).map((e=>{let{name:t,message:i,details:s}=e;return new r.A(t,i,s)}));if(e.blockedRelativeUrls&&(o=o.concat(e.blockedRelativeUrls.map((e=>new r.A("url:unsupported","Relative url '".concat(e,"' is not supported")))))),i){const{ignoreUnsupported:e,supplementalUnsupportedErrors:t=[],requiredPropertyChecksDisabled:r}=i;e&&(o=o.filter((e=>{let{name:i}=e;return!(n.has(i)||t.includes(i))}))),r&&(o=o.filter((e=>"web-document-write:property-required"!==e.name)))}if(o.length>0)throw new r.A(t.errorName,"Failed to save due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:o})}},94200:(e,t,i)=>{i.d(t,{S:()=>n});const r={width:600,height:400},s=1.5;function n(e,t){t=t||r;let{width:i,height:n}=t;const o=i/n;return o<s?n=i/s:o>s&&(i=n*s),i>e.width&&(n*=e.width/i,i=e.width),n>e.height&&(i*=e.height/n,n=e.height),{width:Math.round(i),height:Math.round(n)}}},41653:(e,t,i)=>{i.d(t,{A:()=>A});var r=i(35143),s=i(42553),n=i(53084),o=i(76460),a=i(46053),l=(i(81806),i(85842)),d=i(68814),p=i(53203),u=i(30650),c=i(98277),h=i(99372),y=i(13206),g=i(45355);const v={base:y.A,key:"type",typeMap:{color:g.A}};const m={types:v,json:{read:(_=v,(e,t,i)=>{if(!e)return e;for(const r in _.typeMap)if(e.type===r){const t=new _.typeMap[r];return t.read(e,i),t}}),write:{overridePolicy:(e,t,i)=>({enabled:!i||!i.isPresentation})}}};var _,w;const b=(e,t,i)=>({enabled:!i||!i.isPresentation});let f=w=class extends s.oY{constructor(e){super(e),this.lighting=new c.A,this.background=null,this.atmosphereEnabled=!0,this.starsEnabled=!0}set weather(e){(0,p.TJ)(null===e||void 0===e?void 0:e.type,o.A.getLogger(this))&&this._set("weather",e)}clone(){return new w(this.cloneConstructProperties())}cloneConstructProperties(){return{lighting:this.lighting&&"virtual"===this.lighting.type?h.A.prototype.clone.call(this.lighting):c.A.prototype.clone.call(this.lighting),background:(0,n.o8)(this.background),atmosphereEnabled:this.atmosphereEnabled,starsEnabled:this.starsEnabled,weather:this.weather.clone()}}};(0,r._)([(0,a.MZ)({types:u.S,nonNullable:!0,json:{write:!0}})],f.prototype,"lighting",void 0),(0,r._)([(0,a.MZ)(m)],f.prototype,"background",void 0),(0,r._)([(0,a.MZ)({type:Boolean,nonNullable:!0,json:{write:{overridePolicy:b}}})],f.prototype,"atmosphereEnabled",void 0),(0,r._)([(0,a.MZ)({type:Boolean,nonNullable:!0,json:{write:{overridePolicy:b}}})],f.prototype,"starsEnabled",void 0),(0,r._)([(0,a.MZ)({types:p.eM,nonNullable:!0,json:{write:!0},value:new d.A})],f.prototype,"weather",null),f=w=(0,r._)([(0,l.$)("esri.webscene.Environment")],f);const A=f},98277:(e,t,i)=>{i.d(t,{A:()=>u});var r,s=i(35143),n=i(42553),o=i(46053),a=(i(81806),i(76460),i(47249),i(28379)),l=i(85842),d=i(17707);let p=r=class extends n.oY{constructor(e){super(e),this.type="sun",this.date=null,this.directShadowsEnabled=!1,this.displayUTCOffset=null}readDate(e,t){return null!=t.datetime&&new Date(t.datetime)||null}writeDate(e,t,i){t[i]=e.getTime()}readDirectShadowsEnabled(e,t){return!!t.directShadows}writedirectShadowsEnabled(e,t,i){e&&(t[i]=e)}writeDisplayUTCOffset(e,t){null!=e&&(t.displayUTCOffset=e)}clone(){return new r(this.cloneConstructProperties())}cloneConstructProperties(){const e={directShadowsEnabled:this.directShadowsEnabled,displayUTCOffset:null!=this.displayUTCOffset?this.displayUTCOffset:null};return null!=this.date&&(e.date=new Date(this.date.getTime())),e}};(0,s._)([(0,o.MZ)({readOnly:!0,type:["sun"],json:{write:!0}})],p.prototype,"type",void 0),(0,s._)([(0,o.MZ)({type:Date,json:{type:Number,write:{target:"datetime"}}})],p.prototype,"date",void 0),(0,s._)([(0,a.w)("date",["datetime"])],p.prototype,"readDate",null),(0,s._)([(0,d.K)("date")],p.prototype,"writeDate",null),(0,s._)([(0,o.MZ)({type:Boolean,json:{default:!1,write:{target:"directShadows"}}})],p.prototype,"directShadowsEnabled",void 0),(0,s._)([(0,a.w)("directShadowsEnabled",["directShadows"])],p.prototype,"readDirectShadowsEnabled",null),(0,s._)([(0,d.K)("directShadowsEnabled")],p.prototype,"writedirectShadowsEnabled",null),(0,s._)([(0,o.MZ)({type:Number,json:{write:!0}})],p.prototype,"displayUTCOffset",void 0),(0,s._)([(0,d.K)("displayUTCOffset")],p.prototype,"writeDisplayUTCOffset",null),p=r=(0,s._)([(0,l.$)("esri.webscene.SunLighting")],p);const u=p},99372:(e,t,i)=>{i.d(t,{A:()=>d});var r,s=i(35143),n=i(42553),o=i(46053),a=(i(81806),i(76460),i(47249),i(85842));let l=r=class extends n.oY{constructor(e){super(e),this.type="virtual",this.directShadowsEnabled=!1}clone(){return new r(this.cloneConstructProperties())}cloneConstructProperties(){return{directShadowsEnabled:this.directShadowsEnabled}}};(0,s._)([(0,o.MZ)({readOnly:!0,type:["virtual"],json:{write:!0}})],l.prototype,"type",void 0),(0,s._)([(0,o.MZ)({type:Boolean,json:{default:!1,name:"directShadows",write:!0}})],l.prototype,"directShadowsEnabled",void 0),l=r=(0,s._)([(0,a.$)("esri.webscene.VirtualLighting")],l);const d=l},13206:(e,t,i)=>{i.d(t,{A:()=>l});var r=i(35143),s=i(42553),n=i(46053),o=(i(81806),i(76460),i(47249),i(85842));let a=class extends s.oY{constructor(e){super(e)}clone(){}};(0,r._)([(0,n.MZ)({readOnly:!0,json:{read:!1}})],a.prototype,"type",void 0),a=(0,r._)([(0,o.$)("esri.webscene.background.Background")],a);const l=a},45355:(e,t,i)=>{i.d(t,{A:()=>h});var r,s=i(35143),n=i(69539),o=i(46053),a=(i(81806),i(76460),i(47249),i(6409)),l=i(85842),d=i(85192),p=i(13206);const u={...d.E,nonNullable:!0};let c=r=class extends p.A{constructor(e){super(e),this.type="color",this.color=new n.A([0,0,0,1])}clone(){return new r(this.cloneProperties())}cloneProperties(){return{color:this.color.clone()}}};(0,s._)([(0,a.e)({color:"color"},{readOnly:!0})],c.prototype,"type",void 0),(0,s._)([(0,o.MZ)(u)],c.prototype,"color",void 0),c=r=(0,s._)([(0,l.$)("esri.webscene.background.ColorBackground")],c);const h=c},30650:(e,t,i)=>{i.d(t,{S:()=>n});var r=i(98277),s=i(99372);const n={key:"type",defaultKeyValue:"sun",base:null,typeMap:{sun:r.A,virtual:s.A}}},68897:(e,t,i)=>{i.d(t,{jR:()=>r,z3:()=>s,zL:()=>n});const r="https://.*";function s(e){return!!e&&/^https:\/\/.*/i.test(e)}function n(e){return!!e&&/data:([-\w]+\/[-+\w.]+)?(;?\w+=[-\w]+)*(;base64)?,.*/gu.test(e)}}}]);
//# sourceMappingURL=41439.34f09b2d.chunk.js.map