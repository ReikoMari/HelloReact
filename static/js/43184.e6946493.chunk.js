"use strict";(self.webpackChunkhelloworld=self.webpackChunkhelloworld||[]).push([[43184],{12843:(e,t,i)=>{i.d(t,{f:()=>q});var n=i(35143),r=i(91967),s=i(54901),o=i(50346),a=i(68134),l=i(31633),d=i(46053),c=(i(81806),i(76460)),h=(i(47249),i(85842)),u=i(19555),p=i(20664),f=i(9392),g=i(53494),v=i(19451),y=i(12482),_=i(75543),S=i(23862),w=i(34154),E=i(8203),m=i(46530),x=i(31933),T=i(70330),M=i(90992);let P=class extends r.A{get layerView(){var e;return null===(e=this.view)||void 0===e||null===(e=e.allLayerViews)||void 0===e?void 0:e.find((e=>e.layer===this.layer))}get valid(){return this._valid}get subtypeFilter(){var e,t,i;const{layer:n,snappingSource:r}=this;if(!(0,x.F2)(n)||null===(e=n.subtypes)||void 0===e||!e.length)return{mode:"not-in-use",filter:null};const s=r.layerSource.sublayerSources.filter((e=>{var t;return e.enabled&&e.layer.visible&&(0,M.JU)(null===(t=this.view)||void 0===t?void 0:t.scale,e.layer.effectiveScaleRange.minScale,e.layer.effectiveScaleRange.maxScale)})).map((e=>e.layer.subtypeCode));if(!s.length)return{mode:"none-visible",filter:null};if(s.length===n.subtypes.length)return{mode:"all-visible",filter:null};const o=null!==(t=null===(i=n.fieldsIndex.get(n.subtypeField))||void 0===i?void 0:i.name)&&void 0!==t?t:n.subtypeField;return 1===s.length?{mode:"in-use",filter:"".concat(o," = ").concat(s.getItemAt(0))}:{mode:"in-use",filter:"".concat(o," IN (").concat(s.join(", "),")")}}get floorFilter(){const{view:e,layer:t}=this;return e&&t?(0,m.E)({view:e,layer:t}):null}constructor(e){super(e),this.rulesTable=null,this._valid=!1}initialize(){if(!this.snappingSource||!this.layer)return;const{layer:e,snappingSource:t}=this;if("refresh"in e){const i=e;this.addHandles(i.on("refresh",(()=>t.refresh())))}this.loadRules(),this.addHandles([(0,a.watch)((()=>t.updating),(e=>t.layerSource.updating=e),a.syncAndInitial),(0,a.watch)((()=>t.availability),(e=>t.layerSource.availability=e),a.syncAndInitial)])}getFetchCandidatesParameters(e,t,i){var n,r,s,o,a;if(!this.valid)return[];const{layer:l,layerView:d,floorFilter:c,rulesTable:h,subtypeFilter:u}=this,p={distance:i,mode:null!==(n=null===(r=this.view)||void 0===r?void 0:r.type)&&void 0!==n?n:"2d",point:e,coordinateHelper:t.coordinateHelper,...this._types,filter:d&&"filter"in d?d.filter:null};if(c&&(p.filter=C(p.filter,c)),"not-in-use"!==u.mode&&"all-visible"!==u.mode){if("none-visible"===u.mode)return[];p.filter?p.filter.where=(0,w.m)(p.filter.where,u.mode):p.filter=new E.A({where:u.filter})}const f=t.feature,g="subtype-sublayer"===(null===f||void 0===f||null===(s=f.sourceLayer)||void 0===s?void 0:s.type)?f.sourceLayer.parent:null===f||void 0===f?void 0:f.sourceLayer;if(h&&f&&(0,T.Tu)(null===(o=this.view)||void 0===o?void 0:o.map)&&((0,x.yZ)(l)||(0,x.F2)(l))&&l.layerId&&((0,x.yZ)(g)||(0,x.F2)(g))&&null!==(a=this.view.map.utilityNetworks)&&void 0!==a&&a.find((e=>e.isUtilityLayer(g)))){var v;if("loaded"!==h.loadStatus)return[];const e=[],t=l.layerId,i=null===(v=h.getFeatureSQL(g,f))||void 0===v?void 0:v[t];if(!i)return[];const n=i.anyVertex;let r=i.endVertex;return r&&n&&r===n&&(r=""),r&&e.push({...p,returnEdge:!1,vertexMode:"ends",filter:C(p.filter,r)}),n&&e.push({...p,returnEdge:!1,vertexMode:"all",filter:C(p.filter,n)}),e}return[p]}async loadRules(){const{layer:e,view:t}=this;if(e&&t&&(0,T.Tu)(null===t||void 0===t?void 0:t.map)&&((0,x.yZ)(e)||(0,x.F2)(e))){var i;const s=null===(i=t.map.utilityNetworks)||void 0===i?void 0:i.find((t=>t.isUtilityLayer(e)));if(s)try{var n;this.rulesTable=await s.getRulesTable(),await(null===(n=this.rulesTable)||void 0===n?void 0:n.load())}catch(r){return void c.A.getLogger("esri.views.interactive.snapping.FeatureSnappingSourceInfo").error("Failed to load rules table for snapping source",e.title)}}this._valid=!0}get _types(){return{returnEdge:!0,vertexMode:"all"}}remove(){this.destroy()}destroy(){var e;null===(e=this.snappingSource)||void 0===e||e.destroy()}};function C(e,t){return null==e?new E.A({where:t}):e.where?new E.A({where:(0,w.m)(e.where,t)}):new E.A({where:t})}(0,n._)([(0,d.MZ)({constructOnly:!0})],P.prototype,"layer",void 0),(0,n._)([(0,d.MZ)({constructOnly:!0})],P.prototype,"snappingSource",void 0),(0,n._)([(0,d.MZ)({constructOnly:!0})],P.prototype,"view",void 0),(0,n._)([(0,d.MZ)()],P.prototype,"layerView",null),(0,n._)([(0,d.MZ)()],P.prototype,"rulesTable",void 0),(0,n._)([(0,d.MZ)()],P.prototype,"valid",null),(0,n._)([(0,d.MZ)()],P.prototype,"subtypeFilter",null),(0,n._)([(0,d.MZ)()],P.prototype,"floorFilter",null),(0,n._)([(0,d.MZ)()],P.prototype,"_valid",void 0),P=(0,n._)([(0,h.$)("esri.views.interactive.snapping.FeatureSnappingSourceInfo")],P);var L=i(99791),R=i(80794),b=i(9876),F=i(61751),A=i(78228),V=i(17072);let q=class extends r.A{get updating(){return this._snappingSources.some((e=>null==e||e.valid&&e.snappingSource.updating))||this._updatingHandles.updating}constructor(e){super(e),this.options=null,this._domain=L.n.FEATURE,this._updatingHandles=new v.U,this._sourceModules={featureService:{module:null,loader:null},featureCollection:{module:null,loader:null},graphics:{module:null,loader:null},notes:{module:null,loader:null},scene:{module:null,loader:null}}}initialize(){const e=(0,a.mapCollectionAsync)((()=>{var e;return null===(e=this.options)||void 0===e?void 0:e._effectiveFeatureSources}),((e,t)=>this._createSourceInfo(e,t)));this._snappingSources=e,this.addHandles((0,s.DQ)(e))}destroy(){this._set("options",null),this._updatingHandles.destroy()}async fetchCandidates(e,t,i,n){if(!(t&this._domain&&null!=this.options&&this.options.effectiveFeatureEnabled))return[];const r=[],s=this._computeScreenSizeDistanceParameters(e,i);for(const o of this._snappingSources){var a;if(null==o||!o.valid||!o.snappingSource.layerSource.enabled||null!==(a=o.layerView)&&void 0!==a&&a.suspended)continue;const t=o.getFetchCandidatesParameters(e,i,s);for(const e of t)r.push(o.snappingSource.fetchCandidates(e,n).then((e=>e.filter((e=>!this._candidateIsExcluded(o.snappingSource,e,i.excludeFeature))))))}const l=(await(0,o.nA)(r)).flat();return this._addRightAngleCandidates(l,e,s,i),(0,o.Te)(n),(0,T.xX)(e,l),l}_addRightAngleCandidates(e,t,i,n){var r,s,o,a;const l=null!=n.vertexHandle?null===(r=n.vertexHandle.rightEdge)||void 0===r||null===(r=r.rightVertex)||void 0===r?void 0:r.pos:null!=n.editGeometryOperations&&"polygon"===n.editGeometryOperations.data.type?null===(s=n.editGeometryOperations.data.components[0])||void 0===s||null===(s=s.getFirstVertex())||void 0===s?void 0:s.pos:null,d=null!=n.vertexHandle?null===(o=n.vertexHandle.leftEdge)||void 0===o||null===(o=o.leftVertex)||void 0===o?void 0:o.pos:null!=n.editGeometryOperations?null===(a=n.editGeometryOperations.data.components[0])||void 0===a||null===(a=a.getLastVertex())||void 0===a?void 0:a.pos:null,{view:c}=this,h=(0,S.Lp)(l,c,n),u=(0,S.Lp)(d,c,n),p=e.length;for(let f=0;f<p;f++)this._addRightAngleCandidate(e[f],u,t,i,e),this._addRightAngleCandidate(e[f],h,t,i,e)}_addRightAngleCandidate(e,t,i,n,r){if(null==t||!function(e){return(e instanceof b.z||e instanceof R.X)&&!function(e){let{constraint:{start:t,end:i}}=e;const n=(0,p.a)(t,i),r=(0,u.hG)((0,S.Xz)(t),(0,S.Xz)(i));return n<(0,g.FD)()||r/n<Z}(e)}(e))return;const s=e.constraint.closestTo(t),o=(s[0]-i[0])/n.x,a=(s[1]-i[1])/n.y,{start:l,end:d}=e.constraint;if(o*o+a*a<=1){const i=new A.H({targetPoint:s,otherVertex:t,otherVertexType:A.p.NEXT,previousVertex:(0,u.hG)((0,S.Xz)(s),(0,S.Xz)(l))>(0,u.hG)((0,S.Xz)(s),(0,S.Xz)(d))?l:d,constraint:new _.FX(t,s),objectId:e.objectId,isDraped:e.isDraped});r.push(i)}}_computeScreenSizeDistanceParameters(e,t){let i=null!=this.options?this.options.distance*("touch"===t.pointer?this.options.touchSensitivityMultiplier:1):0;return null==this.view?{x:i,y:i,z:i,distance:i}:"2d"===this.view.type?(i*=this.view.resolution,{x:i,y:i,z:i,distance:i}):this._computeScreenSizeDistanceParameters3D(e,i,this.view,t)}_computeScreenSizeDistanceParameters3D(e,t,i,n){const{spatialReference:r}=n;i.renderCoordsHelper.toRenderCoords(e,r,I);const s=i.state.camera.computeScreenPixelSizeAt(I),o=s*i.renderCoordsHelper.unitInMeters,a=o/(0,l.GA)(r),d=o/(0,l.G9)(r),c=t*a,h=t*d,u=(0,V.jq)(e,r,y.qt,i),p=u?z(u,e,a,0,0,i,n):0,f=u?z(u,e,0,a,0,i,n):0,g=u?z(u,e,0,0,d,i,n):0;return{x:0===p?0:c/p,y:0===f?0:c/f,z:0===g?0:h/g,distance:s*t}}_candidateIsExcluded(e,t,i){if(null==i)return!1;const n=this._getCandidateObjectId(t);if(null==n)return!1;const r=e.layerSource.layer;return"graphics"===r.type?i.uid===n:i.sourceLayer===r&&!(!i.attributes||!("objectIdField"in r))&&i.attributes[r.objectIdField]===n}_getCandidateObjectId(e){return e instanceof F.w?e.objectId:null}async _createSourceInfo(e,t){const i=e.layer;i.loaded||(await i.load(),(0,o.Te)(t));const{view:n}=this,r=await this._createFeatureSnappingSourceType(e);return(0,o.Te)(t),new P(null==r?{}:{snappingSource:r,view:n,layer:i})}async _createFeatureSnappingSourceType(e){switch(e.layer.type){case"feature":case"geojson":case"csv":case"oriented-imagery":case"subtype-group":case"wfs":return this._createFeatureSnappingSourceFeatureLayer(e);case"graphics":return this._createFeatureSnappingSourceGraphicsLayer(e);case"map-notes":return this._createFeatureSnappingSourceMapNotesLayer(e);case"scene":case"building-scene":return this._createFeatureSnappingSourceSceneLayer(e)}return null}async _createFeatureSnappingSourceSceneLayer(e){const{view:t}=this;return null==t||"3d"!==t.type?null:new((await this._getSourceModule("scene")).SceneLayerSnappingSource)({layerSource:e,view:t})}async _createFeatureSnappingSourceFeatureLayer(e){var t;switch(null===(t=e.layer.source)||void 0===t?void 0:t.type){case"feature-layer":case"oriented-imagery":return new((await this._getSourceModule("featureService")).FeatureServiceSnappingSource)({spatialReference:this.spatialReference,view:this.view,layerSource:e});case"memory":case"csv":case"geojson":case"wfs":return"mesh"===e.layer.geometryType?null:new((await this._getSourceModule("featureCollection")).FeatureCollectionSnappingSource)({layerSource:e,view:this.view})}return null}async _createFeatureSnappingSourceGraphicsLayer(e){return new((await this._getSourceModule("graphics")).GraphicsSnappingSource)({getGraphicsLayers:()=>[e.layer],spatialReference:this.spatialReference,view:this.view,layerSource:e})}async _createFeatureSnappingSourceMapNotesLayer(e){return new((await this._getSourceModule("notes")).GraphicsSnappingSource)({getGraphicsLayers:()=>{var t,i;return null!==(t=null===(i=e.layer.sublayers)||void 0===i?void 0:i.toArray())&&void 0!==t?t:[]},spatialReference:this.spatialReference,view:this.view,layerSource:e})}async _getSourceModule(e){const t=this._sourceModules[e];if(null==t.loader){const t=this._loadSourceModule(e),i={module:null,loader:t};this._sourceModules[e]=i;const n=await t,r={module:n,loader:t};return this._sourceModules[e]=r,n}return null==t.module?t.loader:t.module}_loadSourceModule(e){const t=this._updatingHandles;switch(e){case"featureService":return t.addPromise(i.e(85376).then(i.bind(i,85376)));case"featureCollection":return t.addPromise(i.e(77567).then(i.bind(i,77567)));case"graphics":case"notes":return t.addPromise(Promise.all([i.e(3620),i.e(67425),i.e(97216),i.e(72003),i.e(91446),i.e(296)]).then(i.bind(i,99546)));case"scene":return t.addPromise(Promise.all([i.e(88105),i.e(13537)]).then(i.bind(i,13537)))}}get test(){return{snappingSources:this._snappingSources}}};function z(e,t,i,n,r,s,o){let{spatialReference:a}=o;const l=(0,p.c)(j,t);l[0]+=i,l[1]+=n,l[2]+=r;const d=(0,V.jq)(l,a,y.qt,s);return d?(0,T.Mo)(d,e):1/0}(0,n._)([(0,d.MZ)({constructOnly:!0})],q.prototype,"spatialReference",void 0),(0,n._)([(0,d.MZ)({constructOnly:!0})],q.prototype,"view",void 0),(0,n._)([(0,d.MZ)()],q.prototype,"options",void 0),(0,n._)([(0,d.MZ)({readOnly:!0})],q.prototype,"updating",null),(0,n._)([(0,d.MZ)()],q.prototype,"_snappingSources",void 0),q=(0,n._)([(0,h.$)("esri.views.interactive.snapping.FeatureSnappingEngine")],q);const I=(0,f.vt)(),j=(0,f.vt)(),Z=1e-4},3589:(e,t,i)=>{i.d(t,{A:()=>d});var n=i(35143),r=i(91967),s=i(19276),o=i(46053),a=(i(81806),i(76460),i(47249),i(85842));let l=class extends r.A{constructor(e){super(e),this.layer=null,this.enabled=!0,this.updating=!1,this.availability=1,this.sublayerSources=new s.A}};(0,n._)([(0,o.MZ)({constructOnly:!0})],l.prototype,"layer",void 0),(0,n._)([(0,o.MZ)()],l.prototype,"enabled",void 0),(0,n._)([(0,o.MZ)()],l.prototype,"updating",void 0),(0,n._)([(0,o.MZ)()],l.prototype,"availability",void 0),(0,n._)([(0,o.MZ)()],l.prototype,"sublayerSources",void 0),l=(0,n._)([(0,a.$)("esri.views.interactive.snapping.FeatureSnappingLayerSource")],l);const d=l},43184:(e,t,i)=>{i.d(t,{g:()=>ee});var n=i(35143),r=i(91967),s=i(54099),o=i(50346),a=i(68134),l=i(46053),d=(i(81806),i(76460),i(47249),i(85842)),c=i(9624),h=i(12482),u=i(23862),p=i(63078),f=i(99791),g=i(12843),v=i(19276),y=i(73582),_=i(24648),S=i(9392),w=i(31633),E=i(19555),m=i(70330),x=i(17072);class T{constructor(e,t){this.view=e,this.options=t,this.squaredShortLineThreshold=p.N.shortLineThreshold*p.N.shortLineThreshold}snap(e,t){return null!=t.vertexHandle?"vertex"!==t.vertexHandle.type?[]:this.snapExistingVertex(e,t):this.snapNewVertex(e,t)}edgeExceedsShortLineThreshold(e,t){return this.exceedsShortLineThreshold((0,u.Lp)(e.leftVertex.pos,this.view,t),(0,u.Lp)(e.rightVertex.pos,this.view,t),t)}exceedsShortLineThreshold(e,t,i){let{spatialReference:n}=i;return 0===this.squaredShortLineThreshold||(0,m.pM)((0,x.jq)(t,n,h.qt,this.view),(0,x.jq)(e,n,h.qt,this.view))>this.squaredShortLineThreshold}isVertical(e,t,i){let{spatialReference:n}=i;const r=(0,w.GA)(n);return(0,E.Io)((0,u.Xz)(e),(0,u.Xz)(t))*r<p.N.verticalLineThresholdMeters}squaredProximityThreshold(e){return"touch"===e?this._squaredTouchProximityThreshold:this._squaredMouseProximityThreshold}get _squaredMouseProximityThreshold(){return this.options.distance*this.options.distance}get _squaredTouchProximityThreshold(){const{distance:e,touchSensitivityMultiplier:t}=this.options,i=e*t;return i*i}}var M=i(75543),P=i(30003),C=i(23543);class L extends P.C{constructor(e){let{lineStart:t,lineEnd:i,targetPoint:n,isDraped:r}=e;super(n,new M.WG(t,i),r,f.n.SELF),this._referenceLineHint=new C.c(m.H3.REFERENCE_EXTENSION,t,i,r,this.domain)}get hints(){return[this._referenceLineHint,new C.c(m.H3.TARGET,this._lineEndClosestToTarget(),this.targetPoint,this.isDraped,this.domain)]}_lineEndClosestToTarget(){return this.constraint.closestEndTo(this.targetPoint)}}var R=i(89646),b=i(92854),F=i(79337),A=i(74050);class V extends T{snapNewVertex(e,t){const i=t.editGeometryOperations.data.components[0],n=i.edges.length,r=[];if(n<1)return r;const{spatialReference:s}=t,o=(0,x.jq)(e,s,h.qt,this.view),{view:a}=this,l=i.edges[n-1];let d=l;do{if(this.edgeExceedsShortLineThreshold(d,t)){const i=(0,m.is)(d,a,t);this._processCandidateProposal(i.left,i.right,e,o,t,r)}d=d.leftVertex.leftEdge}while(d&&d!==l);return r}snapExistingVertex(e,t){const i=[],n=t.vertexHandle,r=n.component;if(r.edges.length<2)return i;const{view:s}=this,{spatialReference:o}=t,a=(0,x.jq)(e,o,h.qt,s),l=n.leftEdge,d=n.rightEdge;l&&d&&this.edgeExceedsShortLineThreshold(l,t)&&this.edgeExceedsShortLineThreshold(d,t)&&this._processCandidateProposal((0,u.Lp)(l.leftVertex.pos,s,t),(0,u.Lp)(d.rightVertex.pos,s,t),e,a,t,i);const c=r.edges[0];let p=c;do{if(p!==n.leftEdge&&p!==n.rightEdge&&this.edgeExceedsShortLineThreshold(p,t)){const n=(0,m.is)(p,s,t);this._processCandidateProposal(n.left,n.right,e,a,t,i)}p=p.rightVertex.rightEdge}while(p&&p!==c);return i}_processCandidateProposal(e,t,i,n,r,s){var o;const{spatialReference:a,pointer:l}=r,d=(0,S.vt)();this._projectedLine(d,e,t,i,r);const c=(0,u._7)(d);(0,m.pM)(n,(0,x.jq)(c,a,h.qt,this.view))<this.squaredProximityThreshold(l)&&s.push(new L({lineStart:e,lineEnd:t,targetPoint:c,isDraped:"on-the-ground"===(null===(o=r.elevationInfo)||void 0===o?void 0:o.mode)}))}_projectedLine(e,t,i,n,r){this._projectToLineGeodesic(e,t,i,n,r)||this._projectToLinePlanar(e,n,t,i)}_projectToLineGeodesic(e,t,i,n,r){let{spatialReference:s}=r;const o=(0,R.IP)(t,i,s,s);if(null==o)return!1;const a=(0,R.IP)(i,n,s,s);if(null==a)return!1;const l=(0,b.n3)(i,n,s);if(null==l)return!1;const d=Math.abs(y.wf.shortestSignedDiff(o,a))>Math.PI/2?y.uC.normalize(o+Math.PI):o;return(0,R.rT)(e,i,s,(0,_.l3)(l,"meters"),(0,_.Wq)(d,"radians","geographic"),"geodesic"),e[2]=n[2],!0}_projectToLinePlanar(e,t,i,n){(0,F.Yv)(t,{start:i,end:n,type:A.Vv.LINE},e),e[2]=t[2]}}var q=i(72745),z=i(20664),I=i(20578);class j extends P.C{constructor(e){let{referenceLine:t,lineStart:i,targetPoint:n,isDraped:r}=e;const s=(0,S.o8)(i),{left:o,right:a}=t;(0,z.f)(s,(0,z.g)(s,s,a),o),super(n,new M.WG(i,(0,u._7)(s)),r,f.n.SELF),this._referenceLines=[{edge:t,fadeLeft:!0,fadeRight:!0}]}get hints(){return[new C.c(m.H3.TARGET,this.constraint.start,this.targetPoint,this.isDraped,this.domain),new I.r(this.constraint.start,this.targetPoint,this.isDraped,this.domain),...this._referenceLines.map((e=>new C.c(m.H3.REFERENCE,e.edge.left,e.edge.right,this.isDraped,this.domain,e.fadeLeft,e.fadeRight)))]}addReferenceLine(e){const t={edge:e,fadeLeft:!0,fadeRight:!0};this._referenceLines.forEach((i=>{(0,z.j)(e.right,i.edge.left)&&(i.fadeLeft=!1,t.fadeRight=!1),(0,z.j)(e.right,i.edge.right)&&(i.fadeRight=!1,t.fadeRight=!1),(0,z.j)(e.left,i.edge.right)&&(i.fadeRight=!1,t.fadeLeft=!1),(0,z.j)(e.left,i.edge.left)&&(i.fadeLeft=!1,t.fadeLeft=!1)})),this._referenceLines.push(t)}}class Z extends T{snapNewVertex(e,t){const i=t.editGeometryOperations.data.components[0],n=i.edges.length,r=i.vertices.length,s=[];if(n<2)return s;const{view:o}=this,a=(0,x.jq)(e,t.spatialReference,h.qt,o),l=(0,u.Lp)(i.vertices[r-1].pos,o,t),d=(0,u.Lp)(i.vertices[0].pos,o,t),c=i.edges[n-1];let p=c;do{if(this.edgeExceedsShortLineThreshold(p,t)){const i=(0,m.is)(p,o,t);this._checkEdgeForParallelLines(i,l,e,a,t,s),this._checkEdgeForParallelLines(i,d,e,a,t,s)}p=p.leftVertex.leftEdge}while(p&&p!==c);return s}snapExistingVertex(e,t){const i=[],n=t.vertexHandle,r=n.component;if(r.edges.length<3)return i;const{view:s}=this,o=(0,x.jq)(e,t.spatialReference,h.qt,s),a=n.leftEdge,l=n.rightEdge,d=r.vertices[0],c=(0,u.Lp)(d.pos,s,t),p=r.vertices.length,f=r.vertices[p-1],g=(0,u.Lp)(f.pos,s,t),v=r.edges[0];let y=v;do{if(y!==a&&y!==l&&this.edgeExceedsShortLineThreshold(y,t)){const r=(0,m.is)(y,s,t);a&&this._checkEdgeForParallelLines(r,(0,u.Lp)(a.leftVertex.pos,s,t),e,o,t,i),l&&this._checkEdgeForParallelLines(r,(0,u.Lp)(l.rightVertex.pos,s,t),e,o,t,i),n===d?this._checkEdgeForParallelLines(r,g,e,o,t,i):n===f&&this._checkEdgeForParallelLines(r,c,e,o,t,i)}y=y.rightVertex.rightEdge}while(y&&y!==v);return i}_checkEdgeForParallelLines(e,t,i,n,r,s){const o=e.left,a=e.right;if((0,A.fg)(N,(0,u.Xz)(t),(0,u.Xz)(o),(0,u.Xz)(a)),(0,E.hG)(N,(0,u.Xz)(t))<p.N.parallelLineThreshold)return;(0,A.fg)(N,(0,u.Xz)(i),(0,u.Xz)(o),(0,u.Xz)(a),(0,u.Xz)(t));const{spatialReference:l,pointer:d}=r,c=(0,u.fA)(N[0],N[1],i[2]);if((0,m.pM)(n,(0,x.jq)(c,l,h.qt,this.view))<this.squaredProximityThreshold(d)){var f;if(this.isVertical(c,t,r)||this.isVertical(o,a,r))return;if(this._parallelToPreviousCandidate(e,s))return;s.push(new j({referenceLine:e,lineStart:t,targetPoint:c,isDraped:"on-the-ground"===(null===(f=r.elevationInfo)||void 0===f?void 0:f.mode)}))}}_parallelToPreviousCandidate(e,t){const i=e.left,n=e.right;for(const r of t)if((0,A.fg)(N,(0,u.Xz)(n),(0,u.Xz)(r.constraint.start),(0,u.Xz)(r.constraint.end),(0,u.Xz)(i)),(0,E.hG)(N,(0,u.Xz)(n))<p.N.parallelLineThreshold)return r.addReferenceLine(e),!0;return!1}}const N=(0,q.vt)();var H=i(78228);class O extends T{snapNewVertex(e,t){const i=t.editGeometryOperations.data.components[0],n=[];if(i.vertices.length<2)return n;const{view:r}=this,s=(0,x.jq)(e,t.spatialReference,h.qt,r),o=i.vertices.at(-1);this._checkForSnappingCandidate(n,o.leftEdge,o,o.leftEdge.leftVertex,e,s,t);const a=i.vertices[0];return this._checkForSnappingCandidate(n,a.rightEdge,a,a.rightEdge.rightVertex,e,s,t),n}snapExistingVertex(e,t){const i=[],n=t.vertexHandle;if(n.component.vertices.length<3)return i;const{view:r}=this,s=(0,x.jq)(e,t.spatialReference,h.qt,r),o=n.leftEdge,a=n.rightEdge;if(null!==o&&void 0!==o&&o.leftVertex.leftEdge){const n=o.leftVertex.leftEdge;this._checkForSnappingCandidate(i,n,n.rightVertex,n.leftVertex,e,s,t)}if(null!==a&&void 0!==a&&a.rightVertex.rightEdge){const n=a.rightVertex.rightEdge;this._checkForSnappingCandidate(i,n,n.leftVertex,n.rightVertex,e,s,t)}return i}_checkForSnappingCandidate(e,t,i,n,r,s,o){if(!this.edgeExceedsShortLineThreshold(t,o))return;const a=this.view,l=(0,u.Lp)(i.pos,a,o),d=(0,u.Lp)(n.pos,a,o);this._checkForSnappingCandidateNormalized(e,d,l,r,s,o)}_checkForSnappingCandidateNormalized(e,t,i,n,r,s){this._projectionRay(X,t,i,n,s),this._checkForSnappingCandidateAlongProjectedRay(e,t,i,X,n,r,s)}_projectionRay(e,t,i,n,r){this._projectionRayGeodesic(e,t,i,n,r)||this._projectionRayPlanar(e,t,i)}_projectionRayGeodesic(e,t,i,n,r){let{spatialReference:s}=r;const o=(0,R.IP)(t,i,s,s);if(null==o)return!1;const a=(0,R.IP)(i,n,s,s);if(null==a)return!1;const l=Math.sign(y.uC.shortestSignedDiff(o,a))*Math.PI*.5,d=(0,_.Wq)(o+l,"radians","geographic"),c=(0,S.vt)(),h=(0,b.n3)(i,n,s);return null!=h&&((0,R.rT)(c,i,s,(0,_.l3)(h,"meters"),d,"geodesic"),(0,z.f)(e,c,i),!0)}_projectionRayPlanar(e,t,i){const n=(0,E.Re)(D,(0,u.Xz)(i),(0,u.Xz)(t));(0,z.s)(e,n[1],-n[0],0)}_checkForSnappingCandidateAlongProjectedRay(e,t,i,n,r,s,o){var a;const{spatialReference:l,pointer:d}=o,c=(0,E.Re)(D,(0,u.Xz)(r),(0,u.Xz)(i)),p=(0,E.Om)(n,c)/(0,E.m3)(n),f=(0,E.Ln)(D,(0,u.Xz)(i),n,p),g=(0,u.fA)(f[0],f[1],r[2]);if((0,m.pM)(s,(0,x.jq)(g,l,h.qt,this.view))>this.squaredProximityThreshold(d)||this.isVertical(g,i,o)||this.isVertical(i,t,o))return;const v=(0,z.r)((0,S.vt)(),i,n,Math.sign(p));e.push(new H.H({targetPoint:g,constraint:new M.FX(i,(0,u._7)(v)),previousVertex:t,otherVertex:i,otherVertexType:H.p.CENTER,isDraped:"on-the-ground"===(null===(a=o.elevationInfo)||void 0===a?void 0:a.mode)}))}}const D=(0,q.vt)(),X=(0,S.vt)();var G=i(56572);class k extends P.C{constructor(e){let{targetPoint:t,point1:i,point2:n,isDraped:r}=e;super(t,new M.ej((0,u._7)((0,z.m)((0,S.vt)(),i,n,.5)),.5*(0,E.Io)((0,u.Xz)(i),(0,u.Xz)(n))),r,f.n.SELF),this._p1=i,this._p2=n}get hints(){return[new C.c(m.H3.REFERENCE,this.targetPoint,this._p1,this.isDraped,this.domain),new C.c(m.H3.REFERENCE,this.targetPoint,this._p2,this.isDraped,this.domain),new G.l(this._p1,this.targetPoint,this._p2,this.isDraped,this.domain)]}}class W extends T{snapNewVertex(e,t){const i=t.editGeometryOperations.data.components[0],n=[],r=i.vertices.length;if("polygon"!==t.editGeometryOperations.data.type||r<2)return n;const{view:s}=this,o=i.vertices[0],a=i.vertices[r-1],l=(0,u.Lp)(o.pos,s,t),d=(0,u.Lp)(a.pos,s,t);return this._processCandidateProposal(l,d,e,t,n),n}snapExistingVertex(e,t){const i=[],n=t.vertexHandle,r=n.component;if(r.edges.length<2)return i;if("polyline"===t.editGeometryOperations.data.type&&(0===n.index||n.index===r.vertices.length-1))return i;const{view:s}=this,o=(0,u.Lp)(n.leftEdge.leftVertex.pos,s,t),a=(0,u.Lp)(n.rightEdge.rightVertex.pos,s,t);return this._processCandidateProposal(o,a,e,t,i),i}_processCandidateProposal(e,t,i,n,r){if(!this.exceedsShortLineThreshold(e,t,n))return;const s=(0,E.Cc)(U,(0,u.Xz)(e),(0,u.Xz)(t),.5),o=.5*(0,E.Io)((0,u.Xz)(e),(0,u.Xz)(t)),a=(0,A.Dh)(U,(0,u.Xz)(i),s,o),l=(0,u.fA)(a[0],a[1],i[2]),{spatialReference:d,pointer:c}=n,p=(0,x.jq)(i,d,h.qt,this.view);if((0,m.pM)(p,(0,x.jq)(l,d,h.qt,this.view))<this.squaredProximityThreshold(c)){var f;if(this.isVertical(e,l,n)||this.isVertical(l,t,n))return;r.push(new k({targetPoint:l,point1:e,point2:t,isDraped:"on-the-ground"===(null===(f=n.elevationInfo)||void 0===f?void 0:f.mode)}))}}}const U=(0,q.vt)();let $=class extends r.A{constructor(e){super(e),this.updating=!1,this._snappers=new v.A,this._domain=f.n.SELF}initialize(){this._snappers.push(new Z(this.view,this.options),new V(this.view,this.options),new O(this.view,this.options),new W(this.view,this.options))}set options(e){this._set("options",e);for(const t of this._snappers)t.options=e}async fetchCandidates(e,t,i){if(!(t&this._domain&&this.options.effectiveSelfEnabled))return[];const n=[];for(const r of this._snappers.items)for(const t of r.snap(e,i))n.push(t);return(0,m.xX)(e,n),n}};function Q(e,t){return[new $({view:e,options:t}),new g.f({view:e,options:t,spatialReference:e.spatialReference})]}(0,n._)([(0,l.MZ)({readOnly:!0})],$.prototype,"updating",void 0),(0,n._)([(0,l.MZ)({constructOnly:!0})],$.prototype,"view",void 0),(0,n._)([(0,l.MZ)()],$.prototype,"options",null),$=(0,n._)([(0,d.$)("esri.views.interactive.snapping.SelfSnappingEngine")],$);var Y=i(83973),J=i(9876),K=i(30484);class B extends P.C{constructor(e,t,i,n){super(e,new M.i7(e),n,f.n.ALL),this.first=t,this.second=i}get hints(){return this.first.targetPoint=this.targetPoint,this.second.targetPoint=this.targetPoint,[...this.first.hints,...this.second.hints,new K.v(this.targetPoint,this.isDraped,this.domain)]}}let ee=class extends(s.A.EventedMixin(r.A)){constructor(e){super(e),this.options=new Y.A,this.snappingEnginesFactory=Q,this._engines=[],this._currentMainCandidate=null,this._currentOtherActiveCandidates=[],this._currentSnappedType=te.MAIN}initialize(){this.addHandles([(0,a.watch)((()=>{const{effectiveFeatureEnabled:e,effectiveSelfEnabled:t,touchSensitivityMultiplier:i,distance:n,constraintsActive:r}=this.options;return{effectiveFeatureEnabled:e,effectiveSelfEnabled:t,touchSensitivityMultiplier:i,distance:n,constraintsActive:r}}),(()=>{this.doneSnapping(),this.emit("changed")}),a.sync),(0,a.watch)((()=>this.options),(e=>{for(const t of this._engines)t.options=e}),a.sync),(0,a.watch)((()=>({viewReady:this.view.ready,viewSpatialReference:this.view.spatialReference,snappingEnginesFactory:this.snappingEnginesFactory})),(e=>{let{viewReady:t,snappingEnginesFactory:i}=e;return this._recreateEngines(t,i)}),a.syncAndInitial)])}destroy(){this._destroyEngines()}get updating(){return this._engines.some((e=>e.updating))}_recreateEngines(e,t){if(this._destroyEngines(),!e)return;const{view:i,options:n}=this;this._engines=t(i,n)}_destroyEngines(){for(const e of this._engines)e.destroy();this._engines=[]}get _squaredMouseProximityThreshold(){return this.options.distance*this.options.distance}get _squaredTouchProximityThreshold(){const{distance:e,touchSensitivityMultiplier:t}=this.options,i=e*t;return i*i}get _squaredSatisfiesConstraintThreshold(){return p.N.satisfiesConstraintScreenThreshold*p.N.satisfiesConstraintScreenThreshold}snap(e){return function(e){return null!=e.scenePoint}(e)?this._snapMultiPoint(e):this._snapSinglePoint(e)}update(e){const{point:t,context:i}=e;this._removeVisualization();const n=this._currentMainCandidate;if(null==n)return t;const r=this._selectUpdateInput(e);if(null==r)return t;const{spatialReference:s}=i,o=(0,c.project)(r,s);if(null==o)return t;const{view:a}=this,{elevationInfo:l,visualizer:d}=i,h=[],p=(0,u.vf)(o,a,l),f=n.constraint.closestTo(p);if(!this._arePointsWithinScreenThreshold(p,f,i))return this._resetSnappingState(),t;n.targetPoint=f,h.push(...n.hints);for(const c of this._currentOtherActiveCandidates)c.targetPoint=f,h.push(...c.hints);return null!=d&&this.addHandles(d.draw(h,{spatialReference:s,elevationInfo:re(i),view:a,selfSnappingZ:i.selfSnappingZ}),ne),(0,u.xF)(f,a,t,i)}doneSnapping(){this._removeVisualization(),this._resetSnappingState()}_selectUpdateInput(e){let{point:t,scenePoint:i}=e;switch(this._currentSnappedType){case te.MAIN:return t;case te.SCENE:return i}}_resetSnappingState(){this._currentMainCandidate=null,this._currentOtherActiveCandidates=[],this._currentSnappedType=te.MAIN}_removeVisualization(){this.removeHandles(ne)}async _snapSinglePoint(e){let{point:t,context:i,signal:n}=e;const{view:r}=this,{elevationInfo:s}=i,o=(0,u.vf)(t,r,s),a=await this._fetchCandidates(o,f.n.ALL,i,n);return this._createSnapResult(o,te.MAIN,a,r,t,i,n)}async _snapMultiPoint(e){var t,i;let{point:n,scenePoint:r,context:s,signal:o}=e;const{view:a}=this,{coordinateHelper:l,elevationInfo:d,spatialReference:h}=s;await(0,c.initializeProjection)(r.spatialReference,h);const p=(0,c.project)(r,h),g=(0,u.vf)(p,a,d),v=await this._fetchCandidates(g,f.n.FEATURE,s,o);if(v.length>0){const e=await this._fetchCandidates(g,f.n.SELF,s,o);return this._createSnapResult(g,te.SCENE,[...v,...e],a,p,s,o)}const y=(0,u.vf)(n,a,d),_=await this._fetchCandidates(y,f.n.SELF,s,o);return this._createSnapResult(y,te.MAIN,_,a,{z:l.hasZ()&&n.hasZ?null!==(t=n.z)&&void 0!==t?t:0:void 0,m:l.hasM()&&n.hasM?null!==(i=n.m)&&void 0!==i?i:0:void 0},s,o)}async _fetchCandidates(e,t,i,n){return(await Promise.all(this._engines.map((r=>r.fetchCandidates(e,t,i,n))))).flat()}_createSnapResult(e,t,i,n,r,s,a){return{get valid(){return!(0,o.G4)(a)},apply:()=>{const{spatialReference:o}=s,{snappedPoint:a,hints:l}=this._processCandidates(e,t,i,s);return this._removeVisualization(),null!=s.visualizer&&this.addHandles(s.visualizer.draw(l,{spatialReference:o,elevationInfo:h.qt,view:n,selfSnappingZ:s.selfSnappingZ}),ne),(0,u.xF)(a,n,r,s)}}}_processCandidates(e,t,i,n){if(i.length<1)return this.doneSnapping(),{snappedPoint:e,hints:[]};this._currentSnappedType!==t&&this._resetSnappingState(),(0,m.xX)(e,i);const r=this._currentMainCandidate;if(null!=r){const s=this._findOldConstraintInNewCandidates(r,i);if(s>=0){if(!(i[s]instanceof B))return this._intersectWithOtherCandidates(s,i,e,t,n);if(this._arePointsWithinScreenThreshold(e,r.targetPoint,n))return this._updateSnappingCandidate(r,t,i,n)}}return this._intersectWithOtherCandidates(0,i,e,t,n)}_findOldConstraintInNewCandidates(e,t){return e instanceof B?this._findOldCandidateIndex(t,e.first)>=0&&this._findOldCandidateIndex(t,e.second)>=0?0:-1:this._findOldCandidateIndex(t,e)}_intersectWithOtherCandidates(e,t,i,n,r){const{coordinateHelper:s}=r,o=t[e],a=[];for(let l=0;l<t.length;++l){if(l===e)continue;const n=t[l],r=o.constraint.intersect(n.constraint);if(r)for(const e of r.closestPoints(o.targetPoint))a.push([new B(e,o,n,n.isDraped),this._squaredScreenDistance(i,e,s)])}return a.length>0&&(a.sort(((e,t)=>e[1]-t[1])),a[0][1]<this._squaredPointProximityThreshold(r.pointer))?this._updateSnappingCandidate(a[0][0],n,t,r):this.options.constraintsActive&&(o instanceof L||o instanceof J.z||o instanceof H.H||o instanceof j)?{snappedPoint:i,hints:[]}:this._updateSnappingCandidate(o,n,t,r)}_updateSnappingCandidate(e,t,i,n){this.doneSnapping(),this._currentMainCandidate=e,this._currentSnappedType=t;const r=this._currentMainCandidate.targetPoint,s=[];s.push(...e.hints);for(const o of i){if(e instanceof B){if(o.constraint.equals(e.first.constraint)||o.constraint.equals(e.second.constraint))continue}else if(o.constraint.equals(e.constraint))continue;const t=o.constraint.closestTo(r);this._squaredScreenDistance(t,r,n.coordinateHelper)<this._squaredSatisfiesConstraintThreshold&&(o.targetPoint=r,this._currentOtherActiveCandidates.push(o),s.push(...o.hints))}return{snappedPoint:r,hints:s}}_squaredPointProximityThreshold(e){return"touch"===e?this._squaredTouchProximityThreshold:this._squaredMouseProximityThreshold}_arePointsWithinScreenThreshold(e,t,i){return this._squaredScreenDistance(e,t,i.coordinateHelper)<this._squaredPointProximityThreshold(i.pointer)}_squaredScreenDistance(e,t,i){return(0,m.pM)(this._toScreen(e,i),this._toScreen(t,i))}_toScreen(e,t){return(0,x.jq)(e,t.spatialReference,h.qt,this.view)}_findOldCandidateIndex(e,t){let i=-1;for(let n=0;n<e.length;++n)if(t.constraint.equals(e[n].constraint)){i=n;break}return i}get test(){return{visualizationsActive:this.hasHandles(ne),engines:this._engines}}};var te,ie;(0,n._)([(0,l.MZ)({constructOnly:!0})],ee.prototype,"view",void 0),(0,n._)([(0,l.MZ)()],ee.prototype,"options",void 0),(0,n._)([(0,l.MZ)({readOnly:!0})],ee.prototype,"updating",null),(0,n._)([(0,l.MZ)()],ee.prototype,"snappingEnginesFactory",void 0),(0,n._)([(0,l.MZ)()],ee.prototype,"_engines",void 0),(0,n._)([(0,l.MZ)()],ee.prototype,"_squaredMouseProximityThreshold",null),(0,n._)([(0,l.MZ)()],ee.prototype,"_squaredTouchProximityThreshold",null),(0,n._)([(0,l.MZ)()],ee.prototype,"_squaredSatisfiesConstraintThreshold",null),ee=(0,n._)([(0,d.$)("esri.views.interactive.snapping.SnappingManager")],ee),(ie=te||(te={}))[ie.MAIN=0]="MAIN",ie[ie.SCENE=1]="SCENE";const ne="visualization-handle";function re(e){let{coordinateHelper:t,elevationInfo:i}=e;return t.hasZ()?h.qt:i}},83973:(e,t,i)=>{i.d(t,{A:()=>p});var n=i(35143),r=i(91967),s=i(18690),o=i(19276),a=i(76460),l=i(46053),d=(i(81806),i(85842)),c=i(3589),h=i(63078);let u=class extends r.A{constructor(e){super(e),this.enabled=!1,this.enabledToggled=!1,this.forceDisabled=!1,this.selfEnabled=!0,this.featureEnabled=!0,this.featureSources=new o.A,this.distance=h.N.distance,this.touchSensitivityMultiplier=h.N.touchSensitivityMultiplier,this.constraintsActive=!1}get effectiveEnabled(){return!this.forceDisabled&&(this.enabledToggled?!this.enabled:this.enabled)}get effectiveSelfEnabled(){return this.effectiveEnabled&&this.selfEnabled}get effectiveFeatureEnabled(){return this.effectiveEnabled&&this.featureEnabled}get _effectiveFeatureSources(){var e,t,i;const n=this.featureSources;n.some(f)&&a.A.getLogger(this).warnOnce("Do not configure SubtypeGroupLayer sources in SnappingOptions.featureSources directly. Create a FeatureSnappingLayerSource for each SubtypeSublayer.");const r=n.filter(v),l=null!==(e=null===(t=this._get("_effectiveFeatureSources"))||void 0===t?void 0:t.filter(f))&&void 0!==e?e:new o.A;for(const s of r){const e=l.find((e=>e.layer===s.layer.parent));if(e)e.sublayerSources.includes(s)||e.sublayerSources.add(s);else if(s.layer.parent){const e=new c.A({layer:s.layer.parent});e.sublayerSources.add(s),l.add(e)}}for(const s of l){const e=s.sublayerSources.filter((e=>!r.includes(e)));s.sublayerSources.removeMany(e)}l.removeMany(l.filter((e=>0===e.sublayerSources.length)));const d=n.filter(g),h=null!==(i=this._get("_effectiveFeatureSources"))&&void 0!==i?i:new o.A,{added:u,removed:p}=(0,s.iv)(h.toArray(),[...d,...l]);return h.removeMany(p),h.addMany(u),h}};(0,n._)([(0,l.MZ)()],u.prototype,"enabled",void 0),(0,n._)([(0,l.MZ)()],u.prototype,"enabledToggled",void 0),(0,n._)([(0,l.MZ)()],u.prototype,"forceDisabled",void 0),(0,n._)([(0,l.MZ)()],u.prototype,"selfEnabled",void 0),(0,n._)([(0,l.MZ)()],u.prototype,"featureEnabled",void 0),(0,n._)([(0,l.MZ)({type:o.A.ofType(c.A)})],u.prototype,"featureSources",void 0),(0,n._)([(0,l.MZ)()],u.prototype,"distance",void 0),(0,n._)([(0,l.MZ)()],u.prototype,"touchSensitivityMultiplier",void 0),(0,n._)([(0,l.MZ)()],u.prototype,"constraintsActive",void 0),(0,n._)([(0,l.MZ)({readOnly:!0})],u.prototype,"effectiveEnabled",null),(0,n._)([(0,l.MZ)({readOnly:!0})],u.prototype,"effectiveSelfEnabled",null),(0,n._)([(0,l.MZ)({readOnly:!0})],u.prototype,"effectiveFeatureEnabled",null),(0,n._)([(0,l.MZ)({readOnly:!0})],u.prototype,"_effectiveFeatureSources",null),u=(0,n._)([(0,d.$)("esri.views.interactive.snapping.SnappingOptions")],u);const p=u;function f(e){return"subtype-group"===e.layer.type}function g(e){return"subtype-group"!==e.layer.type}function v(e){return"subtype-sublayer"===e.layer.type}},80794:(e,t,i)=>{i.d(t,{X:()=>a});var n=i(75543),r=i(70330),s=i(61751),o=i(23543);class a extends s.w{constructor(e){super({...e,isDraped:!0,constraint:new n.en(e.edgeStart,e.edgeEnd,e.getGroundElevation)})}get hints(){return[new o.c(r.H3.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}}},9876:(e,t,i)=>{i.d(t,{z:()=>a});var n=i(75543),r=i(70330),s=i(61751),o=i(23543);class a extends s.w{constructor(e){super({...e,constraint:new n.Mn(e.edgeStart,e.edgeEnd)})}get hints(){return[new o.c(r.H3.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}}},61751:(e,t,i)=>{i.d(t,{w:()=>s});var n=i(99791),r=i(30003);class s extends r.C{constructor(e){let{targetPoint:t,objectId:i,constraint:r,isDraped:s}=e;super(t,r,s,n.n.FEATURE),this.objectId=i}}},78228:(e,t,i)=>{i.d(t,{H:()=>c,p:()=>n});var n,r,s=i(99791),o=i(70330),a=i(30003),l=i(23543),d=i(56572);class c extends a.C{constructor(e){let{targetPoint:t,constraint:i,previousVertex:n,otherVertex:r,otherVertexType:o,objectId:a,isDraped:l}=e;super(t,i,l,s.n.SELF),this.previousVertex=n,this.otherVertex=r,this.otherVertexType=o,this.objectId=a}get hints(){const e=this.previousVertex,t=this.otherVertexType===n.CENTER?this.otherVertex:this.targetPoint,i=this.otherVertexType===n.CENTER?this.targetPoint:this.otherVertex;return[new l.c(o.H3.TARGET,t,i,this.isDraped,this.domain),new l.c(o.H3.REFERENCE,e,t,this.isDraped,this.domain),new d.l(this.previousVertex,t,i,this.isDraped,this.domain)]}}(r=n||(n={}))[r.NEXT=0]="NEXT",r[r.CENTER=1]="CENTER"},30003:(e,t,i)=>{i.d(t,{C:()=>n});class n{constructor(e,t,i,n){this.targetPoint=e,this.constraint=t,this.isDraped=i,this.domain=n}}},17072:(e,t,i)=>{i.d(t,{QO:()=>d,XG:()=>c,jq:()=>h});var n=i(76931),r=i(19555),s=i(20664),o=i(9392),a=i(18117),l=i(12482);function d(e,t,i,n){i.projectToRenderScreen(e,f),i.projectToRenderScreen(t,g),(0,r.Re)(n,g,f),(0,r.S8)(n,n)}function c(e,t,i,n){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:(0,o.vt)();const a=(0,s.c)(p,e);return a[2]=(0,l.xS)(n,a,t,i)||0,n.renderCoordsHelper.toRenderCoords(a,t,r),r}function h(e,t,i,r){return"2d"===r.type?(u.x=e[0],u.y=e[1],u.spatialReference=t,r.toScreen(u)):(c(e,t,i,r,p),r.state.camera.projectToScreen(p,v),(0,n.tc)(v[0],v[1]))}const u=(0,a.T)(0,0,0,null),p=(0,o.vt)(),f=(0,n.QG)(),g=(0,n.QG)(),v=(0,n.gs)()},92854:(e,t,i)=>{i.d(t,{n3:()=>v,Og:()=>g,mh:()=>f});i(35238);var n=i(24648),r=i(9392),s=i(63391),o=i(20664),a=i(482);const l=(0,r.vt)();var d=i(98799),c=i(7137),h=i(80963),u=i(90659),p=i(13312);function f(e){const{spatialReference:t}=e;return(0,u.M)(t,w,E,m,e)}function g(e,t){if(!(0,h.aI)(e.spatialReference,t.spatialReference))return null;const{spatialReference:i}=e;return T[0]=e.x,T[1]=e.y,T[2]=e.hasZ?e.z:0,M[0]=t.x,M[1]=t.y,M[2]=t.hasZ?t.z:0,v(T,M,i)}function v(e,t,i){return(0,u.M)(i,y,_,S,e,t,i)}function y(e,t,i){return(0,n.d_)((0,c._3)(x,e,t,i).distance,"meters")}function _(e,t,i){return(0,n.d_)((0,s.geodesicLength)(function(e,t,i){return{type:"polyline",spatialReference:i,paths:[[[...e],[...t]]]}}(e,t,i),"meters"),"meters")}function S(e,t,i){return(0,d.H)(e,i,P)&&(0,d.H)(t,i,C)?(0,n.d_)((0,c._3)(x,P,C,p.A.WGS84).distance,"meters"):null}function w(e){return(0,n.d_)((0,c.l1)([e],"meters")[0],"meters")}function E(e){return(0,n.d_)((0,s.geodesicLength)(e,"meters"),"meters")}function m(e){const t=[];if(!function(e,t){let{hasZ:i,spatialReference:n,paths:r}=e,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const d=(0,a.Yz)(n);if(null==d)return!1;const c=i?e=>e:e=>(0,o.s)(l,e[0],e[1],s);for(const o of r){const e=[];for(const t of o){const i=[0,0,s];d(c(t),0,i,0),e.push(i)}t.push(e)}return!0}(e,t))return null;let i=0;for(const n of t){let e=0;for(let t=1;t<n.length;++t)e+=(0,c._3)(x,n[t-1],n[t],p.A.WGS84).distance;i+=e}return(0,n.d_)(i,"meters")}const x=new c.Zj,T=(0,r.vt)(),M=(0,r.vt)(),P=(0,r.vt)(),C=(0,r.vt)()},90659:(e,t,i)=>{i.d(t,{M:()=>s,U:()=>o});var n=i(7137),r=i(80963);function s(e,t,i,s){for(var o=arguments.length,a=new Array(o>4?o-4:0),l=4;l<o;l++)a[l-4]=arguments[l];return(0,r.EA)(e)&&(0,n.TT)(e)?t.apply(void 0,a):(0,r.K8)(e)?i.apply(void 0,a):s.apply(void 0,a)}const o=1e5}}]);
//# sourceMappingURL=43184.e6946493.chunk.js.map