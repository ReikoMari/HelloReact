{"version":3,"file":"static/js/34209.97b97a01.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/views/3d/layers/ImageryLayerView3D.js","../node_modules/@arcgis/core/views/layers/ImageryLayerView.js","../node_modules/@arcgis/core/views/layers/support/popupUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.29/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import{debounce as a}from\"../../../core/promiseUtils.js\";import{when as t}from\"../../../core/reactiveUtils.js\";import\"../../../core/Logger.js\";import\"../../../core/has.js\";import\"../../../core/RandomLCG.js\";import\"../../../core/Error.js\";import{subclass as i}from\"../../../core/accessorSupport/decorators/subclass.js\";import r from\"./DynamicLayerView3D.js\";import s from\"../../layers/ImageryLayerView.js\";let n=class extends(s(r)){constructor(){super(...arguments),this.type=\"imagery-3d\",this.redrawDebounced=a((async e=>{this.redraw(((e,a)=>this._redrawImage(e,a)),e)}),2e3)}initialize(){this.addHandles([t((()=>this.view.basemapTerrain.ready),(()=>this._initializeMaximumDataResolution()),{once:!0,initial:!0}),this.layer.on(\"redraw\",(()=>this._updatingHandles.addPromise(this.redrawDebounced())))]),this._updatingHandles.add((()=>this.layer?.exportImageServiceParameters?.version),(()=>{this._updatingHandles.addPromise(this.refreshDebounced())})),this._updatingHandles.add((()=>this.layer?.renderer),(()=>{this._updatingHandles.addPromise(this.refreshDebounced())})),this._updatingHandles.add((()=>this.timeExtent),(()=>this._updatingHandles.addPromise(this.refreshDebounced())))}_initializeMaximumDataResolution(){this.maximumDataResolution=this.layer.loaded?this.layer.serviceRasterInfo.pixelSize:null}getFetchOptions(){return{timeExtent:this.timeExtent}}async processResult(e,a,t){a.imageOrCanvasElement?e.image=a.imageOrCanvasElement:(e.image=document.createElement(\"canvas\"),e.pixelData=a.pixelData,await this._redrawImage(e,t))}async _redrawImage(e,a){if(!(e.image instanceof HTMLCanvasElement)||null==e.pixelData)throw new Error;const t=e.image,i=t.getContext(\"2d\"),r=await this.layer.applyRenderer(e.pixelData,{signal:a}),s=this.layer.applyFilter(r).pixelBlock;if(null==s)throw new Error;t.width=s.width,t.height=s.height;const n=i.createImageData(s.width,s.height);n.data.set(s.getAsRGBA()),i.putImageData(n,0,0)}};n=e([i(\"esri.views.3d.layers.ImageryLayerView3D\")],n);const o=n;export{o as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.29/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import t from\"../../core/Error.js\";import{throwIfAborted as r}from\"../../core/promiseUtils.js\";import{property as o}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as s}from\"../../core/accessorSupport/decorators/subclass.js\";import p from\"../../geometry/Point.js\";import{combinedViewLayerTimeExtentProperty as i}from\"../../layers/support/commonProperties.js\";import a from\"../../rest/support/Query.js\";import{getFetchPopupTemplate as n}from\"./support/popupUtils.js\";const u=u=>{let m=class extends u{constructor(){super(...arguments),this.view=null}async fetchPopupFeaturesAtLocation(e,o){const{layer:s}=this;if(!e)throw new t(\"imagerylayerview:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:s});const{popupEnabled:i}=s,u=n(s,o);if(!i||null==u)throw new t(\"imagerylayerview:fetchPopupFeatures\",\"Missing required popupTemplate or popupEnabled\",{popupEnabled:i,popupTemplate:u});const m=await u.getRequiredFields();r(o);const c=new a;c.timeExtent=this.timeExtent,c.geometry=e,c.outFields=m,c.outSpatialReference=e.spatialReference;const{resolution:l,spatialReference:y}=this.view,d=\"2d\"===this.view.type?new p(l,l,y):new p(.5*l,.5*l,y),{returnTopmostRaster:h,showNoDataRecords:w}=u.layerOptions||{returnTopmostRaster:!0,showNoDataRecords:!1},f={returnDomainValues:!0,returnTopmostRaster:h,pixelSize:d,showNoDataRecords:w,signal:o?.signal};return s.queryVisibleRasters(c,f).then((e=>e))}canResume(){return!!super.canResume()&&!this.timeExtent?.isEmpty}};return e([o()],m.prototype,\"layer\",void 0),e([o()],m.prototype,\"suspended\",void 0),e([o(i)],m.prototype,\"timeExtent\",void 0),e([o()],m.prototype,\"view\",void 0),m=e([s(\"esri.views.layers.ImageryLayerView\")],m),m};export{u as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.29/esri/copyright.txt for details.\n*/\nimport{getFeatureEditFields as e,fixFields as l}from\"../../../layers/support/fieldUtils.js\";async function n(n,p=n.popupTemplate){if(null==p)return[];const u=await p.getRequiredFields(n.fieldsIndex),{lastEditInfoEnabled:t}=p,{objectIdField:d,typeIdField:s,globalIdField:i,relationships:a}=n;if(u.includes(\"*\"))return[\"*\"];const o=t?e(n):[],f=l(n.fieldsIndex,[...u,...o]);return s&&f.push(s),f&&d&&n.fieldsIndex?.has(d)&&!f.includes(d)&&f.push(d),f&&i&&n.fieldsIndex?.has(i)&&!f.includes(i)&&f.push(i),a&&a.forEach((e=>{const{keyField:l}=e;f&&l&&n.fieldsIndex?.has(l)&&!f.includes(l)&&f.push(l)})),f}function p(e,l){return e.popupTemplate?e.popupTemplate:null!=l&&l.defaultPopupTemplateEnabled&&null!=e.defaultPopupTemplate?e.defaultPopupTemplate:null}function u(e,l){return null!=p(e,{defaultPopupTemplateEnabled:l})}export{p as getFetchPopupTemplate,n as getRequiredFields,u as hasPopupTemplate};\n"],"names":["n","s","r","constructor","super","arguments","this","type","redrawDebounced","a","async","redraw","e","_redrawImage","initialize","addHandles","t","view","basemapTerrain","ready","_initializeMaximumDataResolution","once","initial","layer","on","_updatingHandles","addPromise","add","_this$layer","exportImageServiceParameters","version","refreshDebounced","_this$layer2","renderer","timeExtent","maximumDataResolution","loaded","serviceRasterInfo","pixelSize","getFetchOptions","processResult","imageOrCanvasElement","image","document","createElement","pixelData","HTMLCanvasElement","Error","i","getContext","applyRenderer","signal","applyFilter","pixelBlock","width","height","createImageData","data","set","getAsRGBA","putImageData","o","u","m","fetchPopupFeaturesAtLocation","popupEnabled","popupTemplate","getRequiredFields","c","geometry","outFields","outSpatialReference","spatialReference","resolution","l","y","d","p","returnTopmostRaster","h","showNoDataRecords","w","layerOptions","f","returnDomainValues","queryVisibleRasters","then","canResume","_this$timeExtent","isEmpty","prototype","_n$fieldsIndex","_n$fieldsIndex2","length","undefined","fieldsIndex","lastEditInfoEnabled","objectIdField","typeIdField","globalIdField","relationships","includes","push","has","forEach","_n$fieldsIndex3","keyField","defaultPopupTemplateEnabled","defaultPopupTemplate"],"sourceRoot":""}