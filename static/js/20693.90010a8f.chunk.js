"use strict";(self.webpackChunkhelloworld=self.webpackChunkhelloworld||[]).push([[20693],{55877:(e,t,i)=>{var n;i.d(t,{u:()=>n}),function(e){e[e.KILOBYTES=1024]="KILOBYTES",e[e.MEGABYTES=1048576]="MEGABYTES",e[e.GIGABYTES=1073741824]="GIGABYTES"}(n||(n={}))},56002:(e,t,i)=>{function n(e){let t,i,n=[],s=!1;return function(){for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return s&&t===this&&function(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(e[i]!==t[i])return!1;return!0}(o,n)||(i=e.apply(this,o),t=this,n=o,s=!0),i}}i.d(t,{B:()=>n})},79468:(e,t,i)=>{function n(e,t,i,n){let s=null,r=1e3;"number"==typeof t?(r=t,n=i):(s=null!==t&&void 0!==t?t:null,r=i);let o,l=0;const a=()=>{l=0,e.apply(n,o)},c=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];s&&s.apply(n,t),o=t,r?l||(l=setTimeout(a,r)):a()};return c.remove=()=>{l&&(clearTimeout(l),l=0)},c.forceUpdate=()=>{l&&(clearTimeout(l),a())},c.hasPendingUpdates=()=>!!l,c}i.d(t,{n:()=>n})},96820:(e,t,i)=>{i.d(t,{Cq:()=>u,Ee:()=>p,J1:()=>f,LF:()=>b,Me:()=>S,Mm:()=>_,Sz:()=>w,W4:()=>v,cs:()=>C,e_:()=>g,nD:()=>d,t_:()=>y,tr:()=>m,v7:()=>P,zJ:()=>h,zq:()=>E});var n=i(55877),s=i(73582),r=i(15941),o=i(24648),l=i(88685),a=i(31633),c=i(50265);function u(e,t,i){return e.units[t][i]}function h(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";return"".concat((0,c.ZV)(t,{minimumFractionDigits:n,maximumFractionDigits:n,signDisplay:t>0?"never":"exceptZero"})," ").concat(u(e,i,s))}function d(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";return"".concat((0,c.ZV)(t,{minimumFractionDigits:n,maximumFractionDigits:n,signDisplay:"exceptZero"})," ").concat(u(e,i,s))}function p(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const r=(0,a.x0)(t,i);return h(e,(0,a.oU)(t,i,r),r,n,s)}function _(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const r=(0,a.x0)(t,i);return d(e,(0,a.oU)(t,i,r),r,n,s)}function v(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const r=(0,a.x$)(t,i);return h(e,(0,a.oU)(t,i,r),r,n,s)}function g(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const r=(0,a.x$)(t,i);return d(e,(0,a.oU)(t,i,r),r,n,s)}function m(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const r=(0,a.OU)(t,i);return h(e,(0,a.oU)(t,i,r),r,n,s)}function f(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const r=(0,a.OU)(t,i);return d(e,(0,a.oU)(t,i,r),r,n,s)}function y(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const r=(0,a.y7)(t,i);return h(e,(0,a.oU)(t,i,r),r,n,s)}function b(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const r=(0,a.y7)(t,i);return d(e,(0,a.oU)(t,i,r),r,n,s)}function E(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const r=(0,a.wv)(t,i);return h(e,(0,a.oU)(t,i,r),r,n,s)}function w(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const r=(0,a.TL)(t,i);return h(e,(0,a.oU)(t,i,r),r,n,s)}function S(e,t,i,n,r){var l;r=null!==(l=r)&&void 0!==l?l:2;let u=s.ie.normalize((0,o.g2)((0,a.oU)(e,t,"degrees"),i,n),0,!0);const h={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:r,minimumFractionDigits:r,signDisplay:u>0?"never":"exceptZero"};return u=I(u,h),(0,c.ZV)(u,h)}function C(e,t,i,n,s){var r;i!==n&&(e=-e);const o={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:s=null!==(r=s)&&void 0!==r?r:2,minimumFractionDigits:s,signDisplay:"exceptZero"};let l=(0,a.oU)(e,t,"degrees")%360;return l=I(l,o),(0,c.ZV)(l,o)}const M=new Map;function I(e,t){const i=JSON.stringify(t);let n=M.get(i);return n||(n=new Intl.NumberFormat("en-US",t),M.set(i,n)),/\-?\+?360/.test(n.format(e))?0:e}const T=["B","kB","MB","GB","TB"];function P(e,t){let i=0===(t=Math.round(t))?0:Math.floor(Math.log(t)/Math.log(n.u.KILOBYTES));i=(0,r.qE)(i,0,T.length-1);const s=(0,c.ZV)(t/n.u.KILOBYTES**i,{maximumFractionDigits:2});return(0,l.HC)(e.units.bytes[T[i]],{fileSize:s})}},3569:(e,t,i)=>{i.d(t,{r:()=>n});const n="OBJECTID"},71630:(e,t,i)=>{i.d(t,{E:()=>n});class n{constructor(e){this._store=e}destroy(){this._store.destroy()}get(e){return this._store.get(e)}put(e,t){this._store.put(e,t,t.values.byteLength+256)}}},8203:(e,t,i)=>{i.d(t,{A:()=>g});var n,s=i(35143),r=i(35238),o=i(82111),l=i(45802),a=i(42553),c=i(53084),u=i(46053),h=(i(81806),i(76460),i(85842)),d=i(68295);const p=new l.J({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),_=new l.J({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let v=n=class extends a.oY{constructor(e){super(e),this.where=null,this.geometry=null,this.spatialRelationship="intersects",this.distance=void 0,this.objectIds=null,this.units=null,this.timeExtent=null}createQuery(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{where:t,geometry:i,spatialRelationship:n,timeExtent:s,objectIds:r,units:o,distance:l}=this;return new d.A({geometry:(0,c.o8)(i),objectIds:(0,c.o8)(r),spatialRelationship:n,timeExtent:(0,c.o8)(s),where:t,units:o,distance:l,...e})}clone(){const{where:e,geometry:t,spatialRelationship:i,timeExtent:s,objectIds:r,units:o,distance:l}=this;return new n({geometry:(0,c.o8)(t),objectIds:(0,c.o8)(r),spatialRelationship:i,timeExtent:(0,c.o8)(s),where:e,units:o,distance:l})}};(0,s._)([(0,u.MZ)({type:String,json:{write:!0}})],v.prototype,"where",void 0),(0,s._)([(0,u.MZ)({types:r.yR,json:{write:!0}})],v.prototype,"geometry",void 0),(0,s._)([(0,u.MZ)({type:p.apiValues,json:{name:"spatialRel",read:{reader:p.read},write:{allowNull:!1,writer:p.write,overridePolicy(){return{enabled:null!=this.geometry}}}}})],v.prototype,"spatialRelationship",void 0),(0,s._)([(0,u.MZ)({type:Number,json:{write:{overridePolicy(e){return{enabled:null!=e&&null!=this.geometry}}}}})],v.prototype,"distance",void 0),(0,s._)([(0,u.MZ)({type:[Number],json:{write:!0}})],v.prototype,"objectIds",void 0),(0,s._)([(0,u.MZ)({type:_.apiValues,json:{read:_.read,write:{writer:_.write,overridePolicy(e){return{enabled:null!=e&&null!=this.geometry}}}}})],v.prototype,"units",void 0),(0,s._)([(0,u.MZ)({type:o.A,json:{write:!0}})],v.prototype,"timeExtent",void 0),v=n=(0,s._)([(0,h.$)("esri.layers.support.FeatureFilter")],v);const g=v},84031:(e,t,i)=>{i.d(t,{T:()=>o});var n=i(50346),s=i(75540),r=i(22856);class o{constructor(){this._tasks=new Array,this._runningTasks=(0,s.v)(0)}get length(){return this._tasks.length}get running(){return this._runningTasks.value>0}destroy(){this.cancelAll()}runTask(e){if(0===this.length)return r.G;for(;!e.done&&this._process(e);)e.madeProgress()}push(e,t,i){return++this._runningTasks.value,new Promise(((n,s)=>this._tasks.push(new l(n,s,e,t,i)))).finally((()=>--this._runningTasks.value))}unshift(e,t,i){return++this._runningTasks.value,new Promise(((n,s)=>this._tasks.unshift(new l(n,s,e,t,i)))).finally((()=>--this._runningTasks.value))}_process(e){if(0===this._tasks.length)return!1;const t=this._tasks.shift();try{const s=(0,n.G4)(t.signal);if(s&&!t.abortCallback)t.reject((0,n.NK)());else{var i;const r=s?null===(i=t.abortCallback)||void 0===i?void 0:i.call(t,(0,n.NK)()):t.callback(e);(0,n.$X)(r)?r.then(t.resolve,t.reject):t.resolve(r)}}catch(o){t.reject(o)}return!0}cancelAll(){const e=(0,n.NK)();for(const t of this._tasks)if(t.abortCallback){const i=t.abortCallback(e);t.resolve(i)}else t.reject(e);this._tasks.length=0}}class l{constructor(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;this.resolve=e,this.reject=t,this.callback=i,this.signal=n,this.abortCallback=s}}},45270:(e,t,i)=>{i.d(t,{Aw:()=>c,Jb:()=>a,Q5:()=>d,W3:()=>p,d:()=>o,db:()=>h,kV:()=>u,rb:()=>l});var n=i(3112),s=i(35737),r=i(46571);class o extends s.R6{constructor(e,t,i,n){super(t,i),this.point=e,this.createGraphic=n}}function l(e){return(0,r.i3)(e)&&e.intersector===n.dz.PCL&&!!e.target}class a extends s.HE{constructor(e,t,i,n,s){super(e),this.layerUid=e,this.sublayerUid=t,this.nodeIndex=i,this.componentIndex=n,this.triangleNr=s}}class c extends s.R6{constructor(e,t,i){super(t,null),this.point=e,this.createVoxelGraphic=i}}class u extends s.R6{constructor(e,t){super(e,null),this.createTiles3DGraphic=t}}function h(e){return(0,r.i3)(e)&&e.intersector===n.dz.I3S&&!!e.target}function d(e){return(0,r.i3)(e)&&e.intersector===n.dz.VOXEL&&!!e.target}function p(e){return(0,r.i3)(e)&&e.intersector===n.dz.TILES3D&&!!e.target}},88220:(e,t,i)=>{i.d(t,{CB:()=>y,ZD:()=>M,av:()=>b,zC:()=>C});i(35238);var n=i(39356),s=i(85361),r=i(76931),o=i(9392),l=i(14487),a=i(3569),c=i(31933),u=i(22955),h=i(80935),d=i(29808),p=i(3112),_=i(46571),v=i(30310),g=i(97974),m=i(13312),f=i(13904);async function y(e,t,i,n){const s=i?M(e,i):n,o=(0,r.gs)(t.x,t.y);s.requiresGroundFeedback=!0,s.enableDraped=!0;const l=(0,d.hz)(e.state.viewingMode);l.options.selectionMode=!0,l.options.store=p.oH.ALL,e.sceneIntersectionHelper.intersectIntersectorScreen(o,l,s);const a=function(e,t,i){const n=new Array;let s=null;for(let r=0;r<t.length;r++){const o=t[r],l=(0,v.FV)(o,e);if(null!=l&&(l===e.map.ground||"type"in l&&(0,c.Eq)(l.type)))break;const a=(0,v.FI)(o,e);if(null==a)continue;if("graphic"===a.type){if(null==s&&r!==t.length-1&&(s=new Set),null!=s){const e=w(a.graphic);if(s.has(e))continue;s.add(e)}if(!S(i,a.graphic))continue}const u=E(e,o),h=o.distanceInRenderSpace;if("media"===a.type){const e=a.element.toSource(u);n.push({...a,mapPoint:u,distance:h,sourcePoint:e})}else n.push({...a,mapPoint:u,distance:h})}return n}(e,l.results.all,s.graphics),h=l.results.ground,g=(0,v.FV)(h,e),m=null!=g&&"type"in g&&(0,c.Eq)(g.type)?g:null,f={screenPoint:t,results:a,ground:{mapPoint:E(e,h),distance:(0,_.i3)(h)?h.distanceInRenderSpace:0,layer:m}};return u.b.SCENEVIEW_HITTEST_RETURN_INTERSECTOR&&(f.intersector=l),f}function b(e,t,i,n){const s=i?M(e,i):n,o=null!=s.graphics&&(null!=s.graphics.include||null!=s.graphics.exclude),l=(0,r.WA)(t);s.enableDraped=s.include&&!s.include.has(g.fo)||s.exclude&&s.exclude.has(g.fo);const a=e.sceneIntersectionHelper,c=(0,d.hz)(e.state.viewingMode);if(c.options.selectionMode=!0,c.options.store=o?p.oH.ALL:p.oH.MIN,c.options.hud=!(null!==i&&void 0!==i&&i.excludeHud),a.intersectIntersectorScreen(l,c,s),o){for(const t of c.results.all){const i=(0,v.FI)(t,e);if(null==i)return E(e,t);if("graphic"!==i.type||S(s.graphics,i.graphic))return E(e,t)}return null}return E(e,c.results.min)}function E(e,t,i){var n;return t.getIntersectionPoint(P)?(i=C(e,P,i),t.intersector===p.dz.TERRAIN&&e.basemapTerrain&&(i.z=null!==(n=(0,h.R1)(e.basemapTerrain,i))&&void 0!==n?n:0),i):null}function w(e){const t=e.sourceLayer,i=e.layer,n=t&&"objectIdField"in t?t:i&&"objectIdField"in i?i:t;if(n){var s,r;const t=null!==(s=n.objectIdField)&&void 0!==s?s:a.r,i=null===(r=e.attributes)||void 0===r?void 0:r[t];if(i)return"o-".concat(n.id,"-").concat(i)}return"u-".concat(e.uid)}function S(e,t){const i=w(t);return null==e||(null==e.include||e.include.has(i))&&(null==e.exclude||!e.exclude.has(i))}function C(e,t,i){let n=e.spatialReference||m.A.WGS84;return(0,l.F)(t,e.renderSpatialReference,P,n)?t=P:(n=m.A.WGS84,(0,l.F)(t,e.renderSpatialReference,P,n)&&(t=P)),i?(i.x=t[0],i.y=t[1],i.z=t[2],i.spatialReference=n):i=new f.A(t,n),i}function M(e,t){const i=I(e,t.include,R.INCLUDE),n=I(e,t.exclude,R.EXCLUDE);return{include:i.layerUids,exclude:n.layerUids,graphics:{include:i.graphicUids,exclude:n.graphicUids}}}function I(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{layerUids:void 0,graphicUids:void 0};if(!t)return r;if(t instanceof n.A)o=r,l=w(t),o.graphicUids||(o.graphicUids=new Set),o.graphicUids.add(l),i===R.INCLUDE&&(null!=e.graphicsView&&t.layer===e?T(r,e.graphicsView.processor.layer.id):t.layer&&T(r,t.layer.uid));else if((0,s.xZ)(t))for(const n of t)n===e.graphics&&null!=e.graphicsView?T(r,e.graphicsView.processor.layer.id):n===e.map.ground?T(r,g.fo):I(e,n,i,r);else"uid"in t&&T(r,t.uid);var o,l;return r}function T(e,t){e.layerUids||(e.layerUids=new Set),e.layerUids.add(t)}const P=(0,o.vt)();var R,k;(k=R||(R={}))[k.INCLUDE=0]="INCLUDE",k[k.EXCLUDE=1]="EXCLUDE"},30310:(e,t,i)=>{i.d(t,{FI:()=>p,FV:()=>h,Gy:()=>d,QS:()=>m,SM:()=>g});var n=i(34761),s=i(9392),r=i(42294),o=i(93582),l=i(45270),a=i(21255),c=i(46571),u=i(71488);function h(e,t){var i,n;return(0,c.$I)(e)||(0,c.hH)(e)?v(null===(i=e.target)||void 0===i?void 0:i.object,t):(0,a.DC)(e)?null===(n=t.map)||void 0===n?void 0:n.ground:(0,l.rb)(e)||(0,l.db)(e)||(0,a.mi)(e)||(0,l.Q5)(e)?v(e.target,t):null}function d(e,t){const i=p(e,t);return null!=i&&"graphic"===i.type?i.graphic:null}function p(e,t){var i;if(null==e)return null;if((0,c.$I)(e)||(0,c.hH)(e))return _(null===(i=e.target)||void 0===i?void 0:i.object,t);if((0,l.rb)(e)){const t=e.target.createGraphic();return{type:"graphic",graphic:t,layer:t.layer}}if((0,l.Q5)(e)){const t=e.target.createVoxelGraphic();return{type:"graphic",graphic:t,layer:t.layer}}if((0,l.W3)(e)){const t=e.target.createTiles3DGraphic();return{type:"graphic",graphic:t,layer:t.layer}}return(0,a.mi)(e)||(0,u.H)(e)?_(e.target,t):(0,l.db)(e)?function(e,t){const i=v(e,t);if(null==i)return null;const n=t.allLayerViews.find((e=>e.layer===i));return n&&!n.suspended&&"getGraphicFromIntersectorTarget"in n?function(e){return null!=e?{type:"graphic",graphic:e,layer:e.layer}:null}(n.getGraphicFromIntersectorTarget(e)):null}(e.target,t):null}function _(e,t){if(null==(null===e||void 0===e?void 0:e.graphicUid))return null;const i=v(e,t);if(null==i)return null;if(i===t.graphics)return null==t.graphicsView||"number"!=typeof e.graphicUid?null:t.graphicsView.getHit(e.graphicUid);const n=t.allLayerViews.find((e=>e.layer===i));return!n||n.suspended||null==e.graphicUid?null:"getHit"in n?n.getHit(e.graphicUid):null}function v(e,t){return null==(null===e||void 0===e?void 0:e.layerUid)?null:null!=t.graphicsView&&e.layerUid===t.graphicsView.processor.layer.id?t.graphics:t.map.allLayers.find((t=>t.uid===e.layerUid))}function g(e,t){if((0,c.$I)(e)||(0,c.hH)(e))return(0,o.b)(e.target.object.boundingVolumeWorldSpace.bounds);if((0,u.H)(e)){(0,n.IL)(f,e.transformation);const t=Math.max(f[0],f[1],f[2]);return e.target.baseBoundingSphere.radius*t}if((0,l.db)(e)){const i=function(e,t){const i=v(e,t);if(null==i)return null;const n=t.allLayerViews.find((e=>e.layer===i));return n&&!n.suspended&&"getAABBFromIntersectorTarget"in n?n.getAABBFromIntersectorTarget(e):null}(e.target,t);return i?.5*(0,r._F)(i):null}return null}function m(e){return!(0,c.$I)(e)&&!(0,c.hH)(e)&&((0,u.H)(e)?e.target.numLodLevels>1:!!(0,l.db)(e))}const f=(0,s.vt)()},71488:(e,t,i)=>{i.d(t,{H:()=>l,h:()=>o});var n=i(3112),s=i(35737),r=i(46571);class o extends s.R6{constructor(e,t,i,n,s,r){super(e,t),this.layerUid=e,this.graphicUid=t,this.geometryId=i,this.triangleNr=n,this.baseBoundingSphere=s,this.numLodLevels=r}}function l(e){return(0,r.i3)(e)&&e.intersector===n.dz.LOD&&!!e.target}},98476:(e,t,i)=>{var n;i.d(t,{M:()=>n}),function(e){e[e.ANIMATING=0]="ANIMATING",e[e.INTERACTING=1]="INTERACTING",e[e.IDLE=2]="IDLE"}(n||(n={}))},59752:(e,t,i)=>{i.d(t,{Bb:()=>P,W6:()=>n,mj:()=>f,nu:()=>R});var n,s,r=i(88321),o=(i(81806),i(76460)),l=i(30726),a=i(32634),c=i(30015),u=i(50346),h=i(68134),d=i(75540),p=i(91417),_=i(84031),v=i(5551),g=i(98476),m=i(22856);function f(){return new I.Scheduler}(s=n||(n={})).RESOURCE_CONTROLLER_IMMEDIATE="immediate",s.RESOURCE_CONTROLLER="schedule",s.SLIDE="slide",s.STREAM_DATA_LOADER="stream loader",s.ELEVATION_QUERY="elevation query",s.TERRAIN_SURFACE="terrain",s.SURFACE_GEOMETRY_UPDATES="surface geometry updates",s.LOD_RENDERER="LoD renderer",s.GRAPHICS_CORE="Graphics3D",s.I3S_CONTROLLER="I3S",s.POINT_CLOUD_LAYER="point cloud",s.FEATURE_TILE_FETCHER="feature fetcher",s.OVERLAY="overlay",s.STAGE="stage",s.GRAPHICS_DECONFLICTOR="graphics deconflictor",s.FILTER_VISIBILITY="Graphics3D filter visibility",s.SCALE_VISIBILITY="Graphics3D scale visibility",s.FRUSTUM_VISIBILITY="Graphics3D frustum visibility",s.POINT_OF_INTEREST_FREQUENT="POI frequent",s.POINT_OF_INTEREST_INFREQUENT="POI infrequent",s.LABELER="labeler",s.FEATURE_QUERY_ENGINE="feature query",s.FEATURE_TILE_TREE="feature tile tree",s.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree",s.ELEVATION_ALIGNMENT="elevation alignment",s.ELEVATION_ALIGNMENT_SCENE="elevation alignment scene",s.TEXT_TEXTURE_ATLAS="text texture atlas",s.TEXTURE_UNLOAD="texture unload",s.LINE_OF_SIGHT_TOOL="line of sight tool",s.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool",s.ELEVATION_PROFILE="elevation profile",s.SNAPPING="snapping",s.SHADOW_ACCUMULATOR="shadow accumulator",s.CLOUDS_GENERATOR="clouds generator",s[s.NONE=0]="NONE",s[s.TEST_PRIO=1]="TEST_PRIO";const y=new Map([[n.RESOURCE_CONTROLLER_IMMEDIATE,0],[n.RESOURCE_CONTROLLER,4],[n.SLIDE,0],[n.STREAM_DATA_LOADER,0],[n.ELEVATION_QUERY,0],[n.TERRAIN_SURFACE,1],[n.SURFACE_GEOMETRY_UPDATES,1],[n.LOD_RENDERER,2],[n.GRAPHICS_CORE,2],[n.I3S_CONTROLLER,2],[n.POINT_CLOUD_LAYER,2],[n.FEATURE_TILE_FETCHER,2],[n.OVERLAY,4],[n.STAGE,4],[n.GRAPHICS_DECONFLICTOR,4],[n.FILTER_VISIBILITY,4],[n.SCALE_VISIBILITY,4],[n.FRUSTUM_VISIBILITY,4],[n.CLOUDS_GENERATOR,4],[n.POINT_OF_INTEREST_FREQUENT,6],[n.POINT_OF_INTEREST_INFREQUENT,30],[n.LABELER,8],[n.FEATURE_QUERY_ENGINE,8],[n.FEATURE_TILE_TREE,16],[n.FEATURE_TILE_TREE_ACTIVE,0],[n.ELEVATION_ALIGNMENT,12],[n.ELEVATION_ALIGNMENT_SCENE,14],[n.TEXT_TEXTURE_ATLAS,12],[n.TEXTURE_UNLOAD,12],[n.LINE_OF_SIGHT_TOOL,16],[n.LINE_OF_SIGHT_TOOL_INTERACTIVE,0],[n.SNAPPING,0],[n.SHADOW_ACCUMULATOR,30]]);function b(e){return y.has(e)?y.get(e):"number"==typeof e?e:1}const E=(0,p.l5)(6.5),w=(0,p.l5)(1),S=(0,p.l5)(30),C=(0,p.l5)(1e3/30),M=(0,p.l5)(100);var I,T;!function(e){e.Scheduler=class{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some((e=>e.needsUpdate))}constructor(){this._updating=(0,d.v)(!0),this._microTaskQueued=!1,this._frameNumber=0,this.performanceInfo={total:new a.A("total"),tasks:new Map},this._frameTaskTimes=new Map,this._budget=new i,this._state=g.M.INTERACTING,this._tasks=new c.A,this._runQueue=new c.A,this._load=0,this._idleStateCallbacks=new c.A,this._idleUpdatesStartFired=!1,this._forceTask=!1,this._debug=!1,this._debugHandle=(0,h.watch)((()=>v.A.SCHEDULER_LOG_SLOW_TASKS),(e=>this._debug=e),h.initial);for(const t of Object.keys(n))this.performanceInfo.tasks.set(n[t],new a.A(n[t]));const e=this;this._test={FRAME_SAFETY_BUDGET:E,INTERACTING_BUDGET:C,IDLE_BUDGET:M,get availableBudget(){return e._budget.budget},usedBudget:0,getBudget:()=>e._budget,setBudget:t=>e._budget=t,updateTask:e=>this._updateTask(e),getState:e=>this._getState(e),getRuntime:e=>this._getRuntime(e),frameTaskTimes:this._frameTaskTimes,resetRuntimes:()=>this._resetRuntimes(),getRunning:()=>this._getRunning()}}destroy(){this._tasks.toArray().forEach((e=>e.remove())),this._tasks.clear(),(0,l.xt)(this._debugHandle),this._microTaskQueued=!1,this._updatingChanged()}taskRunningChanged(e){this._updatingChanged(),e&&this._budget.remaining>0&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask((()=>{this._microTaskQueued&&(this._microTaskQueued=!1,this._budget.remaining>0&&this._schedule()&&this.frame())})))}registerTask(e,i){const n=new t(this,e,i);return this._tasks.push(n),this._updatingChanged(),this.performanceInfo.tasks.has(e)||this.performanceInfo.tasks.set(e,new a.A(e)),n}registerIdleStateCallbacks(e,t){const i={idleBegin:e,idleEnd:t};this._idleStateCallbacks.push(i),this.state===g.M.IDLE&&this._idleUpdatesStartFired&&i.idleBegin();const n=this;return{remove:()=>this._removeIdleStateCallbacks(i),set idleBegin(e){n._idleUpdatesStartFired&&(i.idleEnd(),n._state===g.M.IDLE&&e()),i.idleBegin=e},set idleEnd(e){i.idleEnd=e}}}get load(){return this._load}set state(e){this._state!==e&&(this._state=e,this.state!==g.M.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll((e=>e.idleEnd()))))}get state(){return this._state}updateBudget(e){this._test.usedBudget=0,++this._frameNumber;let t=E,i=e.frameDuration,n=w;switch(this.state){case g.M.IDLE:t=(0,p.l5)(0),i=(0,p.l5)(Math.max(M,e.frameDuration)),n=S;break;case g.M.INTERACTING:i=(0,p.l5)(Math.max(C,e.frameDuration));case g.M.ANIMATING:}return i=(0,p.l5)(i-e.elapsedFrameTime-t),this.state!==g.M.IDLE&&i<w&&!this._forceTask?(this._forceTask=!0,!1):(i=(0,p.l5)(Math.max(i,n)),this._budget.reset(i,this.state),this._updateLoad(),this._schedule())}frame(){switch(this._forceTask=!1,this._microTaskQueued=!1,this.state){case g.M.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll((e=>e.idleBegin()))),this._runIdle();break;case g.M.INTERACTING:this._runInteracting();break;default:this._runAnimating()}this._test.usedBudget=this._budget.elapsed}stopFrame(){this._budget.reset((0,p.l5)(0),this._state),this._budget.madeProgress()}_removeIdleStateCallbacks(e){this._idleUpdatesStartFired&&e.idleEnd(),this._idleStateCallbacks.removeUnordered(e)}removeTask(e){this._tasks.removeUnordered(e),this._runQueue.removeUnordered(e),this._updatingChanged()}_updateTask(e){this._tasks.forAll((t=>{t.name===e&&t.setPriority(e)}))}_getState(e){if(this._runQueue.some((t=>t.name===e)))return T.SCHEDULED;let t=T.IDLE;return this._tasks.forAll((i=>{i.name===e&&i.needsUpdate&&(i.schedulePriority<=1?t=T.READY:t!==T.READY&&(t=T.WAITING))})),t}_getRuntime(e){let t=0;return this._tasks.forAll((i=>{i.name===e&&(t+=i.runtime)})),t}_resetRuntimes(){this._tasks.forAll((e=>e.runtime=0))}_getRunning(){const e=new Map;if(this._tasks.forAll((t=>{t.needsUpdate&&e.set(t.name,(e.get(t.name)||0)+1)})),0===e.size)return null;let t="";return e.forEach(((e,i)=>{t+=e>1?" ".concat(e,"x ").concat(i):" ".concat(i)})),t}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const e=this._tasks.reduce(((e,t)=>t.needsUpdate?++e:e),0);this._load=.9*this._load+e*(1-.9)}_schedule(){for(this._runQueue.filterInPlace((e=>!!e.needsUpdate||(e.schedulePriority=e.basePriority,!1))),this._tasks.forAll((e=>{0===e.basePriority&&e.needsUpdate&&!this._runQueue.includes(e)&&e.blockFrame!==this._frameNumber&&this._runQueue.unshift(e)}));0===this._runQueue.length;){let e=!1,t=0;if(this._tasks.forAll((i=>{i.needsUpdate&&0!==i.schedulePriority&&0!==i.basePriority&&i.blockFrame!==this._frameNumber&&(e=!0,t=Math.max(t,i.basePriority),1===i.schedulePriority?(i.schedulePriority=0,this._runQueue.push(i)):--i.schedulePriority)})),!e)return this._updatingChanged(),!1}return this._updatingChanged(),!0}_run(){const e=this._budget.now();this._startFrameTaskTimes();do{for(;this._runQueue.length>0;){const i=this._budget.now(),s=this._runQueue.pop();this._budget.resetProgress();try{s.task.runTask(this._budget)===m.G&&(s.blockFrame=this._frameNumber)}catch(t){o.A.getLogger("esri.views.support.Scheduler").error('Exception in task "'.concat(s.name,'"'),t),s.blockFrame=this._frameNumber}!this._budget.hasProgressed&&s.blockFrame!==this._frameNumber&&s.needsUpdate&&(s.name,n.I3S_CONTROLLER,s.blockFrame=this._frameNumber),s.schedulePriority=s.basePriority;const r=this._budget.now()-i;if(s.runtime+=r,this._frameTaskTimes.set(s.priority,this._frameTaskTimes.get(s.priority)+r),this._debug&&r>2*this._budget.budget&&console.log("Task",s.name,"used",r,"of max",this._budget.budget,"ms"),this._budget.remaining<=0)return this._updatingChanged(),void this._recordFrameTaskTimes(this._budget.now()-e)}}while(this._schedule());this._updatingChanged(),this._recordFrameTaskTimes(this._budget.now()-e)}_startFrameTaskTimes(){for(const e of Object.keys(n))this._frameTaskTimes.set(n[e],0)}_recordFrameTaskTimes(e){this._frameTaskTimes.forEach(((e,t)=>this.performanceInfo.tasks.get(t).record(e))),this.performanceInfo.total.record(e)}get test(){return this._test}};class t{get task(){return this._task.value}get updating(){return this._queue.running}constructor(e,t,i){this._scheduler=e,this.name=t,this.blockFrame=0,this.runtime=0,this._queue=new _.T,this._handles=new r.A,this._basePriority=b(t),this.schedulePriority=this._basePriority,this._task=(0,d.v)(null!=i?i:this._queue),this._handles.add((0,h.when)((()=>this.task.running),(t=>e.taskRunningChanged(t))))}remove(){this.processQueue(P),this._scheduler.removeTask(this),this.schedule=R.schedule,this.reschedule=R.reschedule,this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(e){if(this.name===e)return;this.name=e;const t=b(e);0!==this._basePriority&&0===this.schedulePriority||(this.schedulePriority=t),this._basePriority=t}get priority(){return this.name}set priority(e){this.setPriority(e)}get needsUpdate(){return this.updating||this.task.running}schedule(e,t,i){return this._queue.push(e,t,i)}reschedule(e,t,i){return this._queue.unshift(e,t,i)}processQueue(e){return this._queue.runTask(e)}}class i{constructor(){this._begin="undefined"!=typeof performance?performance.now():0,this._budget=0,this._state=g.M.IDLE,this._done=!1,this._progressed=!1,this._enabled=!0}run(e){return!this.done&&(!0===e()&&this.madeProgress(),!0)}get done(){return this._done}get budget(){return this._budget}madeProgress(){return this._progressed=!0,this._done=this.elapsed>=this._budget&&this._enabled,this._done}get state(){return this._state}get enabled(){return this._enabled}set enabled(e){this._enabled=e}reset(e,t){this._begin=this.now(),this._budget=e,this._state=t,this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return performance.now()-this._begin}resetProgress(){this._progressed=!1,this._done=!1}get hasProgressed(){return this._progressed}}e.Budget=i}(I||(I={})),function(e){e.SCHEDULED="s",e.READY="r",e.WAITING="w",e.IDLE="i"}(T||(T={}));const P=(()=>{const e=new I.Budget;return e.enabled=!1,e})();const R=new class{remove(){}processQueue(){}schedule(e,t,i){try{if((0,u.G4)(t)){const e=(0,u.NK)();return i?Promise.resolve(i(e)):Promise.reject(e)}return(0,u.z7)(e(P))}catch(n){return Promise.reject(n)}}reschedule(e,t,i){return this.schedule(e,t,i)}}},22856:(e,t,i)=>{i.d(t,{G:()=>n});const n=Symbol("Yield")},5551:(e,t,i)=>{i.d(t,{A:()=>a});var n=i(35143),s=i(91967),r=i(46053),o=(i(81806),i(76460),i(47249),i(85842));let l=class extends s.A{constructor(){super(...arguments),this.SCHEDULER_LOG_SLOW_TASKS=!1,this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1}};(0,n._)([(0,r.MZ)()],l.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),(0,n._)([(0,r.MZ)()],l.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0),l=(0,n._)([(0,o.$)("esri.views.support.DebugFlags")],l);const a=new l},39459:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Bt});var n=i(35143),s=i(98773),r=i(30726),o=i(56002),l=i(50346),a=i(68134),c=i(46053),u=(i(81806),i(76460)),h=(i(47249),i(85842)),d=i(25329);const p="esri-elevation-profile",_={widgetIcon:i(15062).T.elevationProfile,base:"".concat(p),portrait:"".concat(p,"--portrait"),refined:"".concat(p,"--refined"),mainContainer:"".concat(p,"__main-container"),promptContainer:"".concat(p,"__prompt-container"),header:"".concat(p,"__header"),zoomOutButton:"".concat(p,"__zoom-out-button"),clearButton:"".concat(p,"__clear-button"),actionButton:"".concat(p,"__action-button"),sketchButton:"".concat(p,"__sketch-button"),sketchCancelButton:"".concat(p,"__sketch-cancel-button"),sketchDoneButton:"".concat(p,"__sketch-done-button"),selectButton:"".concat(p,"__select-button"),selectCancelButton:"".concat(p,"__select-cancel-button"),chartContainer:"".concat(p,"__chart-container"),chartSpinner:"".concat(p,"__chart-spinner"),chartSpinnerVisible:"".concat(p,"__chart-spinner--visible"),chartSpinnerSmall:"".concat(p,"__chart-spinner--small"),footer:"".concat(p,"__footer")},v="esri-elevation-profile-legend",g="esri-elevation-profile-legend-item",m={base:g,disabled:"".concat(g,"--disabled"),expanded:"".concat(g,"--expanded"),colorIndicator:"".concat(g,"__color-indicator"),header:"".concat(g,"__header"),content:"".concat(g,"__content"),collapseToggle:"".concat(g,"__collapse-toggle"),label:"".concat(g,"__label"),checkbox:"".concat(g,"__checkbox")},f="esri-elevation-profile-statistics",y={base:f,statistic:"".concat(f,"__statistic"),statisticLabel:"".concat(f,"__statistic__label"),statisticValue:"".concat(f,"__statistic__value"),slopeValue:"".concat(f,"__slope-value")},b="esri-elevation-profile-settings",E={base:"".concat(b),popoverContent:"".concat(b,"__popover-content"),uniformChartScalingLabel:"".concat(b,"__uniform-scaling-label"),uniformChartScalingCheckbox:"".concat(b,"__uniform-scaling-checkbox")};var w=i(39356),S=i(91967),C=i(18690),M=i(55877),I=i(19276),T=i(3975),P=i(63241),R=i(53521),k=i(31633),A=i(71630),U=i(16159),L=i(54901),D=i(79468),Z=i(12482),x=i(54054),O=i(15941),N=i(19555),G=i(20664),V=i(23701),B=i(9624),F=i(13312),z=i(7137);const H="ProfileGenerationError";var q;!function(e){e.TooComplex="too-complex",e.InvalidGeometry="invalid-geometry",e.InvalidElevationInfo="invalid-elevation-info",e.ElevationQueryError="elevation-query-error"}(q||(q={}));class K extends Error{constructor(e){super("profile could not be generated",{cause:e}),this.type=H}}async function j(e,t,n,s,r,o,a){var c;let u,h,d;const p=e.spatialReference,_=p.isGeographic||p.isWebMercator;let v=0;if(!_){const{planarLength:t}=await i.e(56203).then(i.bind(i,56203));(0,l.Te)(a),v=await t(e,"meters"),(0,l.Te)(a)}const g=1/(0,k.GA)(s),m=null!==(c=r.geodesicDistanceThreshold)&&void 0!==c?c:1/0;if(_||v>=m){await(0,B.initializeProjection)([{source:p,dest:s},{source:p,dest:F.A.WGS84}],a);const i=function(e){return(0,z.TT)(e.spatialReference)?e:(0,B.project)(e,F.A.WGS84)}(e);u=(0,z.l1)([i],"meters")[0];const l=Q(u,r);if(ae(e,u,l)>o)throw new K(q.TooComplex);const c=W(i,t,n);({densifiedPath:h,distances:d}=function(e,t,i){const{hasZ:n}=e;return ee(e,t,i,te,n?se:ne)}(c,l,g)),h=(0,B.project)(h,s)}else{await(0,B.initializeProjection)([{source:p,dest:s}],a),u=v;const i=Q(u,r);if(ae(e,u,i)>o)throw new K(q.TooComplex);const c=W(e,t,n);({densifiedPath:h,distances:d}=function(e,t,i){const{hasZ:n}=e;return ee(e,t,i,ie,n?oe:re)}(c,i,g)),(0,l.Te)(a),h=(0,B.project)(h,s)}return{densifiedPath:h,pathLength:u*g,distances:d}}function Q(e,t){const i=e/t.densificationMaxSamples;return Math.max(t.samplingDistance,i)}function W(e,t,i){if(null==t)return Y(e);const n=e.spatialReference,s=t.mode,r=(0,Z.Ze)(t,n);let o=null;switch(i.type){case"2d":o=function(e,t,i){let{hasZ:n}=e;return"absolute-height"===t?n?e=>{let[t,n,s]=e;return[t,n,s+i]}:e=>{let[t,n]=e;return[t,n,i]}:null}(e,s,r);break;case"3d":o=function(e,t,i,n){let{spatialReference:s,hasZ:r}=e,{elevationProvider:o}=n;const l=(e,t,i,n)=>{var r;return null!==(r=null===o||void 0===o?void 0:o.getElevation(e,t,i,s,n))&&void 0!==r?r:0};switch(t){case"on-the-ground":return e=>{let[t,i]=e;return[t,i,l(t,i,0,"ground")]};case"absolute-height":return r?e=>{let[t,n,s]=e;return[t,n,s+i]}:e=>{let[t,n]=e;return[t,n,i]};case"relative-to-ground":return r?e=>{let[t,n,s]=e;return[t,n,s+l(t,n,s,"ground")+i]}:e=>{let[t,n]=e;return[t,n,l(t,n,0,"ground")+i]};case"relative-to-scene":return r?e=>{let[t,n,s]=e;return[t,n,s+l(t,n,s,"scene")+i]}:e=>{let[t,n]=e;return[t,n,l(t,n,0,"scene")+i]};default:return null}}(e,s,r,i)}return null==o?Y(e):new V.A({hasZ:!0,hasM:!1,spatialReference:n,paths:J(e.paths,o)})}function Y(e){return e.hasZ?new V.A({hasZ:!1,hasM:!1,spatialReference:e.spatialReference,paths:J(e.paths,(e=>{let[t,i]=e;return[t,i]}))}):e}function J(e,t){const i=e.length,n=new Array(i);for(let s=0;s<i;++s){const i=e[s],r=i.length,o=new Array(i.length);n[s]=o;for(let e=0;e<r;++e)o[e]=t(i[e])}return n}function $(e){return X(e)&&e.paths.length>0&&e.paths.every((e=>e.length>=2))}function X(e){return null!=e&&"polyline"===e.type}function ee(e,t,i,n,s){const{spatialReference:r,hasZ:o}=e,l={from:null,to:null,distance:0,azimuth:0,reverseAzimuth:0,spatialReference:r,metersPerSR:(0,k.GA)(r)},a=[],c=[];let u=0;for(let h=0;h<e.paths.length;++h){const r=e.paths[h],o=new Array,d=new Array;let p=0;for(let e=1;e<r.length;++e){const a=r[e-1],c=r[e],h=n(l,a,c);let _;for(_=p;_<h.distance;_+=t)o.push(s(h,_)),d.push((u+_)*i);p=_-h.distance,u+=h.distance,o.push(c),d.push(u*i)}a[h]=o,c[h]=d}return{densifiedPath:new V.A({spatialReference:r,hasZ:o,paths:a}),distances:c}}function te(e,t,i){return e.distance=0,(0,z._3)(e,t,i,e.spatialReference),e.from=t,e.to=i,e}function ie(e,t,i){return e.from=t,e.to=i,e.distance=(0,N.Io)(i,t)*e.metersPerSR,e}function ne(e,t){let{from:i,azimuth:n,spatialReference:s}=e;return(0,z.vN)([0,0],i,n,t,s)}function se(e,t){let{from:i,to:n,azimuth:s,distance:r,spatialReference:o}=e;const l=t/r,a=[0,0,(0,O.Cc)(i[2],n[2],l)];return(0,z.vN)(a,i,s,t,o),a}function re(e,t){let{from:i,to:n,distance:s}=e;return(0,N.Cc)([0,0],i,n,t/s)}function oe(e,t){let{from:i,to:n,distance:s}=e;return(0,G.m)([0,0,0],i,n,t/s)}function le(e){return e.paths.reduce(((e,t)=>e+t.length),0)}function ae(e,t,i){return le(e)+Math.floor(t/i)+Math.max(0,e.paths.reduce((e=>1+e),0)-1)}var ce=i(66388),ue=i(5262),he=i(80963),de=i(80544),pe=i(59752);function _e(e,t){return null==t?e:null!=e?Math.min(e,t):t}function ve(e,t){return null==t?e:null!=e?Math.max(e,t):t}function ge(e,t){return null!=e&&null!=t?e*t:null}class me{constructor(){this._start=0,this._totalElevation=0,this._sampleCount=0}get avgElevation(){return this._totalElevation/this._sampleCount}get isHole(){return 0===this._sampleCount}get start(){return this._start}copy(e){this._start=e._start,this._sampleCount=e._sampleCount,this._totalElevation=e._totalElevation}reset(){this._start=0,this._sampleCount=0,this._totalElevation=0}restart(e,t){this._start=e,this._sampleCount=1,this._totalElevation=t}insert(e){++this._sampleCount,this._totalElevation+=e}}var fe=i(71587);function*ye(e,t){const{densificationResult:i}=e,n={...e,abortOptions:t,densificationResult:i},s=(0,fe.s)(0,n.result.samples.length),r=s.slice(0,n.provider.numSamplesForPreview);yield be(n,r,!0);const o=(0,C.Ho)(s,n.provider.numSamplesPerChunk);for(const l of o)yield be(n,l,!1)}async function be(e,t,i){let{densificationResult:n,result:s,provider:r,queue:o,abortOptions:a,cache:c}=e;const{densifiedPath:u,pathLength:h}=n,d=s.spatialReference,{samples:p}=s,_=[];for(let l=0;l<t.length;l++){const e=p[t[l]];_[l]=e.coordinate}try{return await o.push({geometry:new ce.A({spatialReference:d,points:_,hasZ:u.hasZ}),provider:r,indices:t,preview:i,result:s,queryOptions:{...(0,x.zj)().defaultQueryOptions(),minDemResolution:i?Math.round(h/r.numSamplesForPreview):Math.round(h/p.length),cache:c}},a),{...s}}catch(j){return(0,l.zf)(j)?null:x.WG}}function Ee(e){return new de.e({priority:pe.W6.ELEVATION_PROFILE,concurrency:1,scheduler:e,process:async e=>{(0,l.Te)(e.queryOptions);try{await async function(e){let{geometry:t,provider:i,indices:n,preview:s,result:r,queryOptions:o}=e;if(0===n.length)return;const l=(await async function(e,t,i){try{return await e.queryElevation(t,i)}catch(s){throw new K(q.ElevationQueryError)}}(i,t,o)).geometry,{hasZ:a,points:c}=l,u=o.noDataValue,{samples:h}=r;for(let d=0;d<n.length;d++){const e=h[n[d]];if(e.isHole)continue;const t=a?c[d][2]:null;null===t||t===u?e.sampledZ=null:(r.hasZ=!0,e.sampledZ=t),e.sampled=!0}(function(e){const t=e.length-1;let i=0;for(let n=1;n<=t;n++)(e[n].sampled||n===t)&&(we(e,i,n),i=n)})(h),r.progress=s?0:r.progress+n.length/h.length,r.statistics=function(e,t){const i=e.length;if(0===i)return null;const n=e[0],s=n.sampledZ;let r=s,o=s,l=0,a=0,c=null,u=null,h=null!=s?s:0,d=0,p=0,_=null!=s?1:0,v=0,g=0;const m=(0,k.GA)(t),f=(0,k.G9)(t),y=(0,x.zj)().minSlopeSampleDistance/m,b=2*y,E=new me,w=new me,S=()=>{M(),E.copy(w),w.reset()},C=(e,t)=>{S(),e>0&&e-E.start<=b&&(e=E.start+y),w.restart(e,t)},M=()=>{if(E.isHole||w.isHole)return;const e=w.avgElevation-E.avgElevation,t=w.start-E.start,i=e*f,n=t*m,s=(0,k.oU)(Math.atan2(i,n),"radians","degrees");s>0?(d+=s,c=ve(c,s),v++):s<0&&(p-=s,u=ve(u,-s),g++)};null!=n.sampledZ&&C(n.distance,n.sampledZ);for(let I=1;I<i;++I){const t=e[I-1],i=e[I],n=i.sampledZ;if(null==n){w.isHole||S();continue}_++,h+=n,r=_e(r,n),o=ve(o,n),w.isHole||i.distance-w.start>=y?C(i.distance,n):w.insert(n);const s=t.sampledZ;if(null!=s){const e=n-s;e>0?l+=e:e<0&&(a-=e)}}return S(),0===_?null:{maxDistance:e[i-1].distance,minElevation:r,maxElevation:o,avgElevation:0===_?null:h/_,elevationGain:l,elevationLoss:a,maxPositiveSlope:c,maxNegativeSlope:u,avgPositiveSlope:0===v?null:d/v,avgNegativeSlope:0===g?null:p/g}}(r.samples,r.spatialReference)}(e)}catch(p){(0,l.jH)(p)}}})}function we(e,t,i){if(i-t==1)return;const n=e[t],s=n.sampledZ,r=e[i],o=r.sampledZ;if(null==s||null==o){for(let n=t+1;n<i;n++)e[n].sampledZ=null;return}const l=n.distance,a=r.distance-l;for(let c=t+1;c<i;c++){const t=e[c],i=(t.distance-l)/a;t.sampledZ=(0,O.Cc)(s,o,i)}}function Se(e){let{densifiedPath:t,distances:i}=e;const n=t.spatialReference,s=(0,he.Vp)(n),r=t.paths,o=r.length,l=[];let a=null,c=0;for(let u=0;u<o;u++){const e=r[u],t=e.length,n=i[u];for(let i=0;i<t;i++){const t=e[i],r=n[i];s&&(t[0]=(0,ue.N6)(t[0],s.valid[0],s.valid[1])),a&&0===i&&Ce(l,a,t,c,r),l.push(Me(t,r)),a=t,c=r}}return{progress:0,samples:l,hasZ:!1,statistics:null,spatialReference:n}}function Ce(e,t,i,n,s){e.push(Ie(t,n)),e.push(Ie(i,s))}function Me(e,t){return{coordinate:e,distance:t,sampledZ:null,sampled:!1,isHole:!1}}function Ie(e,t){return{coordinate:e,distance:t,sampledZ:null,sampled:!0,isHole:!0}}const Te="line-change";let Pe=class extends S.A{constructor(e){super(e),this._updateTask=null,this._paramsPerProfile=new Map,this._getUpdateParametersMemoized=(0,o.B)(((e,t,i)=>({stationary:e,visibleProfiles:t,generationParameters:i}))),this._getGenerationParametersMemoized=(0,o.B)(((e,t,i,n,s,r,o)=>X(t)&&$(t)&&null!=n?{view:e,geometry:t,elevationInfo:i,options:r,queue:n,cache:s,slicePlane:o}:null)),this._getElevationInfoMemoized=(0,o.B)(((e,t)=>({mode:e,offset:t}))),this._getOptionsMemoized=(0,o.B)(((e,t,i)=>{const{densificationMaxSamples:n,maxTotalSamples:s}=(0,x.zj)();return{geodesicDistanceThreshold:e,samplingDistance:t,densificationMaxSamples:Math.round(n/i),maxTotalSamples:s}})),this._updateThrottled=(0,D.n)((e=>(0,l.QZ)(this._update(e))),(0,x.zj)().updateThrottleMillis)}initialize(){const e=this.viewModel;this.addHandles([(0,a.watch)((()=>e.profiles.toArray()),(e=>{this._abortUpdate(),this._paramsPerProfile.clear(),this.removeHandles(Te),this.addHandles(e.map((e=>(0,L.vE)([e.attach(this.viewModel),e.on("change",(()=>{this._invalidateProfile(e)}))]))),Te)}),a.syncAndInitial),this._updateThrottled,(0,a.watch)((()=>this._updateParameters),this._updateThrottled,a.syncAndInitial)])}destroy(){this._paramsPerProfile.clear()}get _updateParameters(){const{viewModel:e}=this,t=e.view;return this._getUpdateParametersMemoized(null==t||t.stationary,this.viewModel.visibleProfiles,this._generationParameters)}get _generationParameters(){const{view:e,input:t,queue:i,tileCache:n}=this.viewModel;return null!=e&&e.ready?this._getGenerationParametersMemoized(e,null===t||void 0===t?void 0:t.geometry,this._elevationInfo,i,n,this._options,"3d"===e.type?e.slicePlane:null):null}get _elevationInfo(){const e=this.viewModel.input,t=e?(0,Z.NN)(e)?null:(0,Z.bh)(e):null;return null!=t?this._getElevationInfoMemoized(t.mode,t.offset):null}get _options(){var e;const t=this.viewModel,i=t.visibleProfiles.length;let n=null!==(e=t.minDemResolution)&&void 0!==e?e:(0,x.zj)().defaultDemResolution;return n=parseFloat(n.toFixed(2)),this._getOptionsMemoized(t.geodesicDistanceThreshold,n,i)}async _update(e){let{stationary:t,visibleProfiles:i,generationParameters:n}=e;this._abortUpdate(),t&&(null!=n?this._updateTask=(0,s.UT)((async e=>{this.viewModel.error=null;const t=i.filter((e=>!this._isProfileValid(e,n))),s=async function*(e,t){var i;const{view:n,geometry:s,elevationInfo:r,providers:o,options:a}=e,c=n.spatialReference;if(!c||null==s||!$(s))throw new K(q.InvalidGeometry);const u=o.length;if(0===u)return null;const h=Math.round(a.maxTotalSamples/u);if(le(s)>h)throw new K(q.TooComplex);const d=await j(s,r,n,c,a,h,t);let p=0;const _=new Array(u),v=new Array(u);for(let l=0;l<u;l++){const i=Se(d);_[l]=i,p+=i.samples.length;const n={...e,provider:o[l],result:i,densificationResult:d};v[l]=ye(n,t)[Symbol.iterator]()}if(p>a.maxTotalSamples)throw new K(q.TooComplex);const g=await Promise.all(v.map((e=>{const t=e.next();return!0===t.done?Promise.resolve(null):t.value})));(0,l.Te)(t);for(let l=0;l<u;l++)_[l]=g[l];yield _,await(0,l.Pl)(null!==(i=e.delayAfterPreview)&&void 0!==i?i:(0,x.zj)().delayAfterPreviewMillis,null,t.signal);const m=[];try{let e;do{e=!1;for(let t=0;t<u;t++){const i=v[t].next();!1===i.done&&(m.push({resultPromise:i.value,index:t}),e=!0)}}while(e)}finally{v.forEach((e=>{var t;return null===(t=e.return)||void 0===t?void 0:t.call(e)}))}for(const{resultPromise:f,index:y}of m)_[y]=await f,(0,l.Te)(t),yield _;for(const l of _)null!=l&&(l.progress=1);yield _}({...n,providers:t},{signal:e});try{for await(const i of s){(0,l.Te)(e),this._clearInvalidResults(n);for(let e=0;e<t.length;e++)t[e].result=i[e]}for(const e of t)this._paramsPerProfile.set(e,n)}catch(r){(0,l.QP)(r),this._abortUpdate(),this.viewModel.error=r,t.forEach((e=>{e.result=null}))}})):this._clearResults())}_abortUpdate(){this._updateTask=(0,r.DC)(this._updateTask)}_isProfileValid(e,t){return this._paramsPerProfile.has(e)&&this._paramsPerProfile.get(e)===t}_invalidateProfile(e){this._paramsPerProfile.delete(e),this._updateThrottled(this._updateParameters)}_clearInvalidResults(e){for(const t of this.viewModel.profiles.items)this._isProfileValid(t,e)||(t.result=null,this._paramsPerProfile.delete(t))}_clearResults(){for(const e of this.viewModel.profiles.items)e.result=null,this._paramsPerProfile.delete(e)}};(0,n._)([(0,c.MZ)({nonNullable:!0})],Pe.prototype,"viewModel",void 0),(0,n._)([(0,c.MZ)()],Pe.prototype,"_updateParameters",null),(0,n._)([(0,c.MZ)()],Pe.prototype,"_generationParameters",null),(0,n._)([(0,c.MZ)()],Pe.prototype,"_elevationInfo",null),(0,n._)([(0,c.MZ)()],Pe.prototype,"_options",null),Pe=(0,n._)([(0,h.$)("esri.widgets.ElevationProfile.ElevationProfileController")],Pe);var Re=i(69539),ke=i(54099),Ae=i(49723),Ue=i(13904);function Le(e,t,i){return null==e?null:(0,k.oU)(e*t,"meters",i)}function De(e,t,i){return null==e?null:(0,k.oU)(e*t,"meters",i)}let Ze=class extends ke.A.EventedAccessor{constructor(e){super(e),this.type=null,this.id=(0,Ae.lk)(),this.title=null,this.color=new Re.A("#000000"),this.visible=!0,this._getSamplesMemoized=(0,o.B)(((e,t)=>function(e,t){if(null==e||null==t)return null;const{samples:i,spatialReference:n}=e,{distance:s,elevation:r}=t,o=(0,k.GA)(n),l=(0,k.G9)(n),a=i.length,c=new Array(a);for(let u=0;u<a;++u){const e=i[u],t=e.sampledZ,n=e.coordinate;c[u]={x:n[0],y:n[1],z:t,distance:Le(e.distance,o,s),elevation:De(t,l,r)}}return c}(e,t))),this._getStatisticsMemoized=(0,o.B)(((e,t)=>function(e,t){if(null==e||null==t||null==e.statistics||null==e.spatialReference)return null;const{distance:i,elevation:n}=t,{statistics:s,spatialReference:r}=e,o=(0,k.GA)(r),l=(0,k.G9)(r);return{maxDistance:Le(s.maxDistance,o,i),minElevation:De(s.minElevation,l,n),maxElevation:De(s.maxElevation,l,n),avgElevation:De(s.avgElevation,l,n),elevationGain:De(s.elevationGain,l,n),elevationLoss:De(s.elevationLoss,l,n),maxPositiveSlope:s.maxPositiveSlope,maxNegativeSlope:s.maxNegativeSlope,avgPositiveSlope:s.avgPositiveSlope,avgNegativeSlope:s.avgNegativeSlope}}(e,t))),this.viewVisualizationEnabled=!0,this.result=null,this.effectiveUnits=null,this.numSamplesForPreview=30,this.numSamplesPerChunk=200,this.chartFillEnabled=!0,this.chartStrokeWidth=1.5,this.chartStrokeOffsetY=0,this._viewModel=null}get progress(){return null!=this.result&&this.visible?this.result.progress:0}get samples(){return this._getSamplesMemoized(this.result,this.effectiveUnits)}get statistics(){return this._getStatisticsMemoized(this.result,this.effectiveUnits)}get hoveredPoint(){var e;const t=null===(e=this._viewModel)||void 0===e?void 0:e.hoveredChartPosition;return null!=t?this._getPoint(t):null}get available(){return!0}get hasZ(){const e=this.result;return null!=e&&e.hasZ}get minDemResolution(){return(0,x.zj)().defaultDemResolution}queryElevation(){throw new Error("not implemented")}attach(e){return this._viewModel=e,(0,L.vE)([(0,a.watch)((()=>e.effectiveUnits),(e=>{this.effectiveUnits=e}),a.syncAndInitial),(0,a.watch)((()=>[e.input]),(()=>this._onChange()),a.sync)])}toggleVisibility(e){this.visible=void 0===e?!this.visible:e}_onChange(){this.emit("change")}_getPoint(e){const{samples:t,result:i}=this;if(null==t||null==i)return null;const n=t.length;if(0===n)return null;const s=t[n-1].distance,r=(0,C.qX)(t,e*s,(e=>e.distance));if(null==r)return null;const{x:o,y:l,z:a}=r;return null==a?null:new Ue.A({x:o,y:l,z:a,spatialReference:i.spatialReference})}};(0,n._)([(0,c.MZ)({nonNullable:!0})],Ze.prototype,"id",void 0),(0,n._)([(0,c.MZ)({nonNullable:!0})],Ze.prototype,"title",void 0),(0,n._)([(0,c.MZ)({type:Re.A,nonNullable:!0})],Ze.prototype,"color",void 0),(0,n._)([(0,c.MZ)({nonNullable:!0})],Ze.prototype,"visible",void 0),(0,n._)([(0,c.MZ)({readOnly:!0})],Ze.prototype,"progress",null),(0,n._)([(0,c.MZ)({readOnly:!0})],Ze.prototype,"samples",null),(0,n._)([(0,c.MZ)({readOnly:!0})],Ze.prototype,"statistics",null),(0,n._)([(0,c.MZ)()],Ze.prototype,"hoveredPoint",null),(0,n._)([(0,c.MZ)()],Ze.prototype,"viewVisualizationEnabled",void 0),(0,n._)([(0,c.MZ)()],Ze.prototype,"available",null),(0,n._)([(0,c.MZ)()],Ze.prototype,"result",void 0),(0,n._)([(0,c.MZ)()],Ze.prototype,"effectiveUnits",void 0),(0,n._)([(0,c.MZ)()],Ze.prototype,"numSamplesForPreview",void 0),(0,n._)([(0,c.MZ)()],Ze.prototype,"numSamplesPerChunk",void 0),(0,n._)([(0,c.MZ)()],Ze.prototype,"chartFillEnabled",void 0),(0,n._)([(0,c.MZ)()],Ze.prototype,"chartStrokeWidth",void 0),(0,n._)([(0,c.MZ)()],Ze.prototype,"chartStrokeOffsetY",void 0),(0,n._)([(0,c.MZ)({readOnly:!0})],Ze.prototype,"hasZ",null),(0,n._)([(0,c.MZ)({readOnly:!0})],Ze.prototype,"minDemResolution",null),(0,n._)([(0,c.MZ)()],Ze.prototype,"_viewModel",void 0),Ze=(0,n._)([(0,h.$)("esri.widgets.ElevationProfile.ElevationProfileLine")],Ze);const xe=Ze;var Oe=i(18364);function Ne(e){if(null==e)return null;if(e instanceof Oe.A)return Ge(e);const t=e.tileInfo;if(null==t)return null;const i=(0,C.HV)(t.lods);return null==i?null:i.resolution*(0,k.GA)(t.spatialReference)}function Ge(e){var t;if(null==e)return null;const i=e.layers.items.map(Ve).filter(C.Ru);return null!==(t=(0,C.jk)(i))&&void 0!==t?t:null}function Ve(e){return e&&"tileInfo"in e?Ne(e):null}let Be=class extends xe{constructor(e){super(e),this.type="ground",this.color=new Re.A("#ff7f00"),this.viewVisualizationEnabled=!0,this.numSamplesForPreview=50,this.numSamplesPerChunk=1e3,this._getQueryElevationDependencies=(0,o.B)(((e,t)=>({ground:e,groundLayers:t})))}get available(){const e=this._ground;return null!=e&&e.layers.some((e=>e.visible))}get minDemResolution(){return Ge(this._ground)}get _queryElevationDependencies(){return this._getQueryElevationDependencies(this._ground,this._groundLayers)}get _ground(){var e;return null===(e=this._viewModel)||void 0===e||null===(e=e.view)||void 0===e||null===(e=e.map)||void 0===e?void 0:e.ground}get _groundLayers(){var e,t;return null!==(e=null===(t=this._ground)||void 0===t||null===(t=t.layers)||void 0===t?void 0:t.toArray())&&void 0!==e?e:[]}async queryElevation(e,t){const i=this._queryElevationDependencies;if(null==i)throw new Error("ElevationProfileLineGround: no dependencies");const{ground:n}=i;if(null==n)throw new Error("No ground configured in the view");const s=await n.queryElevation(e,t),r=(0,k.G9)(e.spatialReference),o=(0,k.G9)(n.layers.at(0).spatialReference);if(r!==o){const e=s.geometry;e.points=e.points.map((e=>{let[i,n,s]=e;return[i,n,s===t.noDataValue?s:s*o/r]}))}return s}attach(e){return(0,L.vE)([super.attach(e),(0,a.watch)((()=>this._queryElevationDependencies),(()=>this._onChange()))])}};(0,n._)([(0,c.MZ)({type:Re.A,nonNullable:!0})],Be.prototype,"color",void 0),(0,n._)([(0,c.MZ)()],Be.prototype,"viewVisualizationEnabled",void 0),(0,n._)([(0,c.MZ)()],Be.prototype,"available",null),(0,n._)([(0,c.MZ)({readOnly:!0})],Be.prototype,"minDemResolution",null),(0,n._)([(0,c.MZ)()],Be.prototype,"_queryElevationDependencies",null),(0,n._)([(0,c.MZ)()],Be.prototype,"_ground",null),(0,n._)([(0,c.MZ)()],Be.prototype,"_groundLayers",null),Be=(0,n._)([(0,h.$)("esri.widgets.ElevationProfile.ElevationProfileLineGround")],Be);const Fe=Be;var ze=i(3571);let He=class extends xe{constructor(e){super(e),this.type="input",this.color=new Re.A("#00c8c8"),this.viewVisualizationEnabled=!1,this.numSamplesForPreview=50,this.numSamplesPerChunk=500,this.chartFillEnabled=!1,this.chartStrokeOffsetY=-1,this._getQueryElevationDependencies=(0,o.B)(((e,t,i,n,s)=>e?{elevationInfo:e,visibleLayers:t,view:i,stationary:n,spatialReference:s}:null))}get queryElevationDependencies(){var e;const t=null===(e=this._viewModel)||void 0===e?void 0:e.view;return null==t?null:this._getQueryElevationDependencies(this._elevationInfo,this._visibleLayers,t,t.stationary,t.spatialReference)}get available(){var e;return!(null!==(e=this._viewModel)&&void 0!==e&&e.inputIsSketched)}get _elevationInfo(){var e;const t=null===(e=this._viewModel)||void 0===e?void 0:e.input;return t?(0,Z.bh)(t):null}get _visibleLayers(){var e,t;return null!==(e=null===(t=this._viewModel)||void 0===t||null===(t=t.view)||void 0===t||null===(t=t.map)||void 0===t||null===(t=t.allLayers)||void 0===t?void 0:t.filter((e=>e.visible)).toArray())&&void 0!==e?e:[]}async queryElevation(e,t){let{noDataValue:i,signal:n}=t;const s=this.queryElevationDependencies;if(null==s)throw new Error("ElevationProfileLineInput: no dependencies");const{view:r,elevationInfo:o,spatialReference:l}=s;if("on-the-ground"===o.mode&&"3d"===r.type&&l){const t=await ze.q.fromGeometry(e).project(l,n);if(!t)return{geometry:e,noDataValue:i};const s=r.elevationProvider;return t.coordinates.forEach((e=>{var t;e.z=null!==(t=s.getElevation(e.x,e.y,0,l,"ground"))&&void 0!==t?t:0})),{geometry:t.export(),noDataValue:i}}return{geometry:e,noDataValue:i}}attach(e){const t=()=>this._onChange();return(0,L.vE)([super.attach(e),(0,a.watch)((()=>this.queryElevationDependencies),t),(0,a.on)((()=>e.elevationProvider),"elevation-change",t,{onListenerAdd:t,onListenerRemove:t})])}};(0,n._)([(0,c.MZ)({type:Re.A,nonNullable:!0})],He.prototype,"color",void 0),(0,n._)([(0,c.MZ)()],He.prototype,"viewVisualizationEnabled",void 0),(0,n._)([(0,c.MZ)()],He.prototype,"queryElevationDependencies",null),(0,n._)([(0,c.MZ)()],He.prototype,"available",null),(0,n._)([(0,c.MZ)()],He.prototype,"_elevationInfo",null),(0,n._)([(0,c.MZ)()],He.prototype,"_visibleLayers",null),He=(0,n._)([(0,h.$)("esri.widgets.ElevationProfile.ElevationProfileLineInput")],He);const qe=He;let Ke=class extends xe{constructor(e){super(e),this.type="query",this.color=new Re.A("#db334a"),this.viewVisualizationEnabled=!0,this.source=null,this.numSamplesForPreview=50,this.numSamplesPerChunk=500}get minDemResolution(){return Ne(this.source)}get available(){const e=this.source;return!!e&&(null==e.visible||e.visible)&&(null==e.layers||e.layers.some((e=>e.visible)))}queryElevation(e,t){if(!this.source)throw new Error("No source configured for the elevation profile line");return this.source.queryElevation(e,t)}attach(e){return(0,L.vE)([super.attach(e),(0,a.watch)((()=>this.source),(()=>this._onChange()),a.sync)])}};(0,n._)([(0,c.MZ)({type:Re.A,nonNullable:!0})],Ke.prototype,"color",void 0),(0,n._)([(0,c.MZ)()],Ke.prototype,"viewVisualizationEnabled",void 0),(0,n._)([(0,c.MZ)()],Ke.prototype,"source",void 0),(0,n._)([(0,c.MZ)({readOnly:!0})],Ke.prototype,"minDemResolution",null),(0,n._)([(0,c.MZ)()],Ke.prototype,"available",null),Ke=(0,n._)([(0,h.$)("esri.widgets.ElevationProfile.ElevationProfileLineQuery")],Ke);const je=Ke;var Qe=i(41289),We=i(9392),Ye=i(34111),Je=i(95925),$e=i(88220),Xe=i(29808),et=i(3112),tt=i(30310);let it=class extends xe{constructor(e){super(e),this.type="view",this.color=new Re.A("#cf4ccf"),this.viewVisualizationEnabled=!0,this.include=null,this.exclude=null,this.numSamplesForPreview=50,this.numSamplesPerChunk=25,this._getQueryElevationDependencies=(0,o.B)(((e,t,i,n,s,r,o)=>({inputGraphicUid:null!=e?st(e):null,visibleLayers:t,maxIntersectionDistance:i,intersectOptions:n,view:s,stationary:r,spatialReference:o}))),this._vecA=(0,We.vt)(),this._vecB=(0,We.vt)(),this._ray=(0,Je.vt)()}get minDemResolution(){var e,t;const i=null===(e=this._viewModel)||void 0===e?void 0:e.view;if(null==i||"3d"!==i.type)return null;const n=null===(t=i.pointsOfInterest)||void 0===t||null===(t=t.focus)||void 0===t?void 0:t.worldUnitsPerContentPixel;return null==n?null:n*(0,k.G9)(i.spatialReference)}get queryElevationDependencies(){var e;const t=this._view;return t?this._getQueryElevationDependencies(null===(e=this._viewModel)||void 0===e?void 0:e.input,this._visibleLayers,this._maxIntersectionDistance,this._intersectOptions,t,t.stationary,t.spatialReference):null}get _visibleLayers(){var e,t;return null!==(e=null===(t=this._view)||void 0===t||null===(t=t.map)||void 0===t||null===(t=t.allLayers)||void 0===t?void 0:t.filter((e=>e.visible)).toArray())&&void 0!==e?e:[]}get _intersectOptions(){const e=this._view;if(null==e||e.destroyed)return{};const t=(0,$e.ZD)(e,{include:this.include,exclude:this.exclude}),i=(0,$e.ZD)(e,{exclude:this._pointCloudLayers});return t.exclude=(0,Qe.KC)(t.exclude,i.exclude),t}get _pointCloudLayers(){const e=this._view;return null==e?[]:e.allLayerViews.toArray().filter((e=>{var t;return"point-cloud"===(null===(t=e.layer)||void 0===t?void 0:t.type)})).map((e=>e.layer))}get _view(){var e;const t=null===(e=this._viewModel)||void 0===e?void 0:e.view;return null!=t&&"3d"===t.type?t:null}get _maxIntersectionDistance(){const e=this._view;return null!==e&&void 0!==e&&e.renderCoordsHelper?(0,Ye.tO)(e.spatialReference).radius/e.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY}get _intersector(){const e=this._view;if(null==e)return null;const t=(0,Xe.hz)(e.state.viewingMode),i=t.options;return i.hud=!1,i.invisibleTerrain=!1,i.backfacesTerrain=!1,i.selectionMode=!1,i.store=et.oH.ALL,t}async queryElevation(e,t){let{noDataValue:i,signal:n}=t;const s=this.queryElevationDependencies;if(null==s)throw new Error("ElevationProfileLineInput: no dependencies");const r=this._intersector;if(null==r)throw new Error("ElevationProfileLineInput: no view");const{intersectOptions:o,view:l,spatialReference:a}=s,c=l.renderCoordsHelper,u=l.sceneIntersectionHelper,h=this._vecA,d=this._vecA,p=this._vecB,_=this._ray;if(!a)return{geometry:e,noDataValue:i};const v=await ze.q.fromGeometry(e).project(a,n);if(!v)return{geometry:e,noDataValue:i};const g=v.coordinates,m=g.length;for(let y=0;y<m;++y){var f;const e=g[y];(0,G.s)(p,e.x,e.y,null!==(f=e.z)&&void 0!==f?f:0),c.toRenderCoords(p,a,p),c.setAltitude(h,2e5,p);const t=(0,Je.Cr)(h,p,_);u.computeIntersection(t,r,o,!0);const n=nt(s,r.results.all);n?(n.getIntersectionPoint(d),c.fromRenderCoords(d,d,a),e.z=d[2]):e.z=i}return{geometry:v.export(),noDataValue:i}}attach(e){const t=()=>this._onChange();return(0,L.vE)([super.attach(e),(0,a.watch)((()=>this.queryElevationDependencies),t),(0,a.on)((()=>e.elevationProvider),"elevation-change",t,{onListenerAdd:t,onListenerRemove:t})])}};function nt(e,t){let{view:i,inputGraphicUid:n,maxIntersectionDistance:s}=e;for(const r of t){if(null!=r.distanceInRenderSpace&&r.distanceInRenderSpace>s)continue;const e=(0,tt.Gy)(r,i);if(null==e||st(e)!==n)return r}return null}function st(e){if(e.layer&&"objectIdField"in e.layer){const t=e.attributes[e.layer.objectIdField];if(t)return"o-".concat(e.layer.id,"-").concat(t)}return"u-".concat(e.uid)}(0,n._)([(0,c.MZ)({type:Re.A,nonNullable:!0})],it.prototype,"color",void 0),(0,n._)([(0,c.MZ)()],it.prototype,"viewVisualizationEnabled",void 0),(0,n._)([(0,c.MZ)()],it.prototype,"include",void 0),(0,n._)([(0,c.MZ)()],it.prototype,"exclude",void 0),(0,n._)([(0,c.MZ)({readOnly:!0})],it.prototype,"minDemResolution",null),(0,n._)([(0,c.MZ)()],it.prototype,"queryElevationDependencies",null),(0,n._)([(0,c.MZ)()],it.prototype,"_visibleLayers",null),(0,n._)([(0,c.MZ)()],it.prototype,"_intersectOptions",null),(0,n._)([(0,c.MZ)()],it.prototype,"_pointCloudLayers",null),(0,n._)([(0,c.MZ)()],it.prototype,"_view",null),(0,n._)([(0,c.MZ)()],it.prototype,"_maxIntersectionDistance",null),(0,n._)([(0,c.MZ)()],it.prototype,"_intersector",null),it=(0,n._)([(0,h.$)("esri.widgets.ElevationProfile.ElevationProfileLineView")],it);const rt={base:xe,key:"type",typeMap:{ground:Fe,input:qe,query:je,view:it},errorContext:"elevation-profile-line"},ot=I.A.ofType(rt);var lt,at,ct=i(63733),ut=i(89465),ht=i(86645),dt=i(57308),pt=i(11337);!function(e){e.Ready="ready",e.Creating="creating",e.Reshaping="reshaping",e.ReshapingDisabled="reshaping-disabled",e.Selecting="selecting",e.Selected="selected"}(lt||(lt={})),function(e){e.View="view",e.Main="main",e.Interaction="interaction"}(at||(at={}));let _t=class extends S.A{constructor(e){super(e),this.state=lt.Ready,this._pendingStartOptions=null,this._previousInputInfo=null,this._shouldRemoveLastPoint=!1,this._sketchedGraphics=new WeakSet,this._creationToolPromise=null,this._updateToolPromise=null,this._updateDisabled=!1}initialize(){this.addHandles((0,a.watch)((()=>({view:this.tool.viewModel.view,visible:this.tool.visible})),(e=>{let{view:t,visible:i}=e;null!=t&&i?this._attach(t):this._detach()}),a.syncAndInitial),at.View)}destroy(){this._detach()}get canStopCreating(){const e=this._geometry,t=this._shouldRemoveLastPoint?3:2;return X(e)&&e.paths.length>0&&e.paths[0].length>=t}get _input(){return this.tool.viewModel.input}set _input(e){this.tool.viewModel.input=e}get _geometry(){var e;return null===(e=this._input)||void 0===e?void 0:e.geometry}get _visibleAndEditable(){return this.tool.visible&&this.tool.editable}get _view(){return this.tool.viewModel.view}get test(){var e,t;return{sketchVM:this._sketchVM,toolPromise:Promise.all([null!==(e=this._creationToolPromise)&&void 0!==e?e:Promise.resolve(),null!==(t=this._updateToolPromise)&&void 0!==t?t:Promise.resolve()])}}start(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{mode:"sketch"};if(!this.tool.editable)return;const t=this._view;if(null!=t&&t.ready)switch(this._pendingStartOptions=null,this._stopInteraction(),null==this._previousInputInfo&&this._storePreviousInput(this._input),this._setSketchedGraphic(null),e.mode){case"sketch":this._set("state",lt.Creating),this._startCreationInteraction();break;case"select":this._set("state",lt.Selecting),this._startSelectionInteraction()}else this._pendingStartOptions=e}stop(){this._pendingStartOptions=null,this._stopInteractionAndUpdate(),this._clearPreviousInput()}cancel(){this._pendingStartOptions=null,this._stopInteractionAndUpdate(),this._restorePreviousInput()}clear(){this._stopInteractionAndUpdate(),this._set("state",lt.Ready),this._clearPreviousInput(),this._input=null,this._pendingStartOptions=null}isSketchedGraphic(e){return null!=e&&this._sketchedGraphics.has(e)}_attach(e){this._detach();const t={mode:"3d"===e.type?"relative-to-ground":"on-the-ground",offset:null};this._graphicsLayer=new ct.default({listMode:"hide",internal:!0,elevationInfo:t});const i=function(e){return"2d"===e?new ut.A({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",effects:[{type:"CIMGeometricEffectDashes",dashTemplate:[5,4],lineDashEnding:"FullGap",controlPointEnding:"NoConstraint"}],enable:!0,capStyle:"Butt",joinStyle:"Round",width:1.5,color:[0,0,0,255]},{type:"CIMSolidStroke",enable:!0,capStyle:"Butt",joinStyle:"Round",width:1.5,color:[255,255,255,255]}]}}}):new ht.default({color:[0,0,0,0]})}(e.type);this._sketchVM=new pt.A({layer:this._graphicsLayer,view:e,defaultCreateOptions:{mode:"click",hasZ:!1},updateOnGraphicClick:!1,defaultUpdateOptions:{reshapeOptions:{shapeOperation:"none"},enableRotation:!1,enableScaling:!1,enableMoveAllGraphics:!1,enableZ:!1,multipleSelectionEnabled:!1,toggleToolOnClick:!1,tool:"reshape"},polylineSymbol:i,activeLineSymbol:i}),this.addHandles([(0,a.when)((()=>e.ready),(()=>{const e=this._pendingStartOptions;e&&this.start(e)}),a.syncAndInitial),(0,a.watch)((()=>[this._input,this._visibleAndEditable]),(()=>this._update()),a.syncAndInitial),(0,a.watch)((()=>({map:e.map,graphicsLayer:this._graphicsLayer})),(e=>{let{map:t,graphicsLayer:i}=e;null!=t&&null!=i&&t.add(i),this._update()}),a.syncAndInitial)],at.Main)}_detach(){var e;this.removeHandles(at.Main),this._sketchVM=(0,r.pR)(this._sketchVM),this._creationToolPromise=null,this._updateToolPromise=null;const t=null===(e=this._view)||void 0===e?void 0:e.map,i=this._graphicsLayer;null!=t&&null!=i&&t.remove(i),this._graphicsLayer=(0,r.pR)(this._graphicsLayer),this._shouldRemoveLastPoint=!1,this._set("state",lt.Ready)}_startCreationInteraction(){this._stopInteractionAndUpdate();const e=this._view,t=this._sketchVM;if(null==e||null==t)return;this._shouldRemoveLastPoint=!1;const i=t.on("create",(e=>{var t;const i=e.graphic;switch(e.state){case"complete":this._shouldRemoveLastPoint=!1,this._setSketchedGraphic(i),this._stopInteractionAndUpdate(),this._clearPreviousInput();break;case"cancel":this.cancel();break;case"active":this._setSketchedGraphic(i),"cursor-update"===(null===(t=e.toolEventInfo)||void 0===t?void 0:t.type)&&(this._shouldRemoveLastPoint=!0);break;case"start":this._setSketchedGraphic(i)}}));this.removeHandles(at.Interaction),this.addHandles((0,L.hA)((()=>{var e;i.remove();const n=this.canStopCreating,s=null===(e=this._geometry)||void 0===e?void 0:e.clone();t.cancel(),this._creationToolPromise=null,null!=s&&n?this._shouldRemoveLastPoint&&this._setSketchedGraphic(new w.A({geometry:vt(s)})):this._input=null})),at.Interaction),this._creationToolPromise=(0,l.QZ)(t.create("polyline"))}_startReshapeInteraction(){this._stopInteraction();const e=this._view,t=this._sketchVM;if(null==e||null==t)return;const i=t.on("update",(e=>{const t=e.graphics[0];switch(e.state){case"complete":this._setSketchedGraphic(t),this._stopInteractionAndUpdate(),this._clearPreviousInput();break;case"active":case"start":this._setSketchedGraphic(t)}}));this.removeHandles(at.Interaction),this.addHandles((0,L.hA)((()=>{i.remove(),t.cancel(),this._updateToolPromise=null})),at.Interaction);const n=this._input;n&&(n.visible=!0,this._updateToolPromise=(0,l.QZ)(t.update(n,{tool:"reshape"})))}_startSelectionInteraction(){this._stopInteraction();const e=this._view;if(null==e)return;const t=e.cursor,i=(0,L.hA)((()=>e.cursor=t));e.cursor="crosshair",e.closePopup();let n=null;const o=(0,L.hA)((()=>(0,r.DC)(n))),a=e.on("immediate-click",(t=>{t.async((async()=>{(0,r.DC)(n),n=(0,s.UT)((async i=>{const{results:n}=await e.hitTest(t);(0,l.Te)(i);const s=n.filter((e=>"graphic"===e.type&&null!=e.graphic)).map((e=>e.graphic)).find((e=>null!=e.geometry&&"polyline"===e.geometry.type));s&&(t.preventDefault(),t.stopPropagation(),this._input=s,this._clearPreviousInput(),this._stopInteractionAndUpdate())})),await n.promise}))}),dt.o.TOOL),c=e.on("key-down",(e=>{"Escape"===e.key&&this.cancel()}));this.removeHandles(at.Interaction),this.addHandles([a,c,o,i],at.Interaction),e.ready&&e.focus()}_stopInteraction(){this.removeHandles(at.Interaction)}_stopInteractionAndUpdate(){this.hasHandles(at.Interaction)&&(this._updateDisabled=!0,this._stopInteraction(),this._updateDisabled=!1,this._triggerUpdate())}_triggerUpdate(){this._set("state",lt.Ready),this._update()}_update(){if(this._updateDisabled)return;const e=this.state;if(e!==lt.Selecting){if(this._visibleAndEditable){if(e===lt.Creating||e===lt.Reshaping&&this.isSketchedGraphic(this._input))return}else this.cancel();this._set("state",this._getNextState()),this._updateVisuals()}else this.stop()}_getNextState(){return null==this._input?lt.Ready:this.isSketchedGraphic(this._input)?this.state===lt.Creating?lt.Creating:this._visibleAndEditable?lt.Reshaping:lt.ReshapingDisabled:lt.Selected}_updateVisuals(){switch(this.state){case lt.Creating:break;case lt.Reshaping:this._startReshapeInteraction();break;case lt.ReshapingDisabled:{this._stopInteractionAndUpdate();const e=this._input;null!=e&&this.isSketchedGraphic(e)&&(e.visible=!1);break}case lt.Ready:case lt.Selected:this._stopInteractionAndUpdate();case lt.Selecting:}this._updateSketchedGraphic()}_storePreviousInput(e){this._previousInputInfo={graphic:e}}_restorePreviousInput(){const e=this._previousInputInfo;null!=e&&(this._clearPreviousInput(),this._input=e.graphic,this._triggerUpdate())}_clearPreviousInput(){this._previousInputInfo=null}_updateSketchedGraphic(){const e=this._graphicsLayer;if(null==e)return;const t=e.graphics,i=this._input;if(null!=i&&this.isSketchedGraphic(i)){if(-1===t.indexOf(i))t.removeAll(),t.add(i);else if(1!==t.length){const e=t.filter((e=>e!==i));t.removeMany(e)}}else t.removeAll()}_setSketchedGraphic(e){null!=e&&this._sketchedGraphics.add(e),this._input=e,this._updateSketchedGraphic()}};function vt(e){if(X(e)){const t=e.clone();return t.paths=[t.paths[0].slice(0,-1)],t}return e}(0,n._)([(0,c.MZ)({nonNullable:!0})],_t.prototype,"state",void 0),(0,n._)([(0,c.MZ)({nonNullable:!0})],_t.prototype,"tool",void 0),(0,n._)([(0,c.MZ)()],_t.prototype,"canStopCreating",null),(0,n._)([(0,c.MZ)()],_t.prototype,"_graphicsLayer",void 0),(0,n._)([(0,c.MZ)()],_t.prototype,"_sketchVM",void 0),(0,n._)([(0,c.MZ)()],_t.prototype,"_input",null),(0,n._)([(0,c.MZ)()],_t.prototype,"_geometry",null),(0,n._)([(0,c.MZ)()],_t.prototype,"_visibleAndEditable",null),(0,n._)([(0,c.MZ)()],_t.prototype,"_view",null),(0,n._)([(0,c.MZ)()],_t.prototype,"_shouldRemoveLastPoint",void 0),_t=(0,n._)([(0,h.$)("esri.widgets.ElevationProfile.ElevationProfileInteraction")],_t);let gt=class extends S.A{constructor(e){super(e),this._implementation=null,this._loadingTask=null}initialize(){this.addHandles((0,a.watch)((()=>{var e;return{tool:this.tool,view:this.tool.viewModel.view,visible:this.tool.visible&&!(null===(e=this.tool.viewModel.view)||void 0===e||!e.ready)}}),(e=>{let{tool:t,view:i,visible:n}=e;null!=i&&n?this._show(i,t):this._hide()}),a.syncAndInitial))}destroy(){this._hide()}_show(e,t){this._loadingTask=(0,r.DC)(this._loadingTask),this._loadingTask=(0,s.UT)((async n=>{if("2d"===e.type){const s=i.e(75028).then(i.bind(i,75028)),r=(await(0,l.qr)(s,n)).ElevationProfileView2D;this._implementation=new r(e,t)}else if("3d"===e.type){const s=Promise.all([i.e(98433),i.e(88105),i.e(24473),i.e(39840),i.e(47447),i.e(99785),i.e(99469),i.e(75655),i.e(14826),i.e(76342)]).then(i.bind(i,41559)),r=(await(0,l.qr)(s,n)).ElevationProfileView3D;this._implementation=new r(e,t)}}))}_hide(){this._loadingTask=(0,r.DC)(this._loadingTask),this._implementation=(0,r.pR)(this._implementation)}};(0,n._)([(0,c.MZ)()],gt.prototype,"tool",void 0),gt=(0,n._)([(0,h.$)("esri.widgets.ElevationProfile.support.ElevationProfileView")],gt);let mt=class extends S.A{constructor(e){super(e),this.editable=!0,this.visible=!0,this.highlightEnabled=!0}initialize(){this.view=new gt({tool:this}),this.interaction=new _t({tool:this})}destroy(){this.interaction.destroy(),this.view.destroy()}get state(){var e;switch(null===(e=this.interaction)||void 0===e?void 0:e.state){case lt.Ready:return x.o8.Ready;case lt.Creating:return x.o8.Creating;case lt.Selecting:return x.o8.Selecting;case lt.Selected:return x.o8.Selected;case lt.Reshaping:case lt.ReshapingDisabled:return x.o8.Created}}};(0,n._)([(0,c.MZ)({nonNullable:!0})],mt.prototype,"viewModel",void 0),(0,n._)([(0,c.MZ)()],mt.prototype,"view",void 0),(0,n._)([(0,c.MZ)()],mt.prototype,"interaction",void 0),(0,n._)([(0,c.MZ)()],mt.prototype,"editable",void 0),(0,n._)([(0,c.MZ)()],mt.prototype,"visible",void 0),(0,n._)([(0,c.MZ)()],mt.prototype,"highlightEnabled",void 0),mt=(0,n._)([(0,h.$)("esri.widgets.ElevationProfile.ElevationProfileTool")],mt);let ft=class extends S.A{constructor(e){super(e),this.view=null,this.input=null,this._getEffectiveUnitsMemoized=(0,o.B)(((e,t)=>({distance:e,elevation:t}))),this.hoveredChartPosition=null,this.uniformChartScaling=!1,this.defaultUnit=null,this.queue=null,this._currentTileCache=null,this.error=null,this._defaultProfileLineGround=new Fe,this._userUnitOptions=null,this._userUnit=null,(null===e||void 0===e?void 0:e.profiles)||(this.profiles=new I.A([this._defaultProfileLineGround]))}initialize(){this.addHandles((0,a.watch)((()=>this.view),(e=>{var t;if(null==e)return void u.A.getLogger(this).warnOnce("no view. Widget will be disabled until a view is provided.");this.removeHandles(yt);const i="3d"===e.type?e.resourceController:void 0;null!==(t=this.queue)&&void 0!==t&&t.destroy(),this.queue=Ee(null===i||void 0===i?void 0:i.scheduler);const n=null===i||void 0===i?void 0:i.addUpdatingObject(this);n&&this.addHandles(n,yt)}),a.syncAndInitial)),this.tool=new mt({viewModel:this}),this._controller=new Pe({viewModel:this})}destroy(){this._defaultProfileLineGround=(0,r.pR)(this._defaultProfileLineGround),this._controller=(0,r.pR)(this._controller),this._currentTileCache=(0,r.pR)(this._currentTileCache),this.tool=(0,r.pR)(this.tool),this.queue=(0,r.pR)(this.queue)}get profiles(){return this._get("profiles")}set profiles(e){const t=this._get("profiles"),i=null!==e&&void 0!==e?e:new I.A;this._set("profiles",(0,T.V)(i,t))}get state(){const e=this.view;return null!=e&&e.ready?this.tool.state:x.o8.Disabled}get progress(){let e=0,t=0;for(const i of this.visibleProfiles)e++,t+=i.progress;return e>0?t/e:0}set unitOptions(e){this._userUnitOptions=e,this._set("unitOptions",this._filteredOrAllUnits(this._userUnitOptions))}get unitOptions(){return this._filteredOrAllUnits(this._userUnitOptions)}set unit(e){this._userUnit=e?this._findSelectableUnit(e,this._userUnit):null,this.notifyChange("unit")}get unit(){return this._userUnit?(this._userUnit=this._findSelectableUnit(this._userUnit,this.defaultUnit),this._userUnit):this._findSelectableUnit(this.defaultUnit)}get effectiveUnits(){const e=function(e){var t,i,n;let s=null,r=null,o=null;for(const l of e){if(null==l)continue;const{statistics:e,spatialReference:t}=l;if(null==e)continue;const i=(0,k.GA)(t);s=ve(s,ge(e.maxDistance,i));const n=(0,k.G9)(t);o=_e(o,ge(e.minElevation,n)),r=ve(r,ge(e.maxElevation,n))}return{minDistance:0,maxDistance:null!==(t=s)&&void 0!==t?t:0,minElevation:null!==(i=o)&&void 0!==i?i:0,maxElevation:null!==(n=r)&&void 0!==n?n:0}}(this.visibleProfiles.map((e=>e.result))),t=(0,k.Vs)(e.maxDistance,"meters",this.unit),i=(0,k.jE)(e.maxElevation,"meters",this.unit);return this._getEffectiveUnitsMemoized(t,i)}get geodesicDistanceThreshold(){return this._get("geodesicDistanceThreshold")}set geodesicDistanceThreshold(e){(0,P.Lx)(u.A.getLogger(this),"geodesicDistanceThreshold",{version:"4.29",warnOnce:!0}),this._set("geodesicDistanceThreshold",e)}get highlightEnabled(){return this.tool.highlightEnabled}set highlightEnabled(e){this.tool.highlightEnabled=e}get hasVertices(){var e;const t=null===(e=this.input)||void 0===e?void 0:e.geometry;return X(t)&&t.paths.reduce(((e,t)=>e+t.length),0)>0}get hoveredPoints(){return null!=this.input&&this.visible&&this.tool.editable?this.visibleProfiles.map((e=>{const t=e.hoveredPoint;return null!=t?{hoveredPoint:t,color:e.color}:null})).filter(C.Ru):[]}get statistics(){return function(e){const t=e.filter(C.Ru),i=t.length;if(0===i)return null;const n=t[0];if(1===i)return n;let s=n.maxDistance,r=n.minElevation,o=n.maxElevation,l=n.maxPositiveSlope,a=n.maxNegativeSlope;for(let c=1;c<t.length;++c){const e=t[c];s=ve(s,e.maxDistance),r=_e(r,e.minElevation),o=ve(o,e.maxElevation),l=ve(l,e.maxPositiveSlope),a=ve(a,e.maxNegativeSlope)}return{maxDistance:s,minElevation:r,maxElevation:o,avgElevation:null,elevationGain:null,elevationLoss:null,maxPositiveSlope:l,maxNegativeSlope:a,avgPositiveSlope:null,avgNegativeSlope:null}}(this.visibleProfiles.map((e=>e.statistics)))}get chartData(){if(null==this.input)return null;const{effectiveUnits:e,progress:t,statistics:i,visibleProfiles:n,uniformChartScaling:s}=this,r=n.filter((e=>e.hasZ)).map((e=>({id:e.id,type:e.type,title:e.title,color:e.color,samples:e.samples,progress:e.progress,chartFillEnabled:e.chartFillEnabled,chartStrokeWidth:e.chartStrokeWidth,chartStrokeOffsetY:e.chartStrokeOffsetY,viewVisualizationEnabled:e.viewVisualizationEnabled})));return 0===r.length?null:{lines:r,effectiveUnits:e,statistics:i,refined:1===t,dynamicElevationRange:n.some((e=>"view"===e.type)),uniformScaling:s}}get visibleProfiles(){return this.profiles.toArray().filter((e=>e.available&&e.visible))}get minDemResolutions(){const e=[];for(const{minDemResolution:t}of this.visibleProfiles)null!=t&&e.push(t);return e}get minDemResolution(){return(0,C.jk)(this.minDemResolutions)}get errorState(){var e;if(!$(null===(e=this.input)||void 0===e?void 0:e.geometry))return x.GJ.NoValidInput;if(null!=this.error){if(function(e){return e.type===H}(this.error))switch(this.error.cause){case q.TooComplex:return x.GJ.TooComplex;case q.InvalidGeometry:return x.GJ.InvalidGeometry;case q.InvalidElevationInfo:return x.GJ.InvalidElevationInfo;case q.ElevationQueryError:return x.GJ.NoValidInput}return x.GJ.UnknownError}return 0===this.visibleProfiles.length?x.GJ.NoVisibleProfiles:null==this.chartData&&1===this.progress?x.GJ.RefinedButNoChartData:x.GJ.None}get tileCache(){this._currentTileCache=(0,r.pR)(this._currentTileCache);const e=this.view;if(null!=e&&"3d"===(null===e||void 0===e?void 0:e.type)){var t;const i=null===(t=e.basemapTerrain)||void 0===t?void 0:t.elevationQueryCache;if(null!=i)return i}return null==this._currentTileCache&&(this._currentTileCache=new A.E(new R.q(20*M.u.MEGABYTES))),this._currentTileCache}get visible(){return this.tool.visible}set visible(e){this.tool.visible=e}get inputIsSketched(){return this.tool.interaction.isSketchedGraphic(this.input)}get elevationProvider(){const e=this.view;return null!=e&&"3d"===e.type?e.elevationProvider:null}get updating(){var e;const{progress:t}=this,i=!(null===(e=this.queue)||void 0===e||!e.updating);return t>0&&t<1||i}start(e){this.tool.interaction.start(e)}stop(){this.tool.interaction.stop()}cancel(){this.tool.interaction.cancel()}clear(){this.tool.interaction.clear()}_findSelectableUnit(e,t){const i=this.unitOptions;return null!=e&&i.includes(e)?e:t?this._findSelectableUnit(t):i[0]}_filteredOrAllUnits(e){const t=(null!=e?e:[]).filter((e=>k.GB.includes(e)));return 0===t.length?k.GB.slice():t}};(0,n._)([(0,c.MZ)()],ft.prototype,"view",void 0),(0,n._)([(0,c.MZ)({type:w.A})],ft.prototype,"input",void 0),(0,n._)([(0,c.MZ)({type:ot,nonNullable:!0})],ft.prototype,"profiles",null),(0,n._)([(0,c.MZ)({readOnly:!0})],ft.prototype,"state",null),(0,n._)([(0,c.MZ)({readOnly:!0})],ft.prototype,"progress",null),(0,n._)([(0,c.MZ)()],ft.prototype,"unitOptions",null),(0,n._)([(0,c.MZ)()],ft.prototype,"unit",null),(0,n._)([(0,c.MZ)({readOnly:!0})],ft.prototype,"effectiveUnits",null),(0,n._)([(0,c.MZ)()],ft.prototype,"geodesicDistanceThreshold",null),(0,n._)([(0,c.MZ)()],ft.prototype,"hoveredChartPosition",void 0),(0,n._)([(0,c.MZ)()],ft.prototype,"uniformChartScaling",void 0),(0,n._)([(0,c.MZ)()],ft.prototype,"highlightEnabled",null),(0,n._)([(0,c.MZ)({readOnly:!0})],ft.prototype,"hoveredPoints",null),(0,n._)([(0,c.MZ)({readOnly:!0})],ft.prototype,"statistics",null),(0,n._)([(0,c.MZ)()],ft.prototype,"chartData",null),(0,n._)([(0,c.MZ)()],ft.prototype,"visibleProfiles",null),(0,n._)([(0,c.MZ)()],ft.prototype,"minDemResolutions",null),(0,n._)([(0,c.MZ)({readOnly:!0})],ft.prototype,"minDemResolution",null),(0,n._)([(0,c.MZ)({readOnly:!0})],ft.prototype,"errorState",null),(0,n._)([(0,c.MZ)(U.q)],ft.prototype,"defaultUnit",void 0),(0,n._)([(0,c.MZ)()],ft.prototype,"queue",void 0),(0,n._)([(0,c.MZ)()],ft.prototype,"tileCache",null),(0,n._)([(0,c.MZ)()],ft.prototype,"tool",void 0),(0,n._)([(0,c.MZ)()],ft.prototype,"visible",null),(0,n._)([(0,c.MZ)()],ft.prototype,"error",void 0),(0,n._)([(0,c.MZ)()],ft.prototype,"inputIsSketched",null),(0,n._)([(0,c.MZ)()],ft.prototype,"elevationProvider",null),(0,n._)([(0,c.MZ)()],ft.prototype,"updating",null),(0,n._)([(0,c.MZ)()],ft.prototype,"_defaultProfileLineGround",void 0),(0,n._)([(0,c.MZ)()],ft.prototype,"_userUnitOptions",void 0),(0,n._)([(0,c.MZ)()],ft.prototype,"_controller",void 0),(0,n._)([(0,c.MZ)()],ft.prototype,"_userUnit",void 0),ft=(0,n._)([(0,h.$)("esri.widgets.ElevationProfile.ElevationProfileViewModel")],ft);const yt=Symbol("updating-object"),bt=ft;let Et=class extends S.A{constructor(){super(...arguments),this.legend=!0,this.chart=!0,this.clearButton=!0,this.settingsButton=!0,this.sketchButton=!0,this.selectButton=!0,this.unitSelector=!0,this.uniformChartScalingToggle=!0}};(0,n._)([(0,c.MZ)()],Et.prototype,"legend",void 0),(0,n._)([(0,c.MZ)()],Et.prototype,"chart",void 0),(0,n._)([(0,c.MZ)()],Et.prototype,"clearButton",void 0),(0,n._)([(0,c.MZ)()],Et.prototype,"settingsButton",void 0),(0,n._)([(0,c.MZ)()],Et.prototype,"sketchButton",void 0),(0,n._)([(0,c.MZ)()],Et.prototype,"selectButton",void 0),(0,n._)([(0,c.MZ)()],Et.prototype,"unitSelector",void 0),(0,n._)([(0,c.MZ)()],Et.prototype,"uniformChartScalingToggle",void 0),Et=(0,n._)([(0,h.$)("esri.widgets.ElevationProfile.ElevationProfileVisibleElements")],Et);const wt=Et;i(11265);var St=i(96820),Ct=i(77666),Mt=i(76099),It=i(63582),Tt=i(54761);let Pt=class extends d.A{constructor(e,t){super(e,t),this._updateLayout=e=>{const t=e.parentElement,i=e.style.display;null!==t&&void 0!==t&&t.removeChild(e),document.body.appendChild(e),e.style.display="block";let n=80;for(const s of e.childNodes)s instanceof HTMLElement&&(n=Math.max(n,s.offsetWidth));document.body.removeChild(e),null!==t&&void 0!==t&&t.appendChild(e),e.style.display=i,e.style.setProperty("--max-width","".concat(n,"px"))},this._updateLayoutThrottled=(0,D.n)(this._updateLayout,100)}loadDependencies(){return(0,Ct.W)({icon:()=>Promise.all([i.e(39879),i.e(95012)]).then(i.bind(i,95012))})}initialize(){this.addHandles(this._updateLayoutThrottled)}render(){return(0,Tt.K)("div",{afterCreate:this._updateLayout,afterUpdate:this._updateLayoutThrottled,bind:this,class:y.base},this._renderStatistics())}_renderStatistics(){var e;const t=null===(e=this._messages)||void 0===e?void 0:e.statistics;return t?[this._renderDistanceStatistic("maxDistance",t.maxDistance),this._renderElevationStatistic("elevationGain",t.gain),this._renderElevationStatistic("elevationLoss",t.loss),this._renderElevationStatistic("minElevation",t.minElevation),this._renderElevationStatistic("maxElevation",t.maxElevation),this._renderElevationStatistic("avgElevation",t.avgElevation),this._renderSlopeStatistic("maxPositiveSlope","maxNegativeSlope",t.maxSlope),this._renderSlopeStatistic("avgPositiveSlope","avgNegativeSlope",t.avgSlope)]:[]}_renderDistanceStatistic(e,t){const i=(0,x.zj)().formatPrecision,n=this._renderValue(e,(e=>{const t=this.effectiveUnits.distance;return(0,St.zJ)(this._messagesUnits,e,t,i)}));return this._renderStatistic(t,n)}_renderElevationStatistic(e,t){const i=(0,x.zj)().formatPrecision,n=this._renderValue(e,(e=>{const t=this.effectiveUnits.elevation;return(0,St.zJ)(this._messagesUnits,e,t,i)}));return this._renderStatistic(t,n)}_renderSlopeStatistic(e,t,i){const n=(0,x.zj)().formatPrecision,s=(0,Tt.K)("div",{class:y.slopeValue,key:"slope-up"},(0,Tt.K)("calcite-icon",{icon:"arrow-up",scale:"s"}),this._renderValue(e,(e=>(0,St.Me)(e,"degrees","geographic","geographic",n))),(0,Tt.K)("calcite-icon",{icon:"arrow-down",scale:"s"}),this._renderValue(t,(e=>(0,St.Me)(e,"degrees","geographic","geographic",n))));return this._renderStatistic(i,s)}_renderStatistic(e,t){return(0,Tt.K)("div",{class:y.statistic},(0,Tt.K)("label",{class:y.statisticLabel},e),(0,Tt.K)("div",{class:y.statisticValue},t))}_renderValue(e,t){const i=this.line,n=1===i.progress?i.statistics:null,s=null===n||void 0===n?void 0:n[e];return null!=s?t(s):x.Fc}};(0,n._)([(0,c.MZ)()],Pt.prototype,"effectiveUnits",void 0),(0,n._)([(0,c.MZ)()],Pt.prototype,"line",void 0),(0,n._)([(0,c.MZ)(),(0,It.G)("esri/widgets/ElevationProfile/t9n/ElevationProfile")],Pt.prototype,"_messages",void 0),(0,n._)([(0,c.MZ)(),(0,It.G)("esri/core/t9n/Units")],Pt.prototype,"_messagesUnits",void 0),Pt=(0,n._)([(0,h.$)("esri.widgets.ElevationProfile.Statistics")],Pt);var Rt=i(47927),kt=i(39348);let At=class extends d.A{constructor(e,t){super(e,t),this.checkboxVisible=!0,this.expanded=!1}loadDependencies(){return(0,Ct.W)({action:()=>Promise.all([i.e(39879),i.e(62785),i.e(48897),i.e(37918)]).then(i.bind(i,92111)),checkbox:()=>Promise.all([i.e(39879),i.e(95203),i.e(92022)]).then(i.bind(i,92022)),label:()=>Promise.all([i.e(39879),i.e(65423)]).then(i.bind(i,65423)),tooltip:()=>Promise.all([i.e(39879),i.e(48347),i.e(73786)]).then(i.bind(i,73786))})}initialize(){this._statistics=new Pt(this._statisticsProps),this.addHandles((0,a.watch)((()=>this._statisticsProps),(e=>this._statistics.set(e))))}destroy(){this._statistics=(0,r.pR)(this._statistics)}render(){const e=this.expanded;return(0,Tt.K)("div",{class:this.classes(m.base,{[m.disabled]:this.disabled,[m.expanded]:e}),key:this},this._renderColorIndicator(),(0,Tt.K)("div",{class:m.header,key:"header"},this._renderLabelWithCheckbox(),this._renderCollapseToggleButton()),e?(0,Tt.K)("div",{class:m.content,key:"content"},this._statistics.render()):null)}get disabled(){return!this.line.available}get _statisticsProps(){return{line:this.line,effectiveUnits:this.effectiveUnits}}_renderColorIndicator(){return(0,Tt.K)("div",{class:m.colorIndicator,key:"color-indicator",styles:{backgroundColor:this.line.color.toCss()}})}_renderCollapseToggleButton(){const{expanded:e,messages:t}=this,i=e?t.hideDetails:t.showDetails;return(0,Tt.K)("calcite-action",{appearance:"transparent",bind:this,class:m.collapseToggle,"data-testid":"legend-toggle",icon:e?"chevron-up":"chevron-down",key:"collapse-toggle",onclick:this._onCollapseToggleClick,scale:"s",text:i})}_onCollapseToggleClick(){this.onExpandedToggle()}_renderLabelWithCheckbox(){const{line:e,checkboxVisible:t,disabled:i,messages:n}=this,s="label-".concat(e.id);return(0,Tt.K)("calcite-label",{class:m.label,disabled:i,key:s,layout:"inline"},t?this._renderCheckbox(e.id):null,(0,Rt.l)(e,n))}_renderCheckbox(e){const{disabled:t,line:i,messages:n}=this,s=i.visible,r="".concat(e,"-checkbox"),o=s?n.hideProfile:n.showProfile,l=(0,kt.V)(o,{name:(0,Rt.l)(i,n)});return(0,Tt.K)(Tt.w,null,(0,Tt.K)("calcite-checkbox",{checked:s,class:m.checkbox,disabled:t,id:r,key:"checkbox",onCalciteCheckboxChange:()=>i.toggleVisibility()}),(0,Tt.K)("calcite-tooltip",{overlayPositioning:"fixed",placement:"top",referenceElement:r},l))}};(0,n._)([(0,c.MZ)()],At.prototype,"checkboxVisible",void 0),(0,n._)([(0,c.MZ)()],At.prototype,"disabled",null),(0,n._)([(0,c.MZ)({nonNullable:!0})],At.prototype,"effectiveUnits",void 0),(0,n._)([(0,c.MZ)()],At.prototype,"expanded",void 0),(0,n._)([(0,c.MZ)({nonNullable:!0})],At.prototype,"line",void 0),(0,n._)([(0,c.MZ)()],At.prototype,"messages",void 0),(0,n._)([(0,c.MZ)()],At.prototype,"onExpandedToggle",void 0),(0,n._)([(0,c.MZ)()],At.prototype,"_statistics",void 0),At=(0,n._)([(0,h.$)("esri.widgets.ElevationProfile.LegendItem")],At);let Ut=class extends d.A{constructor(){super(...arguments),this._expandedLine=null}render(){const{profiles:e,messages:t,effectiveUnits:i,_expandedLine:n}=this;return(0,Tt.K)("div",{class:v},e.map((s=>(0,Tt.K)(At,{checkboxVisible:e.length>1,effectiveUnits:i,expanded:s===n,line:s,messages:t,onExpandedToggle:()=>this._onExpandedToggle(s)}))))}_onExpandedToggle(e){this._expandedLine=e===this._expandedLine?null:e}};(0,n._)([(0,c.MZ)()],Ut.prototype,"effectiveUnits",void 0),(0,n._)([(0,c.MZ)()],Ut.prototype,"messages",void 0),(0,n._)([(0,c.MZ)()],Ut.prototype,"profiles",void 0),(0,n._)([(0,c.MZ)()],Ut.prototype,"_expandedLine",void 0),Ut=(0,n._)([(0,h.$)("esri.widgets.ElevationProfile.components.Legend")],Ut);var Lt=i(47370);let Dt=class extends d.A{constructor(){super(...arguments),this.messages=null,this._popover=null,this._popoverIsOpen=!1,this._onPopoverAfterCreate=e=>{this._popover=e},this._onUniformChartScalingChange=e=>{this.onUniformChartScalingChange(e.target.checked)}}loadDependencies(){return(0,Ct.W)({action:()=>Promise.all([i.e(39879),i.e(62785),i.e(48897),i.e(37918)]).then(i.bind(i,92111)),checkbox:()=>Promise.all([i.e(39879),i.e(95203),i.e(92022)]).then(i.bind(i,92022)),label:()=>Promise.all([i.e(39879),i.e(65423)]).then(i.bind(i,65423)),popover:()=>Promise.all([i.e(39879),i.e(62785),i.e(48347),i.e(60731),i.e(48897),i.e(53794),i.e(42821)]).then(i.bind(i,72552)),tooltip:()=>Promise.all([i.e(39879),i.e(48347),i.e(73786)]).then(i.bind(i,73786))})}initialize(){const e=()=>this._popover;this.addHandles([(0,a.on)(e,"calcitePopoverOpen",(()=>this._popoverIsOpen=!0)),(0,a.on)(e,"calcitePopoverClose",(()=>this._popoverIsOpen=!1))])}render(){const{id:e,messages:t,visibleElements:i}=this,{unitSelector:n,uniformChartScalingToggle:s}=i;if(!t||!n&&!s)return(0,Tt.K)("div",{key:"".concat(e,"-empty")});const r="".concat(e,"__action"),o=this._popoverIsOpen?t.hideSettings:t.showSettings;return(0,Tt.K)("div",{class:E.base,key:this},(0,Tt.K)("calcite-popover",{afterCreate:this._onPopoverAfterCreate,autoClose:!0,label:o,overlayPositioning:"fixed",placement:"bottom-end",referenceElement:r},this._renderPopoverContent()),(0,Tt.K)("calcite-action",{appearance:"transparent","data-testid":"settings-button",icon:"gear",id:r,label:o,scale:"s",text:o}))}_renderPopoverContent(){const{unitSelector:e,uniformChartScalingToggle:t}=this.visibleElements;return(0,Tt.K)("div",{class:E.popoverContent},e?this._renderUnitSelector():null,t?this._renderUniformChartScalingToggle():null)}_renderUnitSelector(){var e;const{messages:t}=this;return(0,Tt.K)(Lt.t,{key:"unit-selector-label",options:this.unitOptions,selectLabel:null!==(e=null===t||void 0===t?void 0:t.unitSelectLabel)&&void 0!==e?e:"",value:this.unit,onChange:this.onUnitChange})}_renderUniformChartScalingToggle(){var e;const{messages:t}=this,i=this.uniformChartScaling,n="".concat(this.id,"__uniform-chart-scaling-toggle"),s=null!==(e=null===t||void 0===t?void 0:t[i?"uniformChartScalingDisable":"uniformChartScalingEnable"])&&void 0!==e?e:"";return(0,Tt.K)("calcite-label",{class:E.uniformChartScalingLabel,key:"uniform-chart-scaling-label",layout:"inline"},(0,Tt.K)("calcite-checkbox",{checked:i,class:E.uniformChartScalingCheckbox,id:n,onCalciteCheckboxChange:this._onUniformChartScalingChange}),(0,Tt.K)("calcite-tooltip",{overlayPositioning:"fixed",referenceElement:n},s),null===t||void 0===t?void 0:t.uniformChartScalingLabel)}};(0,n._)([(0,c.MZ)()],Dt.prototype,"messages",void 0),(0,n._)([(0,c.MZ)()],Dt.prototype,"onUniformChartScalingChange",void 0),(0,n._)([(0,c.MZ)()],Dt.prototype,"onUnitChange",void 0),(0,n._)([(0,c.MZ)()],Dt.prototype,"uniformChartScaling",void 0),(0,n._)([(0,c.MZ)()],Dt.prototype,"unit",void 0),(0,n._)([(0,c.MZ)()],Dt.prototype,"unitOptions",void 0),(0,n._)([(0,c.MZ)()],Dt.prototype,"visibleElements",void 0),(0,n._)([(0,c.MZ)()],Dt.prototype,"_popover",void 0),(0,n._)([(0,c.MZ)()],Dt.prototype,"_popoverIsOpen",void 0),Dt=(0,n._)([(0,h.$)("esri.widgets.ElevationProfile.components.SettingsButton")],Dt);var Zt,xt=i(98108);!function(e){e.Sketch="sketch",e.SketchCancel="sketch-cancel",e.SketchDone="sketch-done",e.Select="select",e.SelectCancel="select-cancel"}(Zt||(Zt={}));const Ot=[{type:Zt.Select},{type:Zt.Sketch}],Nt={[x.GJ.None]:null,[x.GJ.NoValidInput]:"noProfile",[x.GJ.NoVisibleProfiles]:"noProfile",[x.GJ.RefinedButNoChartData]:"noProfile",[x.GJ.TooComplex]:"tooComplex",[x.GJ.UnknownError]:"unknown",[x.GJ.InvalidGeometry]:"invalidGeometry",[x.GJ.InvalidElevationInfo]:"invalidElevationInfo"},Gt=Symbol("resize-observer-handle");let Vt=class extends d.A{constructor(e,t){super(e,t),this.viewModel=null,this.visibleElements=new wt,this.iconClass=_.widgetIcon,this.icon=null,this.messages=null,this.messagesCommon=null,this.messagesUnits=null,this._chartContainer=null,this._chart=null,this._chartInitTask=null,this._chartIsRefined=!1,this._width=0,this._zoomOutButtonVisible=!1,this._getChartUpdateParamsMemoized=(0,o.B)(((e,t,i,n)=>({chart:e,data:t,stationary:i,messages:n}))),this._onZoomOutButtonClick=()=>{var e;null===(e=this._chart)||void 0===e||e.zoomOut()},this._onClearButtonClick=()=>{this.viewModel.clear()},(null===e||void 0===e?void 0:e.viewModel)||(this._defaultViewModel=new bt({view:null===e||void 0===e?void 0:e.view}),this.viewModel=this._defaultViewModel)}loadDependencies(){return(0,Ct.W)({action:()=>Promise.all([i.e(39879),i.e(62785),i.e(48897),i.e(37918)]).then(i.bind(i,92111)),button:()=>Promise.all([i.e(39879),i.e(62785),i.e(95203),i.e(75151),i.e(11309)]).then(i.bind(i,11309)),loader:()=>i.e(76454).then(i.bind(i,76454))})}postInitialize(){this.addHandles([(0,a.watch)((()=>({container:this._chartContainer,width:this._width})),(e=>{let{container:t,width:i}=e;this._destroyChart(),null!=t&&i>0&&this._initializeChart(t)}),a.initial),(0,a.watch)((()=>this._chartUpdateParams),(()=>this._updateChart(this._chartUpdateParams)),a.initial)])}destroy(){this._destroyChart(),null!=this._defaultViewModel&&this.viewModel!==this._defaultViewModel&&this._defaultViewModel.destroy()}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get input(){return this.viewModel.input}set input(e){this.viewModel.input=e}get profiles(){return this.viewModel.profiles}set profiles(e){this.viewModel.profiles=e}get unitOptions(){return this.viewModel.unitOptions}set unitOptions(e){this.viewModel.unitOptions=e}get unit(){return this.viewModel.unit}set unit(e){this.viewModel.unit=e}get geodesicDistanceThreshold(){return this.viewModel.geodesicDistanceThreshold}set geodesicDistanceThreshold(e){this.viewModel.geodesicDistanceThreshold=e}get label(){var e,t;return null!==(e=null===(t=this.messages)||void 0===t?void 0:t.widgetLabel)&&void 0!==e?e:""}set label(e){this._overrideIfSome("label",e)}get visible(){return this.viewModel.visible}set visible(e){this.viewModel.visible=e}get _portrait(){return this._width<(0,x.zj)().portraitModePixelBreakpoint}get _chartUpdateParams(){const e=this.view;return this._getChartUpdateParamsMemoized(this._chart,this.viewModel.chartData,null==e||e.stationary,this._chartMessages)}get _chartMessages(){return{...this.messagesUnits,...this.messages}}get _profilesArray(){return this.profiles.toArray()}render(){const{viewModel:e,visible:t}=this;return(0,Tt.K)("div",{"aria-label":this.messages.widgetLabel,class:this.classes({[_.base]:t,[xt.D.widget]:t,[xt.D.panel]:t,[xt.D.widgetDisabled]:t&&"disabled"===e.state,[_.portrait]:this._portrait,[_.refined]:1===e.progress}),key:this},(0,Tt.K)("div",{afterCreate:this._onContentWrapperAfterCreate,afterRemoved:this._onContentWrapperRemoved,bind:this,key:"content-wrapper"},t?this._renderContentForState():null))}_renderContentForState(){switch(this.viewModel.state){case x.o8.Ready:return this._renderContentForReadyState();case x.o8.Selecting:return this._renderContentForSelectingState();case x.o8.Creating:return this._renderContentForCreatingState();case x.o8.Selected:return this._renderContentForSelectedState();case x.o8.Created:return this._renderContentForCreatedState();case x.o8.Disabled:return this._renderContentForReadyState()}}_renderContentForReadyState(){var e;const{sketchButton:t,selectButton:i}=this.visibleElements,n=this.messages;let s;return s=t&&i?n.readyPrompt:t?n.readyPromptCreateOnly:i?n.readyPromptSelectOnly:null===(e=n.errors)||void 0===e?void 0:e.noProfile,this._renderContent({prompt:s,chart:!1,actions:Ot})}_renderContentForSelectingState(){const e=this.view;if(null==e)return null;const t=this.messages["selectingPrompt-".concat(e.type)];return this._renderContent({prompt:t,chart:!1,actions:[{type:Zt.SelectCancel}]})}_renderContentForCreatingState(){const{view:e,viewModel:t}=this;if(null==e)return null;const i=t.hasVertices?[{type:Zt.SketchCancel},{type:Zt.SketchDone,disabled:!t.tool.interaction.canStopCreating}]:[{type:Zt.Select},{type:Zt.Sketch,disabled:!0}];if(t.errorState===x.GJ.NoValidInput){const t=this.messages["creatingPrompt-".concat(e.type)];return this._renderContent({chart:!1,actions:i,prompt:t})}const n=this._getErrorMessage();return n?this._renderContent({chart:!1,actions:i,prompt:n}):this._renderContent({chart:!0,actions:i})}_renderContentForSelectedState(){const e=this._getErrorMessage();return e?this._renderContent({chart:!1,actions:Ot,prompt:e}):this._renderContent({chart:!0,actions:Ot})}_renderContentForCreatedState(){const e=this._getErrorMessage();return e?this._renderContent({chart:!1,actions:Ot,prompt:e}):this._renderContent({chart:!0,actions:Ot})}_getErrorMessage(){var e;const t=Nt[this.viewModel.errorState];return t?null===(e=this.messages)||void 0===e||null===(e=e.errors)||void 0===e?void 0:e[t]:null}_renderContent(e){const t=null!=e.prompt?this._renderPrompt(e.prompt):e.chart&&this._renderChart(),{viewModel:i}=this,n=null!=i.input;return(0,Tt.K)(Tt.w,null,(0,Tt.K)("header",{class:_.header,key:"header"},this._zoomOutButtonVisible?this._renderZoomOutButton():null,this.visibleElements.clearButton&&n?this._renderClearButton():null,this.visibleElements.settingsButton?(0,Tt.K)(Dt,{messages:this.messages,uniformChartScaling:i.uniformChartScaling,unit:i.unit,unitOptions:i.unitOptions,visibleElements:this.visibleElements,onUniformChartScalingChange:e=>i.uniformChartScaling=e,onUnitChange:e=>i.unit=e}):null),(0,Tt.K)("div",{class:_.mainContainer,key:"main-container"},t),this.visibleElements.legend?(0,Tt.K)(Ut,{effectiveUnits:i.effectiveUnits,messages:this.messages,profiles:this._profilesArray}):null,this._renderActions(e))}_renderZoomOutButton(){return(0,Tt.K)("calcite-action",{appearance:"transparent",class:_.zoomOutButton,"data-testid":"zoom-out-button",icon:"magnifying-glass-minus",key:"zoom-out",onclick:this._onZoomOutButtonClick,scale:"s",text:this.messages.zoomOut})}_renderClearButton(){return(0,Tt.K)("calcite-action",{appearance:"transparent",class:_.clearButton,"data-testid":"clear-button",icon:"trash",key:"clear-profile",onclick:this._onClearButtonClick,scale:"s",text:this.messages.clearProfile})}_renderPrompt(e){return[(0,Tt.K)("div",{bind:this,class:_.promptContainer,key:"prompt-container"},(0,Tt.K)("p",null,e))]}_renderChart(){if(!this.visibleElements.chart)return(0,Tt.K)("div",{class:_.chartContainer,key:"empty-chart-container"});const{chartData:e,progress:t}=this.viewModel,i=this._chartIsRefined||this._canRenderChart(),n=null!=e&&t<1;return i?(0,Tt.K)(Tt.w,null,this._renderSpinner({size:i?"small":"large",visible:n}),(0,Tt.K)("div",{afterCreate:this._onChartContainerAfterCreate,afterRemoved:this._onChartContainerRemoved,bind:this,class:_.chartContainer,key:"chart-container"})):(0,Tt.K)(Tt.w,null,this._renderSpinner({size:"large",visible:n}),(0,Tt.K)("div",{class:_.chartContainer,key:"chart-container-empty"}))}_renderSpinner(e){var t;const i="small"===e.size,n=null===(t=e.visible)||void 0===t||t;return(0,Tt.K)("calcite-loader",{class:this.classes(_.chartSpinner,i&&_.chartSpinnerSmall,n&&_.chartSpinnerVisible),inline:i,key:"spinner",label:"",scale:"s"})}_canRenderChart(){const e=this.viewModel.chartData;if(null==e)return!1;if(!this.viewModel.inputIsSketched)return e.refined;let t=0;for(const{samples:i}of e.lines)t+=null!=i?i.length:0;return e.refined||t<=(0,x.zj)().largeChartSamples}_renderActions(e){let{actions:t}=e;const i=t.map((e=>{switch(e.type){case Zt.Sketch:return this.visibleElements.sketchButton&&this._renderAction({action:e,className:_.sketchButton,label:this.messages.sketchButtonLabel,onClick:this._onSketchButtonClick,primary:!0});case Zt.SketchCancel:return this.visibleElements.sketchButton&&this._renderAction({action:e,onClick:this._onCancelButtonClick,className:_.sketchCancelButton,label:this.messagesCommon.cancel,primary:!1});case Zt.SketchDone:return this.visibleElements.sketchButton&&this._renderAction({action:e,onClick:this._onDoneButtonClick,className:_.sketchDoneButton,label:this.messagesCommon.done,primary:!0});case Zt.Select:return this.visibleElements.selectButton&&this._renderAction({action:e,onClick:this._onSelectButtonClick,className:_.selectButton,label:this.messages.selectButtonLabel,primary:!1});case Zt.SelectCancel:return this.visibleElements.selectButton&&this._renderAction({action:e,onClick:this._onCancelButtonClick,className:_.selectCancelButton,label:this.messagesCommon.cancel,primary:!1})}})).filter(Boolean);return i.length?(0,Tt.K)("footer",{class:_.footer,key:"footer"},i):null}_renderAction(e){let{action:t,className:i,label:n,onClick:s,primary:r}=e;return(0,Tt.K)("calcite-button",{appearance:r?"solid":"outline-fill",bind:this,class:this.classes(_.actionButton,i),disabled:t.disabled,key:"action-".concat(t.type),onclick:s},n)}_onSketchButtonClick(){this.viewModel.start({mode:"sketch"})}_onSelectButtonClick(){this.viewModel.start({mode:"select"})}_onCancelButtonClick(){this.viewModel.cancel()}_onDoneButtonClick(){this.viewModel.stop()}_onContentWrapperAfterCreate(e){const t=(0,Mt.EV)(e,(e=>{this._width=e.contentRect.width}));this.addHandles(t,Gt)}_onContentWrapperRemoved(){this.removeHandles(Gt)}_updateChart(e){const{data:t,chart:i,messages:n,stationary:s}=e;null!=i&&null!=n&&s&&this._canRenderChart()&&(i.update(e),this._chartIsRefined=null!=t&&t.refined)}_onChartContainerAfterCreate(e){this._chartContainer=e}_onChartContainerRemoved(){this._chartContainer=null}_initializeChart(e){(0,r.DC)(this._chartInitTask),this._chartInitTask=(0,s.UT)((async t=>{const{createChart:n}=await Promise.all([i.e(73318),i.e(42225),i.e(63397),i.e(93640),i.e(14133)]).then(i.bind(i,14133));(0,l.Te)(t);const s=await n({container:e,abortOptions:{signal:t},onRangeChange:(e,t)=>{this._zoomOutButtonVisible=1!==e||1!==t},onCursorPositionChange:e=>{this.viewModel.hoveredChartPosition=e}});if(t.aborted)throw(0,r.pR)(s),(0,l.NK)();this._chart=s,this._updateChart(this._chartUpdateParams)}))}_destroyChart(){this._chartInitTask=(0,r.DC)(this._chartInitTask),this._chart=(0,r.pR)(this._chart),this._chartIsRefined=!1}};(0,n._)([(0,c.MZ)({type:bt})],Vt.prototype,"viewModel",void 0),(0,n._)([(0,c.MZ)()],Vt.prototype,"view",null),(0,n._)([(0,c.MZ)()],Vt.prototype,"input",null),(0,n._)([(0,c.MZ)()],Vt.prototype,"profiles",null),(0,n._)([(0,c.MZ)()],Vt.prototype,"unitOptions",null),(0,n._)([(0,c.MZ)()],Vt.prototype,"unit",null),(0,n._)([(0,c.MZ)()],Vt.prototype,"geodesicDistanceThreshold",null),(0,n._)([(0,c.MZ)({type:wt,nonNullable:!0})],Vt.prototype,"visibleElements",void 0),(0,n._)([(0,c.MZ)()],Vt.prototype,"iconClass",void 0),(0,n._)([(0,c.MZ)()],Vt.prototype,"icon",void 0),(0,n._)([(0,c.MZ)()],Vt.prototype,"label",null),(0,n._)([(0,c.MZ)()],Vt.prototype,"visible",null),(0,n._)([(0,c.MZ)(),(0,It.G)("esri/widgets/ElevationProfile/t9n/ElevationProfile")],Vt.prototype,"messages",void 0),(0,n._)([(0,c.MZ)(),(0,It.G)("esri/t9n/common")],Vt.prototype,"messagesCommon",void 0),(0,n._)([(0,c.MZ)(),(0,It.G)("esri/core/t9n/Units")],Vt.prototype,"messagesUnits",void 0),(0,n._)([(0,c.MZ)()],Vt.prototype,"_chartContainer",void 0),(0,n._)([(0,c.MZ)()],Vt.prototype,"_chart",void 0),(0,n._)([(0,c.MZ)()],Vt.prototype,"_chartInitTask",void 0),(0,n._)([(0,c.MZ)()],Vt.prototype,"_chartIsRefined",void 0),(0,n._)([(0,c.MZ)()],Vt.prototype,"_width",void 0),(0,n._)([(0,c.MZ)()],Vt.prototype,"_portrait",null),(0,n._)([(0,c.MZ)()],Vt.prototype,"_zoomOutButtonVisible",void 0),(0,n._)([(0,c.MZ)()],Vt.prototype,"_chartUpdateParams",null),(0,n._)([(0,c.MZ)()],Vt.prototype,"_chartMessages",null),(0,n._)([(0,c.MZ)()],Vt.prototype,"_profilesArray",null),Vt=(0,n._)([(0,h.$)("esri.widgets.ElevationProfile")],Vt);const Bt=Vt},54054:(e,t,i)=>{i.d(t,{Fc:()=>h,GJ:()=>s,WG:()=>d,o8:()=>n,zj:()=>u});var n,s,r,o=i(31633),l=i(55855),a=i(45463);(r=n||(n={})).Disabled="disabled",r.Ready="ready",r.Creating="creating",r.Created="created",r.Selecting="selecting",r.Selected="selected",function(e){e.NoValidInput="no-valid-input",e.NoVisibleProfiles="no-visible-profiles",e.InvalidGeometry="invalid-geometry",e.TooComplex="too-complex",e.InvalidElevationInfo="invalid-elevation-info",e.UnknownError="unknown-error",e.RefinedButNoChartData="refined-but-no-chart-data",e.None="none"}(s||(s={}));let c={noDataValue:-5e5,defaultQueryOptions:()=>({noDataValue:c.noDataValue,demResolution:"auto",maximumAutoTileRequests:150,ignoreInvisibleLayers:!0}),updateThrottleMillis:100,delayAfterPreviewMillis:500,defaultDemResolution:(0,o.oU)(10,"centimeters","meters"),densificationMaxSamples:3e3,largeChartSamples:1e4,maxTotalSamples:1e5,maxChartRatio:300,minSlopeSampleDistance:10,formatPrecision:1,portraitModePixelBreakpoint:400,profileLinesStyle3D:{width:3,outlineSize:0,falloff:0,outlineColor:(0,l.ci)([1,1,1,0]),renderOccluded:a.m$.Opaque},hoveredPointsStyle:{size:14,borderStyle:"solid",borderWidth:3,borderColor:"#ffffff",boxShadow:"0px 0px 0px 5px rgba(255,255,255,0.2)"}};function u(){return c}const h=" \u2015 ",d={progress:1,hasZ:!1,samples:[],statistics:null,spatialReference:null}},47927:(e,t,i)=>{function n(e,t){let{profiles:i}=t;const n=e.title;if(null!=n)return n;switch(e.type){case"ground":return i.ground;case"input":return i.input;case"query":return i.query;case"view":return i.view;default:return""}}i.d(t,{l:()=>n})},47370:(e,t,i)=>{i.d(t,{t:()=>p});var n=i(35143),s=i(31633),r=i(46053),o=(i(81806),i(76460),i(47249),i(85842)),l=i(25329),a=i(77666),c=(i(76099),i(63582)),u=i(54761);const h="esri-unit-select",d={base:h,label:"".concat(h,"__label"),select:"".concat(h,"__select")};let p=class extends l.A{constructor(e,t){super(e,t),this._onSelectChange=e=>{this.onChange(e.target.value)}}loadDependencies(){return(0,a.W)({label:()=>Promise.all([i.e(39879),i.e(65423)]).then(i.bind(i,65423)),option:()=>i.e(70383).then(i.bind(i,92764)),select:()=>Promise.all([i.e(39879),i.e(95203),i.e(81381)]).then(i.bind(i,81381))})}render(){const{messages:e,options:t,selectLabel:i,value:n,_onSelectChange:r}=this;return(0,u.K)("div",{class:d.base,key:"units"},(0,u.K)("calcite-label",{class:d.label},i,(0,u.K)("calcite-select",{class:d.select,label:i,onCalciteSelectChange:r},t.map((t=>{var i;return(0,u.K)("calcite-option",{key:t,selected:t===n,value:t},(0,s.GT)(t)?e.systems[t]:null===(i=e.units[t])||void 0===i?void 0:i.pluralCapitalized)})))))}};(0,n._)([(0,r.MZ)()],p.prototype,"options",void 0),(0,n._)([(0,r.MZ)()],p.prototype,"onChange",void 0),(0,n._)([(0,r.MZ)()],p.prototype,"selectLabel",void 0),(0,n._)([(0,r.MZ)()],p.prototype,"value",void 0),(0,n._)([(0,r.MZ)(),(0,c.G)("esri/core/t9n/Units")],p.prototype,"messages",void 0),p=(0,n._)([(0,o.$)("esri.widgets.support.UnitSelect")],p)},71587:(e,t,i)=>{function n(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(e>=t)return i;if(i.push(e),t-e<2)return i;const n=t-1;i.push(n);const r=s(e+1,n);for(;;){const e=r.next();if(e.done)break;i.push(e.value)}return i}function*s(e,t){if(e>=t)return;const i=e+Math.floor((t-e)/2);yield i;const n=s(e,i),r=s(i+1,t);for(;;){const e=n.next(),t=r.next();if(e.done&&t.done)break;e.done||(yield e.value),t.done||(yield t.value)}}i.d(t,{s:()=>n})}}]);
//# sourceMappingURL=20693.90010a8f.chunk.js.map