"use strict";(self.webpackChunkhelloworld=self.webpackChunkhelloworld||[]).push([[49963,24648],{17555:(e,t,i)=>{i.d(t,{O:()=>n});const n=()=>window.matchMedia("(prefers-reduced-motion: reduce)").matches},24648:(e,t,i)=>{i.d(t,{IV:()=>v,T9:()=>d,Wq:()=>s,d_:()=>r,g2:()=>u,gT:()=>o,hs:()=>c,iT:()=>h,kM:()=>l,l3:()=>a,n0:()=>f,r7:()=>p});var n=i(31633);function r(e,t){return{type:(0,n.t$)(t),value:e,unit:t}}function o(e,t){return{type:(0,n.t$)(t),value:e,unit:t}}function s(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"arithmetic";return{type:(0,n.t$)(t),value:e,unit:t,rotationType:i}}function l(e,t){const i=a(e,t);return"angle"===e.type?s(i,t,e.rotationType):function(e,t){return{type:(0,n.t$)(t),value:e,unit:t}}(i,t)}function a(e,t){return(0,n.oU)(e.value,e.unit,t)}function d(e,t){return null==e?t:null==t||e.value>(0,n.oU)(t.value,t.unit,e.unit)?e:t}function c(e,t){return null==e?null:{...e,value:e.value*t}}function u(e,t,i){if(t===i)return e;switch(i){case"arithmetic":case"geographic":return 90-e}}const p=r(0,"meters"),h=o(0,"square-meters"),v=(s(0,"radians"),s(0,"degrees")),f=s(0,"degrees","geographic")},79468:(e,t,i)=>{function n(e,t,i,n){let r=null,o=1e3;"number"==typeof t?(o=t,n=i):(r=null!==t&&void 0!==t?t:null,o=i);let s,l=0;const a=()=>{l=0,e.apply(n,s)},d=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];r&&r.apply(n,t),s=t,o?l||(l=setTimeout(a,o)):a()};return d.remove=()=>{l&&(clearTimeout(l),l=0)},d.forceUpdate=()=>{l&&(clearTimeout(l),a())},d.hasPendingUpdates=()=>!!l,d}i.d(t,{n:()=>n})},83828:(e,t,i)=>{i.r(t),i.d(t,{default:()=>me});var n=i(35143),r=(i(11265),i(68134)),o=i(46053),s=i(21403),l=(i(47249),i(81806),i(85842)),a=i(25329),d=(i(76460),i(81594)),c=i(18258),u=i(87540),p=i(76099),h=i(54761);const v="esri-feature-element-info",f={base:v,title:"".concat(v,"__title"),description:"".concat(v,"__description")};let m=class extends a.A{constructor(e,t){super(e,t),this.description=null,this.headingLevel=2,this.title=null}render(){return(0,h.K)("div",{class:f.base},this._renderTitle(),this._renderDescription())}_renderTitle(){const{title:e}=this;return e?(0,h.K)(u.D,{class:f.title,level:this.headingLevel},e):null}_renderDescription(){const{description:e}=this;return e?(0,h.K)("div",{class:f.description,key:"description"},e):null}};(0,n._)([(0,o.MZ)()],m.prototype,"description",void 0),(0,n._)([(0,o.MZ)()],m.prototype,"headingLevel",void 0),(0,n._)([(0,o.MZ)()],m.prototype,"title",void 0),m=(0,n._)([(0,l.$)("esri.widgets.Feature.support.FeatureElementInfo")],m);const _=m,g="esri-feature-attachments";let y=class extends a.A{constructor(e,t){super(e,t),this._featureElementInfo=null,this.attachmentsWidget=new d.default,this.headingLevel=2,this.viewModel=new c.A}initialize(){this._featureElementInfo=new _,this.addHandles([(0,r.watch)((()=>{var e,t;return[null===(e=this.viewModel)||void 0===e?void 0:e.description,null===(t=this.viewModel)||void 0===t?void 0:t.title,this.headingLevel]}),(()=>this._setupFeatureElementInfo()),r.initial),(0,r.watch)((()=>this.viewModel),(e=>this.attachmentsWidget.viewModel=e),r.initial)])}destroy(){var e;this.attachmentsWidget.viewModel=null,this.attachmentsWidget.destroy(),null===(e=this._featureElementInfo)||void 0===e||e.destroy()}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get displayType(){return this.attachmentsWidget.displayType}set displayType(e){this.attachmentsWidget.displayType=e}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}render(){var e;const{attachmentsWidget:t}=this;return(0,h.K)("div",{class:g},null===(e=this._featureElementInfo)||void 0===e?void 0:e.render(),null===t||void 0===t?void 0:t.render())}_setupFeatureElementInfo(){var e;const{description:t,title:i,headingLevel:n}=this;null===(e=this._featureElementInfo)||void 0===e||e.set({description:t,title:i,headingLevel:n})}};(0,n._)([(0,o.MZ)({readOnly:!0})],y.prototype,"attachmentsWidget",void 0),(0,n._)([(0,o.MZ)()],y.prototype,"description",null),(0,n._)([(0,o.MZ)()],y.prototype,"displayType",null),(0,n._)([(0,o.MZ)()],y.prototype,"graphic",null),(0,n._)([(0,o.MZ)()],y.prototype,"headingLevel",void 0),(0,n._)([(0,o.MZ)()],y.prototype,"title",null),(0,n._)([(0,o.MZ)({type:c.A})],y.prototype,"viewModel",void 0),y=(0,n._)([(0,l.$)("esri.widgets.Feature.FeatureAttachments")],y);const M=y;var w=i(1052),b=i(9912),I=i(95752);const A="esri-feature-content",C={base:A,loaderContainer:"".concat(A,"__loader-container"),loader:"".concat(A,"__loader")};let x=class extends a.A{constructor(e,t){super(e,t),this.viewModel=null,this._addTargetToAnchors=e=>{Array.from(e.querySelectorAll("a")).forEach((e=>{(0,b.kX)(e.href)&&!e.hasAttribute("target")&&e.setAttribute("target","_blank")}))}}get creator(){var e;return null===(e=this.viewModel)||void 0===e?void 0:e.creator}set creator(e){this.viewModel&&(this.viewModel.creator=e)}get graphic(){var e;return null===(e=this.viewModel)||void 0===e?void 0:e.graphic}set graphic(e){this.viewModel&&(this.viewModel.graphic=e)}render(){var e;const t=null===(e=this.viewModel)||void 0===e?void 0:e.state;return(0,h.K)("div",{class:C.base},"loading"===t?this._renderLoading():this._renderCreated())}_renderLoading(){return(0,h.K)("div",{class:C.loaderContainer,key:"loader"},(0,h.K)("div",{class:C.loader}))}_renderCreated(){var e;const t=null===(e=this.viewModel)||void 0===e?void 0:e.created;return t?t instanceof HTMLElement?(0,h.K)("div",{afterCreate:this._attachToNode,bind:t,key:t}):(0,I.p4)(t)?(0,h.K)("div",{key:t},!t.destroyed&&t.render()):(0,h.K)("div",{afterCreate:this._addTargetToAnchors,innerHTML:t,key:t}):null}_attachToNode(e){e.appendChild(this)}};(0,n._)([(0,o.MZ)()],x.prototype,"creator",null),(0,n._)([(0,o.MZ)()],x.prototype,"graphic",null),(0,n._)([(0,o.MZ)({type:w.A})],x.prototype,"viewModel",void 0),x=(0,n._)([(0,l.$)("esri.widgets.Feature.FeatureContent")],x);const F=x;var T=i(38932),E=i(98108),R=i(95843),Z=i(63582);const L="esri-feature-fields",k={base:L,fieldHeader:"".concat(L,"__field-header"),fieldData:"".concat(L,"__field-data"),fieldDataDate:"".concat(L,"__field-data--date")};let P=class extends a.A{constructor(e,t){super(e,t),this._featureElementInfo=null,this.viewModel=new T.A,this.messages=null,this.messagesURIUtils=null}initialize(){this._featureElementInfo=new _,this.addHandles((0,r.watch)((()=>{var e,t;return[null===(e=this.viewModel)||void 0===e?void 0:e.description,null===(t=this.viewModel)||void 0===t?void 0:t.title]}),(()=>this._setupFeatureElementInfo()),r.initial))}destroy(){var e;null===(e=this._featureElementInfo)||void 0===e||e.destroy()}get attributes(){return this.viewModel.attributes}set attributes(e){this.viewModel.attributes=e}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get expressionInfos(){return this.viewModel.expressionInfos}set expressionInfos(e){this.viewModel.expressionInfos=e}get fieldInfos(){return this.viewModel.fieldInfos}set fieldInfos(e){this.viewModel.fieldInfos=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}render(){var e;return(0,h.K)("div",{class:k.base},null===(e=this._featureElementInfo)||void 0===e?void 0:e.render(),this._renderFields())}_renderFieldInfo(e,t){const{attributes:i}=this.viewModel,n=e.fieldName,r=e.label||n,o=i?null==i[n]?"":i[n]:"",s=!(!e.format||!e.format.dateFormat),l="number"!=typeof o||s?(0,R.Q)(this.messagesURIUtils,o):this._forceLTR(o),a={[k.fieldDataDate]:s};return(0,h.K)("tr",{key:"fields-element-info-row-".concat(n,"-").concat(t)},(0,h.K)("th",{class:k.fieldHeader,innerHTML:r,key:"fields-element-info-row-header-".concat(n,"-").concat(t)}),(0,h.K)("td",{class:this.classes(k.fieldData,a),innerHTML:l,key:"fields-element-info-row-data-".concat(n,"-").concat(t)}))}_renderFields(){const{formattedFieldInfos:e}=this.viewModel;return null!==e&&void 0!==e&&e.length?(0,h.K)("table",{class:E.D.table,summary:this.messages.fieldsSummary},(0,h.K)("tbody",null,e.map(((e,t)=>this._renderFieldInfo(e,t))))):null}_setupFeatureElementInfo(){var e;const{description:t,title:i}=this;null===(e=this._featureElementInfo)||void 0===e||e.set({description:t,title:i})}_forceLTR(e){return"&lrm;".concat(e)}};(0,n._)([(0,o.MZ)()],P.prototype,"attributes",null),(0,n._)([(0,o.MZ)()],P.prototype,"description",null),(0,n._)([(0,o.MZ)()],P.prototype,"expressionInfos",null),(0,n._)([(0,o.MZ)()],P.prototype,"fieldInfos",null),(0,n._)([(0,o.MZ)()],P.prototype,"title",null),(0,n._)([(0,o.MZ)({type:T.A,nonNullable:!0})],P.prototype,"viewModel",void 0),(0,n._)([(0,o.MZ)(),(0,Z.G)("esri/widgets/Feature/t9n/Feature")],P.prototype,"messages",void 0),(0,n._)([(0,o.MZ)(),(0,Z.G)("esri/widgets/support/t9n/uriUtils")],P.prototype,"messagesURIUtils",void 0),P=(0,n._)([(0,l.$)("esri.widgets.Feature.FeatureFields")],P);const S=P;var N=i(17555),V=i(23994),K=i(42450),O=i(77666),W=i(91896),$=i(39348);const D="esri-feature-media",H={base:D,mediaContainer:"".concat(D,"__container"),mediaItemContainer:"".concat(D,"__item-container"),mediaItem:"".concat(D,"__item"),mediaItemText:"".concat(D,"__item-text"),mediaItemTitle:"".concat(D,"__item-title"),mediaItemCaption:"".concat(D,"__item-caption"),mediaNavigation:"".concat(D,"__item-navigation"),mediaPagination:"".concat(D,"__pagination"),mediaPaginationText:"".concat(D,"__pagination-text"),mediaPrevious:"".concat(D,"__previous"),mediaPreviousIconLTR:"".concat(D,"__previous-icon"),mediaPreviousIconRTL:"".concat(D,"__previous-icon--rtl"),mediaNext:"".concat(D,"__next"),mediaNextIconLTR:"".concat(D,"__next-icon"),mediaNextIconRTL:"".concat(D,"__next-icon--rtl"),mediaChart:"".concat(D,"__chart"),mediaPaginationButton:"".concat(D,"__pagination-button"),mediaPaginationIcon:"".concat(D,"__pagination-icon"),mediaChartRendered:"".concat(D,"__chart--rendered")},U="category",X="value";let z=class extends a.A{constructor(e,t){super(e,t),this._refreshTimer=null,this._refreshIntervalInfo=null,this._featureElementInfo=null,this._chartRootMap=new WeakMap,this.viewModel=new K.A,this.messages=null,this._disposeChart=e=>{var t;null!==(t=this._chartRootMap.get(e))&&void 0!==t&&t.dispose(),this._chartRootMap.delete(e)},this._createChart=async e=>{const{destroyed:t,viewModel:n}=this;if(t||!n||!e)return;const{createRoot:r}=await Promise.all([i.e(73318),i.e(63397),i.e(40096)]).then(i.bind(i,50356)),o=await r(e);this._chartRootMap.set(e,o),this._renderChart({mediaInfo:n.activeMediaInfo,root:o})}}initialize(){this._featureElementInfo=new _,this.addHandles([(0,r.watch)((()=>{var e,t;return[null===(e=this.viewModel)||void 0===e?void 0:e.activeMediaInfo,null===(t=this.viewModel)||void 0===t?void 0:t.activeMediaInfoIndex]}),(()=>this._setupMediaRefreshTimer()),r.initial),(0,r.watch)((()=>{var e,t;return[null===(e=this.viewModel)||void 0===e?void 0:e.description,null===(t=this.viewModel)||void 0===t?void 0:t.title]}),(()=>this._setupFeatureElementInfo()),r.initial)])}loadDependencies(){return(0,O.W)({icon:()=>Promise.all([i.e(39879),i.e(95012)]).then(i.bind(i,95012))})}destroy(){var e;this._clearMediaRefreshTimer(),null===(e=this._featureElementInfo)||void 0===e||e.destroy()}get attributes(){return this.viewModel.attributes}set attributes(e){this.viewModel.attributes=e}get activeMediaInfoIndex(){return this.viewModel.activeMediaInfoIndex}set activeMediaInfoIndex(e){this.viewModel.activeMediaInfoIndex=e}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get fieldInfoMap(){return this.viewModel.fieldInfoMap}set fieldInfoMap(e){this.viewModel.fieldInfoMap=e}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}get mediaInfos(){return this.viewModel.mediaInfos}set mediaInfos(e){this.viewModel.mediaInfos=e}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(e){this.viewModel.popupTemplate=e}get relatedInfos(){return this.viewModel.relatedInfos}set relatedInfos(e){this.viewModel.relatedInfos=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}render(){var e;return(0,h.K)("div",{bind:this,class:H.base,onkeyup:this._handleMediaKeyup},null===(e=this._featureElementInfo)||void 0===e?void 0:e.render(),this._renderMedia())}_renderMedia(){const{formattedMediaInfoCount:e,activeMediaInfoIndex:t}=this.viewModel,i=this._renderMediaText();return e?(0,h.K)("div",{class:H.mediaContainer,key:"media-element-container"},this._renderMediaInfo(),(0,h.K)("div",{class:H.mediaNavigation},i,e>1?(0,h.K)("div",{class:H.mediaPagination},this._renderMediaPageButton("previous"),(0,h.K)("span",{class:H.mediaPaginationText},(0,$.V)(this.messages.pageText,{index:t+1,total:e})),this._renderMediaPageButton("next")):null)):null}_renderMediaText(){const{activeMediaInfo:e}=this.viewModel;if(!e)return null;const t=e&&e.title?(0,h.K)("div",{class:H.mediaItemTitle,innerHTML:e.title,key:"media-title"}):null,i=e&&e.caption?(0,h.K)("div",{class:H.mediaItemCaption,innerHTML:e.caption,key:"media-caption"}):null;return t||i?(0,h.K)("div",{class:H.mediaItemText,key:"media-text"},t,i):null}_renderImageMediaInfo(e){var t;const{_refreshIntervalInfo:i}=this,{activeMediaInfoIndex:n,formattedMediaInfoCount:r}=this.viewModel,{value:o,refreshInterval:s,altText:l,title:a,type:d}=e,{sourceURL:c,linkURL:u}=o,p=(0,b.kX)(null!==u&&void 0!==u?u:void 0)?"_blank":"_self",v="_blank"===p?"noreferrer":"",f=s?i:null,m=f?f.timestamp:0,_=f?f.sourceURL:c,g=(0,h.K)("img",{alt:l||a,key:"media-".concat(d,"-").concat(n,"-").concat(r,"-").concat(m),src:null!==_&&void 0!==_?_:void 0});return null!==(t=u?(0,h.K)("a",{href:u,rel:v,target:p,title:a},g):null)&&void 0!==t?t:g}_renderChartMediaInfo(e){const{activeMediaInfoIndex:t,formattedMediaInfoCount:i}=this.viewModel;return(0,h.K)("div",{afterCreate:this._createChart,afterRemoved:this._disposeChart,bind:this,class:H.mediaChart,key:"media-".concat(e.type,"-").concat(t,"-").concat(i)})}_renderMediaInfoType(){const{activeMediaInfo:e}=this.viewModel;return e?"image"===e.type?this._renderImageMediaInfo(e):e.type.includes("chart")?this._renderChartMediaInfo(e):null:null}_renderMediaInfo(){const{activeMediaInfo:e}=this.viewModel;return e?(0,h.K)("div",{class:H.mediaItemContainer,key:"media-container"},(0,h.K)("div",{class:H.mediaItem,key:"media-item-container"},this._renderMediaInfoType())):null}_renderMediaPageButton(e){if(this.viewModel.formattedMediaInfoCount<2)return null;const t="previous"===e,i=t?this.messages.previous:this.messages.next,n=t?"chevron-left":"chevron-right",r=t?"media-previous":"media-next",o=t?this._previous:this._next;return(0,h.K)("button",{"aria-label":i,bind:this,class:H.mediaPaginationButton,key:r,onclick:o,tabIndex:0,title:i,type:"button"},(0,h.K)("calcite-icon",{class:H.mediaPaginationIcon,icon:n,scale:"s"}))}_setupFeatureElementInfo(){var e;const{description:t,title:i}=this;null===(e=this._featureElementInfo)||void 0===e||e.set({description:t,title:i})}_next(){this.viewModel.next()}_previous(){this.viewModel.previous()}_getRenderer(){if(!this.viewModel)return;const{isAggregate:e,layer:t}=this.viewModel;return e&&null!==t&&void 0!==t&&t.featureReduction&&"renderer"in t.featureReduction?t.featureReduction.renderer:null===t||void 0===t?void 0:t.renderer}async _getSeriesColors(e){const{colorAm5:t}=await Promise.all([i.e(73318),i.e(52763)]).then(i.bind(i,52763)),n=new Map;return e.forEach((e=>{e.color&&n.set(e,t(e.color.toCss(!0)))})),n}async _getRendererColors(){const{colorAm5:e}=await Promise.all([i.e(73318),i.e(52763)]).then(i.bind(i,52763)),t=new Map,n=this._getRenderer();if(!n)return t;const r=await(0,V.iA)(n);return r.delete("default"),Array.from(r.values()).every((e=>1===(null===e||void 0===e?void 0:e.length)))?(Array.from(r.keys()).forEach((i=>{var n;const o=null===(n=r.get(i))||void 0===n||null===(n=n[0])||void 0===n?void 0:n.toCss(!0);o&&t.set(i,e(o))})),t):t}_handleMediaKeyup(e){const{key:t}=e;"ArrowLeft"===t&&(e.stopPropagation(),this.viewModel.previous()),"ArrowRight"===t&&(e.stopPropagation(),this.viewModel.next())}_canAnimateChart(){return!!this.viewModel&&!!this.viewModel.abilities.chartAnimation&&!(0,N.O)()}_getChartAnimationMS(){return this._canAnimateChart()?250:0}_getChartSeriesAnimationMS(){return this._canAnimateChart()?500:0}async _renderChart(e){const{root:t,mediaInfo:n}=e,{value:r,type:o}=n,{ResponsiveThemeAm5:s,DarkThemeAm5:l,AnimatedThemeAm5:a,ColorSetAm5:d,ThemeAm5:c,esriChartColorSet:u}=await Promise.all([i.e(73318),i.e(52763)]).then(i.bind(i,52763)),p=c.new(t);p.rule("ColorSet").set("colors",u),p.rule("ColorSet").set("reuse",!0);const h=[s.new(t),p];(0,W.g4)()&&h.push(l.new(t)),this._canAnimateChart()&&h.push(a.new(t)),t.setThemes(h);const v=await this._getRendererColors(),f=await this._getSeriesColors(r.series),m=d.new(t,{}),_=f.get(r.series[0]),g=_?{lineSettings:{stroke:_}}:void 0,y=r.series.map(((e,t)=>{const i=f.get(e)||v.get(e.fieldName)||m.getIndex(t);return{[U]:e.tooltip,[X]:e.value,columnSettings:{fill:i,stroke:i},...g}})).filter((e=>"pie-chart"!==o||null!=e.value&&e.value>0));"pie-chart"===o?this._createPieChart(e,y):this._createXYChart(e,y)}_getDirection(){return(0,p.V8)(this.container)?"rtl":"ltr"}_isInversed(){return!!(0,p.V8)(this.container)}async _customizeChartTooltip(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"horizontal";const{colorAm5:r}=await Promise.all([i.e(73318),i.e(52763)]).then(i.bind(i,52763));e.setAll({pointerOrientation:n}),null!==(t=e.get("background"))&&void 0!==t&&t.setAll({stroke:r("rgba(50, 50, 50, 1)")}),e.label.setAll({direction:this._getDirection(),oversizedBehavior:"wrap",maxWidth:200})}async _createPieChart(e,t){const{TooltipAm5:n}=await Promise.all([i.e(73318),i.e(52763)]).then(i.bind(i,52763)),{PieChartAm5:r,PieSeriesAm5:o}=await Promise.all([i.e(73318),i.e(42225),i.e(82818)]).then(i.bind(i,82818)),{mediaInfo:s,root:l}=e,{title:a}=s,d=(null===s||void 0===s?void 0:s.altText)||(null===s||void 0===s?void 0:s.title)||"",c=l.container.children.push(r.new(l,{ariaLabel:d,focusable:!0,paddingBottom:5,paddingTop:5,paddingLeft:5,paddingRight:5})),u="{category}: {valuePercentTotal.formatNumber('0.00')}%\n ({value})",p=n.new(l,{labelText:u}),h=c.series.push(o.new(l,{name:a,valueField:X,categoryField:U,tooltip:p}));h.ticks.template.set("forceHidden",!0),h.labels.template.set("forceHidden",!0),h.slices.template.states.create("active",{shiftRadius:5}),this._customizeChartTooltip(p),h.slices.template.setAll({ariaLabel:u,focusable:!0,templateField:"columnSettings"}),h.data.setAll(t),h.appear(this._getChartSeriesAnimationMS()),c.appear(this._getChartAnimationMS()),c.root.dom.classList.toggle(H.mediaChartRendered,!0)}_getMinSeriesValue(e){let t=0;return e.forEach((e=>t=Math.min(e.value,t))),t}async _createColumnChart(e,t,n){const{TooltipAm5:r,ScrollbarAm5:o}=await Promise.all([i.e(73318),i.e(52763)]).then(i.bind(i,52763)),{CategoryAxisAm5:s,AxisRendererXAm5:l,ValueAxisAm5:a,AxisRendererYAm5:d,ColumnSeriesAm5:c}=await Promise.all([i.e(73318),i.e(42225),i.e(93640),i.e(34079)]).then(i.bind(i,34079)),{mediaInfo:u,root:p}=t,{value:h,title:v}=u;e.setAll({wheelX:"panX",wheelY:"zoomX"});const f=e.xAxes.push(s.new(p,{renderer:l.new(p,{inversed:this._isInversed()}),categoryField:U}));f.get("renderer").labels.template.setAll({forceHidden:!0});const m=e.yAxes.push(a.new(p,{renderer:d.new(p,{inside:!1}),min:this._getMinSeriesValue(h.series)}));m.get("renderer").labels.template.setAll({direction:this._getDirection()});const _="{categoryX}",g=r.new(p,{labelText:_}),y=e.series.push(c.new(p,{name:v,xAxis:f,yAxis:m,valueYField:X,categoryXField:U,tooltip:g}));this._customizeChartTooltip(g),y.columns.template.setAll({ariaLabel:_,focusable:!0,templateField:"columnSettings"}),h.series.length>15&&e.set("scrollbarX",o.new(p,{orientation:"horizontal"})),f.data.setAll(n),y.data.setAll(n),y.appear(this._getChartSeriesAnimationMS()),e.appear(this._getChartAnimationMS())}async _createBarChart(e,t,n){const{TooltipAm5:r,ScrollbarAm5:o}=await Promise.all([i.e(73318),i.e(52763)]).then(i.bind(i,52763)),{CategoryAxisAm5:s,AxisRendererXAm5:l,ValueAxisAm5:a,AxisRendererYAm5:d,ColumnSeriesAm5:c}=await Promise.all([i.e(73318),i.e(42225),i.e(93640),i.e(34079)]).then(i.bind(i,34079)),{mediaInfo:u,root:p}=t,{value:h,title:v}=u;e.setAll({wheelX:"panY",wheelY:"zoomY"});const f=e.yAxes.push(s.new(p,{renderer:d.new(p,{inversed:!0}),categoryField:U}));f.get("renderer").labels.template.setAll({forceHidden:!0});const m=e.xAxes.push(a.new(p,{renderer:l.new(p,{inside:!1,inversed:this._isInversed()}),min:this._getMinSeriesValue(h.series)}));m.get("renderer").labels.template.setAll({direction:this._getDirection()});const _="{categoryY}",g=r.new(p,{labelText:_}),y=e.series.push(c.new(p,{name:v,xAxis:m,yAxis:f,valueXField:X,categoryYField:U,tooltip:g}));this._customizeChartTooltip(g,"vertical"),y.columns.template.setAll({ariaLabel:_,focusable:!0,templateField:"columnSettings"}),h.series.length>15&&e.set("scrollbarY",o.new(p,{orientation:"vertical"})),f.data.setAll(n),y.data.setAll(n),y.appear(this._getChartSeriesAnimationMS()),e.appear(this._getChartAnimationMS())}async _createLineChart(e,t,n){var r,o;const{TooltipAm5:s,ScrollbarAm5:l}=await Promise.all([i.e(73318),i.e(52763)]).then(i.bind(i,52763)),{CategoryAxisAm5:a,AxisRendererXAm5:d,ValueAxisAm5:c,AxisRendererYAm5:u,LineSeriesAm5:p}=await Promise.all([i.e(73318),i.e(42225),i.e(93640),i.e(34079)]).then(i.bind(i,34079)),{root:h,mediaInfo:v}=t,{value:f,title:m}=v;e.setAll({wheelX:"panX",wheelY:"zoomX"});const _=e.xAxes.push(a.new(h,{renderer:d.new(h,{inversed:this._isInversed()}),categoryField:U}));_.get("renderer").labels.template.setAll({forceHidden:!0});const g=e.yAxes.push(c.new(h,{renderer:u.new(h,{inside:!1}),min:this._getMinSeriesValue(f.series)}));g.get("renderer").labels.template.setAll({direction:this._getDirection()});const y=null===(r=n[0])||void 0===r||null===(r=r.lineSettings)||void 0===r?void 0:r.stroke,M=s.new(h,{getFillFromSprite:!y,labelText:"{categoryX}"});y&&(null===(o=M.get("background"))||void 0===o||o.setAll({fill:y}));const w=e.series.push(p.new(h,{name:m,xAxis:_,yAxis:g,valueYField:X,categoryXField:U,tooltip:M}));w.strokes.template.setAll({templateField:"lineSettings"}),this._customizeChartTooltip(M,"vertical"),f.series.length>15&&e.set("scrollbarX",l.new(h,{orientation:"horizontal"})),_.data.setAll(n),w.data.setAll(n),w.appear(this._getChartSeriesAnimationMS()),e.appear(this._getChartAnimationMS())}async _createXYChart(e,t){const{XYChartAm5:n,XYCursorAm5:r}=await Promise.all([i.e(73318),i.e(42225),i.e(93640),i.e(34079)]).then(i.bind(i,34079)),{root:o,mediaInfo:s}=e,{type:l}=s,a=(null===s||void 0===s?void 0:s.altText)||(null===s||void 0===s?void 0:s.title)||"",d=o.container.children.push(n.new(o,{ariaLabel:a,focusable:!0,panX:!0,panY:!0}));d.set("cursor",r.new(o,{})),"column-chart"===l&&await this._createColumnChart(d,e,t),"bar-chart"===l&&await this._createBarChart(d,e,t),"line-chart"===l&&await this._createLineChart(d,e,t),d.root.dom.classList.toggle(H.mediaChartRendered,!0)}_clearMediaRefreshTimer(){const{_refreshTimer:e}=this;e&&(clearTimeout(e),this._refreshTimer=null)}_updateMediaInfoTimestamp(e){const t=Date.now();this._refreshIntervalInfo={timestamp:t,sourceURL:e&&this._getImageSource(e,t)}}_setupMediaRefreshTimer(){this._clearMediaRefreshTimer();const{activeMediaInfo:e}=this.viewModel;e&&"image"===e.type&&e.refreshInterval&&this._setRefreshTimeout(e)}_setRefreshTimeout(e){const{refreshInterval:t,value:i}=e;if(!t)return;const n=6e4*t;this._updateMediaInfoTimestamp(i.sourceURL);const r=setInterval((()=>{this._updateMediaInfoTimestamp(i.sourceURL)}),n);this._refreshTimer=r}_getImageSource(e,t){const i=e.includes("?")?"&":"?",[n,r=""]=e.split("#");return"".concat(n).concat(i,"timestamp=").concat(t).concat(r?"#":"").concat(r)}};(0,n._)([(0,o.MZ)()],z.prototype,"_refreshIntervalInfo",void 0),(0,n._)([(0,o.MZ)()],z.prototype,"attributes",null),(0,n._)([(0,o.MZ)()],z.prototype,"activeMediaInfoIndex",null),(0,n._)([(0,o.MZ)()],z.prototype,"description",null),(0,n._)([(0,o.MZ)()],z.prototype,"fieldInfoMap",null),(0,n._)([(0,o.MZ)()],z.prototype,"layer",null),(0,n._)([(0,o.MZ)()],z.prototype,"mediaInfos",null),(0,n._)([(0,o.MZ)()],z.prototype,"popupTemplate",null),(0,n._)([(0,o.MZ)()],z.prototype,"relatedInfos",null),(0,n._)([(0,o.MZ)()],z.prototype,"title",null),(0,n._)([(0,o.MZ)({type:K.A})],z.prototype,"viewModel",void 0),(0,n._)([(0,o.MZ)(),(0,Z.G)("esri/widgets/Feature/t9n/Feature")],z.prototype,"messages",void 0),z=(0,n._)([(0,l.$)("esri.widgets.Feature.FeatureMedia")],z);const B=z;var j=i(39492),q=i(15062);const Y="esri-feature",Q={base:"".concat(Y,"-expression"),loadingSpinnerContainer:"".concat(Y,"__loading-container"),spinner:"".concat(Y,"__loading-spinner")};let G=class extends a.A{constructor(e,t){super(e,t),this._contentWidget=null,this.viewModel=new j.A}initialize(){this.addHandles((0,r.watch)((()=>{var e;return null===(e=this.viewModel)||void 0===e?void 0:e.contentElementViewModel}),(()=>this._setupExpressionWidget()),r.initial))}destroy(){this._destroyContentWidget()}render(){var e;const{state:t}=this.viewModel;return(0,h.K)("div",{class:Q.base},"loading"===t?this._renderLoading():"disabled"===t?null:null===(e=this._contentWidget)||void 0===e?void 0:e.render())}_renderLoading(){return(0,h.K)("div",{class:Q.loadingSpinnerContainer,key:"loading-container"},(0,h.K)("span",{class:this.classes(q.T.loadingIndicator,E.D.rotating,Q.spinner)}))}_destroyContentWidget(){const{_contentWidget:e}=this;e&&(e.viewModel=null,e.destroy()),this._contentWidget=null}_setupExpressionWidget(){const{contentElementViewModel:e,contentElement:t}=this.viewModel,i=null===t||void 0===t?void 0:t.type;this._destroyContentWidget();const n=e?"fields"===i?new S({viewModel:e}):"media"===i?new B({viewModel:e}):"text"===i?new F({viewModel:e}):null:null;this._contentWidget=n,this.scheduleRender()}};(0,n._)([(0,o.MZ)({type:j.A})],G.prototype,"viewModel",void 0),G=(0,n._)([(0,l.$)("esri.widgets.Feature.FeatureExpression")],G);const J=G;var ee=i(30726),te=i(50346),ie=i(65023);const ne="esri-feature",re="".concat(ne,"-relationship"),oe={base:re,listContainer:"".concat(re,"__list"),listItem:"".concat(re,"__list-item"),listItemHidden:"".concat(re,"__list-item--hidden"),listContainerQuerying:"".concat(re,"__list--querying"),featureObserver:"".concat(ne,"__feature-observer"),stickySpinnerContainer:"".concat(ne,"__sticky-loading-container"),loadingSpinnerContainer:"".concat(ne,"__loading-container"),spinner:"".concat(ne,"__loading-spinner")},se={title:!0,description:!0};let le=class extends a.A{constructor(e,t){super(e,t),this._featureElementInfo=null,this._relatedFeatureIntersectionObserverNode=null,this._relatedFeatureIntersectionObserver=new IntersectionObserver((e=>{let[t]=e;(null===t||void 0===t?void 0:t.isIntersecting)&&this._increaseFeaturePage()}),{root:window.document}),this.headingLevel=2,this.viewModel=new ie.A,this.messages=null,this.messagesCommon=null,this.visibleElements={...se},this._increaseFeaturePage=()=>{const{state:e,showAllEnabled:t,relatedFeatures:i,featuresPerPage:n,featurePage:r}=this.viewModel;"ready"===e&&t&&i.length>=n*r&&this.viewModel.featurePage++}}initialize(){this._featureElementInfo=new _,this.addHandles([(0,r.watch)((()=>[this.viewModel.description,this.viewModel.title,this.headingLevel]),(()=>this._setupFeatureElementInfo()),r.initial),(0,r.watch)((()=>[this.viewModel.state,this.viewModel.showAllEnabled,this._relatedFeatureIntersectionObserverNode]),(()=>this._handleRelatedFeatureObserverChange())),(0,r.on)((()=>this.viewModel.relatedFeatureViewModels),"change",(()=>this._setupRelatedFeatureViewModels()))])}loadDependencies(){return(0,O.W)({icon:()=>Promise.all([i.e(39879),i.e(95012)]).then(i.bind(i,95012)),list:()=>Promise.all([i.e(39879),i.e(62785),i.e(95203),i.e(13859),i.e(79545),i.e(58838)]).then(i.bind(i,58838)),"list-item":()=>Promise.all([i.e(39879),i.e(62785),i.e(48897),i.e(3732)]).then(i.bind(i,84661)),notice:()=>Promise.all([i.e(39879),i.e(62785),i.e(81985)]).then(i.bind(i,81985))})}destroy(){this._unobserveRelatedFeatureObserver(),this._featureElementInfo=(0,ee.pR)(this._featureElementInfo)}get displayShowAllButton(){const{showAllEnabled:e,featureCount:t,displayCount:i,state:n}=this.viewModel;return!e&&!!t&&"ready"===n&&(t>i||0===i)}get displayListItems(){return this.displayShowAllButton||this.viewModel.relatedFeatureViewModels.length>0}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get featureCountDescription(){const{messages:e}=this,{featureCount:t}=this.viewModel;return(0,$.V)(null===e||void 0===e?void 0:e.numberRecords,{number:t})}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}castVisibleElements(e){return{...se,...e}}render(){var e;const{state:t}=this.viewModel;return(0,h.K)("div",{class:this.classes(oe.base,E.D.widget)},null===(e=this._featureElementInfo)||void 0===e?void 0:e.render(),"loading"===t?this._renderLoading():"disabled"===t?this._renderRelationshipNotFound():this._renderRelatedFeatures())}_renderStickyLoading(){return"querying"===this.viewModel.state?(0,h.K)("div",{class:oe.stickySpinnerContainer,key:"sticky-loader"},this._renderLoadingIcon()):null}_renderLoadingIcon(){return(0,h.K)("span",{class:this.classes(q.T.loadingIndicator,E.D.rotating,oe.spinner)})}_renderLoading(){return(0,h.K)("div",{class:oe.loadingSpinnerContainer,key:"loading-container"},this._renderLoadingIcon())}_renderShowAllIconNode(){return(0,h.K)("calcite-icon",{icon:"list",scale:"s",slot:"content-end"})}_renderChevronIconNode(){const e=(0,p.V8)(this.container)?"chevron-left":"chevron-right";return(0,h.K)("calcite-icon",{icon:e,scale:"s",slot:"content-end"})}_renderRelatedFeature(e){var t,i;const{itemDescriptionFieldName:n}=this.viewModel,r=e.title;e.description=n&&(null===(t=e.formattedAttributes)||void 0===t?void 0:t.global[n]);const o="loading"===e.state;return(0,h.K)("calcite-list-item",{class:this.classes(oe.listItem,{[oe.listItemHidden]:o}),description:null!==(i=e.description)&&void 0!==i?i:"",key:e.uid,label:r,onCalciteListItemSelect:()=>this.emit("select-record",{featureViewModel:e})},this._renderChevronIconNode())}_renderShowAllListItem(){var e;return this.displayShowAllButton?(0,h.K)("calcite-list-item",{description:this.featureCountDescription,key:"show-all-item",label:null===(e=this.messages)||void 0===e?void 0:e.showAll,onCalciteListItemSelect:()=>this.emit("show-all-records")},this._renderShowAllIconNode()):null}_renderNoRelatedFeaturesMessage(){var e;return(0,h.K)("calcite-notice",{icon:"information",key:"no-related-features-message",kind:"brand",open:!0,scale:"s",width:"full"},(0,h.K)("div",{slot:"message"},null===(e=this.messages)||void 0===e?void 0:e.noRelatedFeatures))}_renderFeatureObserver(){return(0,h.K)("div",{afterCreate:this._relatedFeatureIntersectionObserverCreated,bind:this,class:oe.featureObserver,key:"feature-observer"})}_renderList(){const{relatedFeatureViewModels:e}=this.viewModel;return(0,h.K)("calcite-list",null,e.toArray().map((e=>this._renderRelatedFeature(e))),this._renderShowAllListItem())}_renderRelatedFeatures(){const{displayListItems:e}=this,{state:t}=this.viewModel;return(0,h.K)("div",{class:this.classes(oe.listContainer,{[oe.listContainerQuerying]:"querying"===t}),key:"list-container"},e?this._renderList():"ready"===t?this._renderNoRelatedFeaturesMessage():null,this._renderStickyLoading(),this._renderFeatureObserver())}_renderRelationshipNotFound(){var e;return(0,h.K)("calcite-notice",{icon:"exclamation-mark-triangle",key:"relationship-not-found",kind:"danger",open:!0,scale:"s",width:"full"},(0,h.K)("div",{slot:"message"},null===(e=this.messages)||void 0===e?void 0:e.relationshipNotFound))}_setupRelatedFeatureViewModels(){const{relatedFeatureViewModels:e}=this.viewModel,t="related-feature-viewmodels";this.removeHandles(t),null!==e&&void 0!==e&&e.forEach((e=>{this.addHandles((0,r.watch)((()=>[e.title,e.state]),(()=>this.scheduleRender()),r.initial),t)})),this.scheduleRender()}_setupFeatureElementInfo(){var e;const{headingLevel:t,visibleElements:i}=this,n=i.description&&this.description,r=i.title&&this.title;null===(e=this._featureElementInfo)||void 0===e||e.set({description:n,title:r,headingLevel:t})}async _handleRelatedFeatureObserverChange(){this._unobserveRelatedFeatureObserver();const{state:e,showAllEnabled:t}=this.viewModel;await(0,te.Pl)(0),this._relatedFeatureIntersectionObserverNode&&"ready"===e&&t&&this._relatedFeatureIntersectionObserver.observe(this._relatedFeatureIntersectionObserverNode)}_relatedFeatureIntersectionObserverCreated(e){this._relatedFeatureIntersectionObserverNode=e}_unobserveRelatedFeatureObserver(){this._relatedFeatureIntersectionObserverNode&&this._relatedFeatureIntersectionObserver.unobserve(this._relatedFeatureIntersectionObserverNode)}};(0,n._)([(0,o.MZ)()],le.prototype,"_relatedFeatureIntersectionObserverNode",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],le.prototype,"displayShowAllButton",null),(0,n._)([(0,o.MZ)({readOnly:!0})],le.prototype,"displayListItems",null),(0,n._)([(0,o.MZ)()],le.prototype,"description",null),(0,n._)([(0,o.MZ)({readOnly:!0})],le.prototype,"featureCountDescription",null),(0,n._)([(0,o.MZ)()],le.prototype,"headingLevel",void 0),(0,n._)([(0,o.MZ)()],le.prototype,"title",null),(0,n._)([(0,o.MZ)({type:ie.A})],le.prototype,"viewModel",void 0),(0,n._)([(0,o.MZ)(),(0,Z.G)("esri/widgets/Feature/t9n/Feature")],le.prototype,"messages",void 0),(0,n._)([(0,o.MZ)(),(0,Z.G)("esri/t9n/common")],le.prototype,"messagesCommon",void 0),(0,n._)([(0,o.MZ)()],le.prototype,"visibleElements",void 0),(0,n._)([(0,s.w)("visibleElements")],le.prototype,"castVisibleElements",null),le=(0,n._)([(0,l.$)("esri.widgets.Feature.FeatureRelationship")],le);const ae=le;var de,ce=i(51007),ue=i(54062),pe=i(30899);const he={title:!0,content:!0,lastEditedInfo:!0},ve="relationship-handles";let fe=de=class extends((0,pe.j)(a.A)){constructor(e,t){super(e,t),this._contentWidgets=[],this.flowItems=null,this.headingLevel=2,this.messages=null,this.messagesCommon=null,this.visibleElements={...he},this.viewModel=new ce.A}initialize(){this.addHandles((0,r.watch)((()=>{var e;return null===(e=this.viewModel)||void 0===e?void 0:e.contentViewModels}),(()=>this._setupContentWidgets()),r.initial))}loadDependencies(){return(0,O.W)({notice:()=>Promise.all([i.e(39879),i.e(62785),i.e(81985)]).then(i.bind(i,81985))})}destroy(){this._destroyContentWidgets()}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get defaultPopupTemplateEnabled(){return this.viewModel.defaultPopupTemplateEnabled}set defaultPopupTemplateEnabled(e){this.viewModel.defaultPopupTemplateEnabled=e}get isTable(){return this.viewModel.isTable}get label(){var e,t;return null!==(e=null===(t=this.messages)||void 0===t?void 0:t.widgetLabel)&&void 0!==e?e:""}set label(e){this._overrideIfSome("label",e)}get spatialReference(){return this.viewModel.spatialReference}set spatialReference(e){this.viewModel.spatialReference=e}get timeZone(){return this.viewModel.timeZone}set timeZone(e){this.viewModel.timeZone=e}get title(){return this.viewModel.title}castVisibleElements(e){return{...he,...e}}get map(){return this.viewModel.map}set map(e){this.viewModel.map=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}setActiveMedia(e,t){return this.viewModel.setActiveMedia(e,t)}nextMedia(e){return this.viewModel.nextMedia(e)}previousMedia(e){return this.viewModel.previousMedia(e)}render(){const{state:e}=this.viewModel,t=(0,h.K)("div",{class:ue.A.container,key:"container"},this._renderTitle(),"error"===e?this._renderError():"loading"===e?this._renderLoading():this._renderContentContainer());return(0,h.K)("div",{class:this.classes(ue.A.base,E.D.widget)},t)}_renderError(){const{messagesCommon:e,messages:t,visibleElements:i}=this;return(0,h.K)("calcite-notice",{icon:"exclamation-mark-circle",kind:"danger",open:!0,scale:"s"},i.title?(0,h.K)("div",{key:"error-title",slot:"title"},e.errorMessage):null,(0,h.K)("div",{key:"error-message",slot:"message"},t.loadingError))}_renderLoading(){return(0,h.K)("div",{class:ue.A.loadingSpinnerContainer,key:"loading-container"},(0,h.K)("span",{class:this.classes(q.T.loadingIndicator,E.D.rotating,ue.A.spinner)}))}_renderContentContainer(){const{visibleElements:e}=this;return e.content?(0,h.K)("div",{class:ue.A.main},[this._renderContent(),this._renderLastEditInfo()]):null}_renderTitle(){const{visibleElements:e,title:t}=this;return e.title?(0,h.K)(u.D,{class:ue.A.title,innerHTML:t,level:this.headingLevel}):null}_renderContent(){const e=this.viewModel.content,t="content";if(!e)return null;if(Array.isArray(e))return e.length?(0,h.K)("div",{class:ue.A.contentNode,key:"".concat(t,"-content-elements")},e.map(this._renderContentElement,this)):null;if("string"==typeof e){const e=this._contentWidgets[0];return!e||e.destroyed?null:(0,h.K)("div",{class:this.classes(ue.A.contentNode,ue.A.contentNodeText),key:"".concat(t,"-content")},e.render())}return this.renderNodeContent(e)}_renderContentElement(e,t){var i;const{visibleElements:n}=this;if("boolean"!=typeof n.content&&(null===(i=n.content)||void 0===i||!i[e.type]))return null;switch(e.type){case"attachments":return this._renderAttachments(t);case"custom":return this._renderCustom(e,t);case"fields":return this._renderFields(t);case"media":return this._renderMedia(t);case"text":return this._renderText(e,t);case"expression":return this._renderExpression(t);case"relationship":return this._renderRelationship(t);default:return null}}_renderAttachments(e){const t=this._contentWidgets[e];if(!t||t.destroyed)return null;const{state:i,attachmentInfos:n}=t.viewModel;return"loading"===i||n.length>0?(0,h.K)("div",{class:this.classes(ue.A.contentElement),key:this._buildKey("attachments-element",e)},t.render()):null}_renderRelationship(e){const t=this._contentWidgets[e];return t&&!t.destroyed&&this.flowItems?(0,h.K)("div",{class:ue.A.contentElement,key:this._buildKey("relationship-element",e)},t.render()):null}_renderExpression(e){const t=this._contentWidgets[e];return!t||t.destroyed?null:(0,h.K)("div",{class:ue.A.contentElement,key:this._buildKey("expression-element",e)},t.render())}_renderCustom(e,t){const{creator:i}=e,n=this._contentWidgets[t];return!n||n.destroyed?null:i?(0,h.K)("div",{class:ue.A.contentElement,key:this._buildKey("custom-element",t)},n.render()):null}_renderFields(e){const t=this._contentWidgets[e];return!t||t.destroyed?null:(0,h.K)("div",{class:ue.A.contentElement,key:this._buildKey("fields-element",e)},t.render())}_renderMedia(e){const t=this._contentWidgets[e];return!t||t.destroyed?null:(0,h.K)("div",{class:ue.A.contentElement,key:this._buildKey("media-element",e)},t.render())}_renderLastEditInfo(){const{visibleElements:e,messages:t}=this,{lastEditInfo:i}=this.viewModel;if(!i||!e.lastEditedInfo)return null;const{date:n,user:r}=i,o="edit"===i.type?r?t.lastEditedByUser:t.lastEdited:r?t.lastCreatedByUser:t.lastCreated,s=(0,$.V)(o,{date:n,user:r});return(0,h.K)("div",{class:this.classes(ue.A.lastEditedInfo,ue.A.contentElement),key:"edit-info-element"},s)}_renderText(e,t){const i=e.text,n=this._contentWidgets[t];return!n||n.destroyed?null:i?(0,h.K)("div",{class:this.classes(ue.A.contentElement,ue.A.text),key:this._buildKey("text-element",t)},n.render()):null}_buildKey(e){for(var t,i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];return"".concat(e,"__").concat((null===(t=this.viewModel)||void 0===t||null===(t=t.graphic)||void 0===t?void 0:t.uid)||"0","-").concat(n.join("-"))}_destroyContentWidget(e){e&&(e.viewModel=null,!e.destroyed&&e.destroy())}_destroyContentWidgets(){this.removeHandles(ve),this._contentWidgets.forEach((e=>this._destroyContentWidget(e))),this._contentWidgets=[]}_addFeatureRelationshipHandles(e){const{flowItems:t,visibleElements:i}=this;this.addHandles([(0,r.on)((()=>e),"select-record",(e=>{let{featureViewModel:n}=e;t&&(n.abilities={relationshipContent:!0},t.push(new de({flowItems:t,viewModel:n,visibleElements:i})))})),(0,r.on)((()=>e),"show-all-records",(()=>{if(!t)return;const{viewModel:i}=e;i.showAllEnabled=!0;const n=new ae({visibleElements:{title:!1,description:!1},viewModel:i});this._addFeatureRelationshipHandles(n),t.push(n)}))],ve)}_setupContentWidgets(){var e;this._destroyContentWidgets();const{headingLevel:t,visibleElements:i}=this,n=null===(e=this.viewModel)||void 0===e?void 0:e.content,{contentViewModels:r}=this.viewModel;if(Array.isArray(n))n.forEach(((e,n)=>{if("attachments"===e.type&&(this._contentWidgets[n]=new M({displayType:e.displayType,headingLevel:i.title?t+1:t,viewModel:r[n]})),"fields"===e.type&&(this._contentWidgets[n]=new S({viewModel:r[n]})),"media"===e.type&&(this._contentWidgets[n]=new B({viewModel:r[n]})),"text"===e.type&&(this._contentWidgets[n]=new F({viewModel:r[n]})),"custom"===e.type&&(this._contentWidgets[n]=new F({viewModel:r[n]})),"expression"===e.type&&(this._contentWidgets[n]=new J({viewModel:r[n]})),"relationship"===e.type){const e=new ae({viewModel:r[n]});this._addFeatureRelationshipHandles(e),this._contentWidgets[n]=e}}),this);else{const e=r[0];e&&!e.destroyed&&(this._contentWidgets[0]=new F({viewModel:e}))}this.scheduleRender()}};(0,n._)([(0,o.MZ)()],fe.prototype,"graphic",null),(0,n._)([(0,o.MZ)()],fe.prototype,"defaultPopupTemplateEnabled",null),(0,n._)([(0,o.MZ)()],fe.prototype,"flowItems",void 0),(0,n._)([(0,o.MZ)()],fe.prototype,"headingLevel",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],fe.prototype,"isTable",null),(0,n._)([(0,o.MZ)()],fe.prototype,"label",null),(0,n._)([(0,o.MZ)(),(0,Z.G)("esri/widgets/Feature/t9n/Feature")],fe.prototype,"messages",void 0),(0,n._)([(0,o.MZ)(),(0,Z.G)("esri/t9n/common")],fe.prototype,"messagesCommon",void 0),(0,n._)([(0,o.MZ)()],fe.prototype,"spatialReference",null),(0,n._)([(0,o.MZ)()],fe.prototype,"timeZone",null),(0,n._)([(0,o.MZ)({readOnly:!0})],fe.prototype,"title",null),(0,n._)([(0,o.MZ)()],fe.prototype,"visibleElements",void 0),(0,n._)([(0,s.w)("visibleElements")],fe.prototype,"castVisibleElements",null),(0,n._)([(0,o.MZ)()],fe.prototype,"map",null),(0,n._)([(0,o.MZ)()],fe.prototype,"view",null),(0,n._)([(0,o.MZ)({type:ce.A})],fe.prototype,"viewModel",void 0),fe=de=(0,n._)([(0,l.$)("esri.widgets.Feature")],fe);const me=fe},18258:(e,t,i)=>{i.d(t,{A:()=>a});var n=i(35143),r=i(46053),o=(i(81806),i(76460),i(47249),i(85842)),s=i(78583);let l=class extends s.A{constructor(e){super(e),this.description=null,this.title=null}};(0,n._)([(0,r.MZ)()],l.prototype,"description",void 0),(0,n._)([(0,r.MZ)()],l.prototype,"title",void 0),l=(0,n._)([(0,o.$)("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")],l);const a=l},1052:(e,t,i)=>{i.d(t,{A:()=>u});var n=i(35143),r=i(39356),o=i(91967),s=i(68134),l=i(46053),a=(i(81806),i(76460),i(47249),i(85842)),d=i(9912);let c=class extends o.A{constructor(e){super(e),this._loadingPromise=null,this.created=null,this.creator=null,this.destroyer=null,this.graphic=null,this.addHandles((0,s.watch)((()=>this.creator),(e=>{this._destroyContent(),this._createContent(e)}),s.initial))}destroy(){this._destroyContent()}get state(){return this._loadingPromise?"loading":"ready"}_destroyContent(){const{created:e,graphic:t,destroyer:i}=this;e&&t&&((0,d.AB)(i,{graphic:t}).catch((()=>null)),this._set("created",null))}async _createContent(e){const t=this.graphic;if(!t||!e)return;const i=(0,d.AB)(e,{graphic:t}).catch((()=>null));this._loadingPromise=i,this.notifyChange("state");const n=await i;i===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",n))}};(0,n._)([(0,l.MZ)({readOnly:!0})],c.prototype,"created",void 0),(0,n._)([(0,l.MZ)()],c.prototype,"creator",void 0),(0,n._)([(0,l.MZ)()],c.prototype,"destroyer",void 0),(0,n._)([(0,l.MZ)({type:r.A})],c.prototype,"graphic",void 0),(0,n._)([(0,l.MZ)({readOnly:!0})],c.prototype,"state",null),c=(0,n._)([(0,a.$)("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],c);const u=c},39492:(e,t,i)=>{i.d(t,{A:()=>M});var n=i(35143),r=(i(35238),i(39356)),o=i(91967),s=i(68134),l=i(79468),a=i(46053),d=(i(81806),i(76460),i(47249),i(85842)),c=(i(75900),i(56362),i(87015),i(81940),i(6929)),u=i(7198),p=(i(93616),i(53539)),h=i(66267),v=i(1052),f=i(38932),m=i(42450),_=i(12744),g=i(13904);let y=class extends o.A{constructor(e){super(e),this._abortController=null,this.expressionInfo=null,this.graphic=null,this.contentElement=null,this.contentElementViewModel=null,this.interceptor=null,this.location=null,this.view=null,this._cancelQuery=()=>{const{_abortController:e}=this;e&&e.abort(),this._abortController=null},this._createVM=()=>{var e,t;const i=null===(e=this.contentElement)||void 0===e?void 0:e.type;null===(t=this.contentElementViewModel)||void 0===t||t.destroy();const n="fields"===i?new f.A:"media"===i?new m.A:"text"===i?new v.A:null;this._set("contentElementViewModel",n)},this._compile=async()=>{this._cancelQuery();const e=new AbortController;this._abortController=e,await this._compileExpression(),this._abortController===e&&(this._abortController=null)},this._compileThrottled=(0,l.n)(this._compile,1,this),this._compileExpression=async()=>{const{expressionInfo:e,graphic:t,interceptor:i,spatialReference:n,map:r,location:o,view:s,_abortController:l}=this;if(!e||!t)return void this._set("contentElement",null);const a=await(0,_.lw)();if(l!==this._abortController)return;const d=await(0,_.U1)({arcade:a,expressionInfo:e,graphic:t,location:o,interceptor:i,map:r,spatialReference:n,view:s});if(!d||"esri.arcade.Dictionary"!==d.declaredClass)return void this._set("contentElement",null);const h=await d.castAsJsonAsync(null===l||void 0===l?void 0:l.signal),v=null===h||void 0===h?void 0:h.type,f="media"===v?u.A.fromJSON(h):"text"===v?p.A.fromJSON(h):"fields"===v?c.A.fromJSON(h):null;this._set("contentElement",f)},this.addHandles([(0,s.watch)((()=>[this.expressionInfo,this.graphic,this.map,this.spatialReference,this.view]),(()=>this._compileThrottled()),s.initial),(0,s.watch)((()=>[this.contentElement]),(()=>this._createVM()),s.initial)])}initialize(){this.addHandles(this._compileThrottled)}destroy(){var e;this._cancelQuery(),null!==(e=this.contentElementViewModel)&&void 0!==e&&e.destroy(),this._set("contentElementViewModel",null),this._set("contentElement",null)}get spatialReference(){var e,t;return null!==(e=null===(t=this.view)||void 0===t?void 0:t.spatialReference)&&void 0!==e?e:null}set spatialReference(e){this._override("spatialReference",e)}get state(){const{_abortController:e,contentElement:t,contentElementViewModel:i}=this;return e?"loading":t||i?"ready":"disabled"}get map(){var e,t;return null!==(e=null===(t=this.view)||void 0===t?void 0:t.map)&&void 0!==e?e:null}set map(e){this._override("map",e)}};(0,n._)([(0,a.MZ)()],y.prototype,"_abortController",void 0),(0,n._)([(0,a.MZ)({type:h.A})],y.prototype,"expressionInfo",void 0),(0,n._)([(0,a.MZ)({type:r.A})],y.prototype,"graphic",void 0),(0,n._)([(0,a.MZ)({readOnly:!0})],y.prototype,"contentElement",void 0),(0,n._)([(0,a.MZ)({readOnly:!0})],y.prototype,"contentElementViewModel",void 0),(0,n._)([(0,a.MZ)()],y.prototype,"interceptor",void 0),(0,n._)([(0,a.MZ)({type:g.A})],y.prototype,"location",void 0),(0,n._)([(0,a.MZ)()],y.prototype,"spatialReference",null),(0,n._)([(0,a.MZ)({readOnly:!0})],y.prototype,"state",null),(0,n._)([(0,a.MZ)()],y.prototype,"map",null),(0,n._)([(0,a.MZ)()],y.prototype,"view",void 0),y=(0,n._)([(0,d.$)("esri.widgets.Feature.FeatureExpression.FeatureExpressionViewModel")],y);const M=y},38932:(e,t,i)=>{i.d(t,{A:()=>u});var n=i(35143),r=i(91967),o=i(46053),s=(i(81806),i(76460),i(47249),i(85842)),l=i(81779),a=i(40585),d=i(9912);let c=class extends r.A{constructor(e){super(e),this.attributes=null,this.expressionInfos=null,this.description=null,this.fieldInfos=null,this.title=null}get formattedFieldInfos(){const{expressionInfos:e,fieldInfos:t}=this,i=[];return null!==t&&void 0!==t&&t.forEach((t=>{if(t.hasOwnProperty("visible")&&!t.visible)return;const n=t.clone();n.label=(0,d.bV)(n,e),i.push(n)})),i}};(0,n._)([(0,o.MZ)()],c.prototype,"attributes",void 0),(0,n._)([(0,o.MZ)({type:[l.A]})],c.prototype,"expressionInfos",void 0),(0,n._)([(0,o.MZ)()],c.prototype,"description",void 0),(0,n._)([(0,o.MZ)({type:[a.A]})],c.prototype,"fieldInfos",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],c.prototype,"formattedFieldInfos",null),(0,n._)([(0,o.MZ)()],c.prototype,"title",void 0),c=(0,n._)([(0,s.$)("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],c);const u=c},42450:(e,t,i)=>{i.d(t,{A:()=>f});var n=i(35143),r=i(91967),o=i(18690),s=i(46053),l=i(21403),a=(i(81806),i(85842)),d=i(40585),c=i(22431),u=i(9912),p=i(58287);const h={chartAnimation:!0};let v=class extends r.A{constructor(e){super(e),this.abilities={...h},this.activeMediaInfoIndex=0,this.attributes=null,this.description=null,this.fieldInfoMap=null,this.formattedAttributes=null,this.expressionAttributes=null,this.isAggregate=!1,this.layer=null,this.mediaInfos=null,this.popupTemplate=null,this.relatedInfos=null,this.title=null}castAbilities(e){return{...h,...e}}get activeMediaInfo(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}get formattedMediaInfos(){return this._formatMediaInfos()||[]}get formattedMediaInfoCount(){return this.formattedMediaInfos.length}setActiveMedia(e){this._setContentElementMedia(e)}next(){this._pageContentElementMedia(1)}previous(){this._pageContentElementMedia(-1)}_setContentElementMedia(e){const{formattedMediaInfoCount:t}=this,i=(e+t)%t;this.activeMediaInfoIndex=i}_pageContentElementMedia(e){const{activeMediaInfoIndex:t}=this,i=t+e;this._setContentElementMedia(i)}_formatMediaInfos(){var e,t,i,n,r;const{mediaInfos:s,layer:l}=this,a=null!==(e=this.attributes)&&void 0!==e?e:{},d=null!==(t=this.formattedAttributes)&&void 0!==t?t:{},c=null!==(i=this.expressionAttributes)&&void 0!==i?i:{},p=null!==(n=this.fieldInfoMap)&&void 0!==n?n:new Map;return null!==(r=null===s||void 0===s?void 0:s.map((e=>{const t=null===e||void 0===e?void 0:e.clone();if(!t)return null;if(t.title=(0,u.u2)({attributes:a,fieldInfoMap:p,globalAttributes:d,expressionAttributes:c,layer:l,text:t.title}),t.caption=(0,u.u2)({attributes:a,fieldInfoMap:p,globalAttributes:d,expressionAttributes:c,layer:l,text:t.caption}),t.altText=(0,u.u2)({attributes:a,fieldInfoMap:p,globalAttributes:d,expressionAttributes:c,layer:l,text:t.altText}),"image"===t.type){const{value:e}=t;return this._setImageValue({value:e,formattedAttributes:d,layer:l}),t.value.sourceURL?t:void 0}if("pie-chart"===t.type||"line-chart"===t.type||"column-chart"===t.type||"bar-chart"===t.type){const{value:e}=t;return this._setChartValue({value:e,chartType:t.type,attributes:a,formattedAttributes:d,layer:l,expressionAttributes:c}),t}return null})).filter(o.Ru))&&void 0!==r?r:[]}_setImageValue(e){var t;const i=null!==(t=this.fieldInfoMap)&&void 0!==t?t:new Map,{value:n,formattedAttributes:r,layer:o}=e,{linkURL:s,sourceURL:l}=n;if(l){const e=(0,u.MK)(l,o);n.sourceURL=(0,u.gd)({formattedAttributes:r,template:e,fieldInfoMap:i})}if(s){const e=(0,u.MK)(s,o);n.linkURL=(0,u.gd)({formattedAttributes:r,template:e,fieldInfoMap:i})}}_setChartValue(e){var t;const{value:i,attributes:n,formattedAttributes:r,chartType:o,layer:s,expressionAttributes:l}=e,{popupTemplate:a,relatedInfos:d}=this,{fields:c,normalizeField:p}=i,h=s;if(i.fields=(0,u.xL)(c,h),p&&(i.normalizeField=(0,u.A4)(p,h)),!c.some((e=>!!(null!=r[e]||(0,u.s$)(e)&&null!==d&&void 0!==d&&d.size))))return;const v=null!==(t=null===a||void 0===a?void 0:a.fieldInfos)&&void 0!==t?t:[];c.forEach(((e,t)=>{var s;const a=null===(s=i.colors)||void 0===s?void 0:s[t];if((0,u.s$)(e))return void(i.series=[...i.series,...this._getRelatedChartInfos({fieldInfos:v,fieldName:e,formattedAttributes:r,chartType:o,value:i,color:a})]);const d=this._getChartOption({value:i,attributes:n,chartType:o,formattedAttributes:r,expressionAttributes:l,fieldName:e,fieldInfos:v,color:a});i.series.push(d)}))}_getRelatedChartInfos(e){var t;const{fieldInfos:i,fieldName:n,formattedAttributes:r,chartType:o,value:s,color:l}=e,a=[],d=(0,p.kC)(n),c=d&&(null===(t=this.relatedInfos)||void 0===t?void 0:t.get(d.layerId.toString()));if(!c)return a;const{relatedFeatures:u,relation:h}=c;if(!h||!u)return a;const{cardinality:v}=h;return u.forEach((e=>{const{attributes:t}=e;t&&Object.keys(t).forEach((e=>{e===d.fieldName&&a.push(this._getChartOption({value:s,attributes:t,formattedAttributes:r,fieldName:n,chartType:o,relatedFieldName:e,hasMultipleRelatedFeatures:(null===u||void 0===u?void 0:u.length)>1,fieldInfos:i,color:l}))}))})),"one-to-many"===v||"many-to-many"===v?a:[a[0]]}_getTooltip(e){let{label:t,value:i,chartType:n}=e;return"pie-chart"===n?"".concat(t):"".concat(t,": ").concat(i)}_getChartOption(e){var t,i;const{value:n,attributes:r,formattedAttributes:o,expressionAttributes:s,fieldName:l,relatedFieldName:a,fieldInfos:h,chartType:v,hasMultipleRelatedFeatures:f,color:m}=e,_=this.layer,g=null!==(t=this.fieldInfoMap)&&void 0!==t?t:new Map,{normalizeField:y,tooltipField:M}=n,w=y?(0,u.s$)(y)?r[(0,p.kC)(y).fieldName]:r[y]:null,b=(0,u.Tt)(l)&&s&&void 0!==s[l]?s[l]:a&&void 0!==r[a]?r[a]:void 0!==r[l]?r[l]:o[l],I=new c.A({fieldName:l,color:m,value:void 0===b?null:b&&w?b/w:b});if((0,u.s$)(l)){var A,C,x,F,T;const e=g.get(l.toLowerCase()),t=M&&g.get(M.toLowerCase()),i=null!==(A=null===e||void 0===e?void 0:e.fieldName)&&void 0!==A?A:l,n=f&&M?(0,p.kC)(M).fieldName:null!==(C=null===t||void 0===t?void 0:t.fieldName)&&void 0!==C?C:M,s=f&&n?r[n]:null!==(x=null!==(F=null!==(T=o[n])&&void 0!==T?T:null===e||void 0===e?void 0:e.label)&&void 0!==F?F:null===e||void 0===e?void 0:e.fieldName)&&void 0!==x?x:a,d=f&&a?r[a]:o[i];return I.tooltip=this._getTooltip({label:s,value:d,chartType:v}),I}const E=(0,u.lm)(h,l),R=(0,u.A4)(l,_),Z=M&&void 0!==o[M]?o[M]:(0,u.bV)(E||new d.A({fieldName:R}),null===(i=this.popupTemplate)||void 0===i?void 0:i.expressionInfos),L=o[R];return I.tooltip=this._getTooltip({label:Z,value:L,chartType:v}),I}};(0,n._)([(0,s.MZ)()],v.prototype,"abilities",void 0),(0,n._)([(0,l.w)("abilities")],v.prototype,"castAbilities",null),(0,n._)([(0,s.MZ)()],v.prototype,"activeMediaInfoIndex",void 0),(0,n._)([(0,s.MZ)({readOnly:!0})],v.prototype,"activeMediaInfo",null),(0,n._)([(0,s.MZ)()],v.prototype,"attributes",void 0),(0,n._)([(0,s.MZ)()],v.prototype,"description",void 0),(0,n._)([(0,s.MZ)()],v.prototype,"fieldInfoMap",void 0),(0,n._)([(0,s.MZ)()],v.prototype,"formattedAttributes",void 0),(0,n._)([(0,s.MZ)()],v.prototype,"expressionAttributes",void 0),(0,n._)([(0,s.MZ)({readOnly:!0})],v.prototype,"formattedMediaInfos",null),(0,n._)([(0,s.MZ)()],v.prototype,"isAggregate",void 0),(0,n._)([(0,s.MZ)()],v.prototype,"layer",void 0),(0,n._)([(0,s.MZ)({readOnly:!0})],v.prototype,"formattedMediaInfoCount",null),(0,n._)([(0,s.MZ)()],v.prototype,"mediaInfos",void 0),(0,n._)([(0,s.MZ)()],v.prototype,"popupTemplate",void 0),(0,n._)([(0,s.MZ)()],v.prototype,"relatedInfos",void 0),(0,n._)([(0,s.MZ)()],v.prototype,"title",void 0),v=(0,n._)([(0,a.$)("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],v);const f=v},51007:(e,t,i)=>{i.d(t,{A:()=>L});var n=i(35143),r=(i(35238),i(39356));var o,s=i(91967),l=i(18690),a=i(5632),d=i(76460),c=i(50346),u=i(68134),p=i(79468),h=i(46053),v=i(21403),f=(i(81806),i(85842)),m=i(53539),_=i(67478),g=i(18258),y=i(1052),M=i(39492),w=i(38932),b=i(42450),I=i(65023),A=i(12744),C=i(9912),x=i(58287),F=i(13904);const T="content-view-models",E="relationship-view-models",R={attachmentsContent:!0,chartAnimation:!0,customContent:!0,expressionContent:!0,fieldsContent:!0,mediaContent:!0,textContent:!0,relationshipContent:!0};let Z=o=class extends((0,a.sA)(s.A)){constructor(e){super(e),this._error=null,this._featureAbortController=null,this._graphicChangedThrottled=(0,p.n)(this._graphicChanged,1,this),this._expressionAttributes=null,this._graphicExpressionAttributes=null,this.abilities={...R},this.content=null,this.contentViewModels=[],this.description=null,this.defaultPopupTemplateEnabled=!1,this.formattedAttributes=null,this.lastEditInfo=null,this.location=null,this.relatedInfos=new Map,this.title="",this.view=null,this._isAllowedContentType=e=>{const{abilities:t}=this;return"attachments"===e.type&&!!t.attachmentsContent||"custom"===e.type&&!!t.customContent||"fields"===e.type&&!!t.fieldsContent||"media"===e.type&&!!t.mediaContent||"text"===e.type&&!!t.textContent||"expression"===e.type&&!!t.expressionContent||"relationship"===e.type&&!!t.relationshipContent},this.addHandles((0,u.watch)((()=>[this.graphic,this._effectivePopupTemplate,this.abilities,this.timeZone]),(()=>this._graphicChangedThrottled()),u.initial))}initialize(){this.addHandles(this._graphicChangedThrottled)}destroy(){this._clear(),this._cancelFeatureQuery(),this._error=null,this.graphic=null,this._destroyContentViewModels(),this.relatedInfos.clear()}get _effectivePopupTemplate(){return null!=this.graphic?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):null}get _fieldInfoMap(){return(0,C.n_)((0,C.ld)(this._effectivePopupTemplate),this._sourceLayer)}get _sourceLayer(){return(0,C.JF)(this.graphic)}castAbilities(e){return{...R,...e}}get isTable(){var e;return(null===(e=this._sourceLayer)||void 0===e?void 0:e.isTable)||!1}get state(){return this.graphic?this._error?"error":this.waitingForContent?"loading":"ready":"disabled"}set graphic(e){var t;this._set("graphic",null!==(t=null===e||void 0===e?void 0:e.clone())&&void 0!==t?t:null)}get spatialReference(){var e,t;return null!==(e=null===(t=this.view)||void 0===t?void 0:t.spatialReference)&&void 0!==e?e:null}set spatialReference(e){this._override("spatialReference",e)}get timeZone(){var e,t;return null!==(e=null===(t=this.view)||void 0===t?void 0:t.timeZone)&&void 0!==e?e:_.qU}set timeZone(e){this._overrideIfSome("timeZone",e)}get map(){var e;return(null===(e=this.view)||void 0===e?void 0:e.map)||null}set map(e){this._override("map",e)}get waitingForContent(){return!!this._featureAbortController}setActiveMedia(e,t){const i=this.contentViewModels[e];i instanceof b.A&&i.setActiveMedia(t)}nextMedia(e){const t=this.contentViewModels[e];t instanceof b.A&&t.next()}previousMedia(e){const t=this.contentViewModels[e];t instanceof b.A&&t.previous()}async updateGeometry(){var e;const{graphic:t,spatialReference:i,_sourceLayer:n}=this;await(null===n||void 0===n?void 0:n.load());const r=null===n||void 0===n?void 0:n.objectIdField;if(!r||!t||!n)return;const o=null===t||void 0===t||null===(e=t.attributes)||void 0===e?void 0:e[r];if(null==o)return;const s=[o];if(!t.geometry){const e=await(0,C.DU)({layer:n,graphic:t,outFields:[],objectIds:s,returnGeometry:!0,spatialReference:i}),r=null===e||void 0===e?void 0:e.geometry;r&&(t.geometry=r)}}_clear(){this._set("title",""),this._set("content",null),this._set("formattedAttributes",null)}async _graphicChanged(){this._cancelFeatureQuery(),this._error=null,this._clear();const{graphic:e}=this;if(!e)return;const t=new AbortController;this._featureAbortController=t;try{await this._queryFeature({signal:t.signal})}catch(i){(0,c.zf)(i)||(this._error=i,d.A.getLogger(this).error("error","The popupTemplate could not be displayed for this feature.",{error:i,graphic:e,popupTemplate:this._effectivePopupTemplate}))}this._featureAbortController===t&&(this._featureAbortController=null)}_cancelFeatureQuery(){const{_featureAbortController:e}=this;e&&e.abort(),this._featureAbortController=null}_compileContentElement(e,t){return"attachments"===e.type?this._compileAttachments(e,t):"custom"===e.type?this._compileCustom(e,t):"fields"===e.type?this._compileFields(e,t):"media"===e.type?this._compileMedia(e,t):"text"===e.type?this._compileText(e,t):"expression"===e.type?this._compileExpression(e,t):"relationship"===e.type?this._compileRelationship(e,t):void 0}_compileContent(e){if(this._destroyContentViewModels(),this.graphic)return Array.isArray(e)?e.filter(this._isAllowedContentType).map(((e,t)=>this._compileContentElement(e,t))).filter(l.Ru):"string"==typeof e?this._compileText(new m.A({text:e}),0).text:e}_destroyContentViewModels(){this.removeHandles(E),this.removeHandles(T),this.contentViewModels.forEach((e=>e&&!e.destroyed&&e.destroy())),this._set("contentViewModels",[])}_matchesFeature(e,t){var i;const n=null===e||void 0===e||null===(i=e.graphic)||void 0===i?void 0:i.getObjectId(),r=null===t||void 0===t?void 0:t.getObjectId();return null!=n&&null!=r&&n===r}_setRelatedFeaturesViewModels(e){let{relatedFeatureViewModels:t,relatedFeatures:i,map:n}=e;const{view:r,spatialReference:s}=this;null!==i&&void 0!==i&&i.filter(Boolean).forEach((e=>{t.some((t=>this._matchesFeature(t,e)))||t.add(new o({abilities:{relationshipContent:!1},map:n,view:r,spatialReference:s,graphic:e}))})),t.forEach((e=>{const n=null===i||void 0===i?void 0:i.find((t=>this._matchesFeature(e,t)));n||t.remove(e)}))}_setExpressionContentVM(e,t){const i=this.formattedAttributes,{contentElement:n,contentElementViewModel:r}=e,o=null===n||void 0===n?void 0:n.type;r&&o&&("fields"===o&&(this._createFieldsFormattedAttributes({contentElement:n,contentElementIndex:t,formattedAttributes:i}),r.set(this._createFieldsVMParams(n,t))),"media"===o&&(this._createMediaFormattedAttributes({contentElement:n,contentElementIndex:t,formattedAttributes:i}),r.set(this._createMediaVMParams(n,t))),"text"===o&&r.set(this._createTextVMParams(n)))}_compileRelationship(e,t){const{displayCount:i,orderByFields:n,relationshipId:r,title:o,description:s}=e,{_sourceLayer:l,graphic:a,map:d}=this;if(!(0,C.sS)(l))return;const c=new I.A({displayCount:i,graphic:a,orderByFields:n,relationshipId:r,layer:l,map:d,...this._compileTitleAndDesc({title:o,description:s})});return this.contentViewModels[t]=c,this.addHandles((0,u.on)((()=>c.relatedFeatures),"change",(()=>this._setRelatedFeaturesViewModels(c))),E),e}_compileExpression(e,t){const{expressionInfo:i}=e,{graphic:n,map:r,spatialReference:s,view:l,location:a}=this,d=new M.A({expressionInfo:i,graphic:n,interceptor:o.interceptor,map:r,spatialReference:s,view:l,location:a});return this.contentViewModels[t]=d,this.addHandles((0,u.watch)((()=>d.contentElementViewModel),(()=>this._setExpressionContentVM(d,t)),u.initial),T),e}_compileAttachments(e,t){const{graphic:i}=this,{description:n,title:r}=e;return this.contentViewModels[t]=new g.A({graphic:i,...this._compileTitleAndDesc({title:r,description:n})}),e}_compileCustom(e,t){const{graphic:i}=this,{creator:n,destroyer:r}=e;return this.contentViewModels[t]=new y.A({graphic:i,creator:n,destroyer:r}),e}_compileTitleAndDesc(e){let{title:t,description:i}=e;const{_fieldInfoMap:n,_sourceLayer:r,graphic:o,formattedAttributes:s}=this,l=null===o||void 0===o?void 0:o.attributes,a=this._expressionAttributes,d=s.global;return{title:(0,C.u2)({attributes:l,fieldInfoMap:n,globalAttributes:d,expressionAttributes:a,layer:r,text:t}),description:(0,C.u2)({attributes:l,fieldInfoMap:n,globalAttributes:d,expressionAttributes:a,layer:r,text:i})}}_createFieldsVMParams(e,t){const i=this._effectivePopupTemplate,n=this.formattedAttributes,r={...null===n||void 0===n?void 0:n.global,...null===n||void 0===n?void 0:n.content[t]},o=(null===e||void 0===e?void 0:e.fieldInfos)||(null===i||void 0===i?void 0:i.fieldInfos),s=null===o||void 0===o?void 0:o.filter((e=>{let{fieldName:t}=e;return(0,C.Tt)(t)||(0,C.s$)(t)||r.hasOwnProperty(t)})),l=null===i||void 0===i?void 0:i.expressionInfos,{description:a,title:d}=e;return{attributes:r,expressionInfos:l,fieldInfos:s,...this._compileTitleAndDesc({title:d,description:a})}}_compileFields(e,t){const i=e.clone(),n=new w.A(this._createFieldsVMParams(e,t));return this.contentViewModels[t]=n,i.fieldInfos=n.formattedFieldInfos.slice(0),i}_createMediaVMParams(e,t){var i;const{abilities:n,graphic:r,_fieldInfoMap:o,_effectivePopupTemplate:s,relatedInfos:l,_sourceLayer:a,_expressionAttributes:d}=this,c=this.formattedAttributes,u=null!==(i=null===r||void 0===r?void 0:r.attributes)&&void 0!==i?i:{},{description:p,mediaInfos:h,title:v}=e;return{abilities:{chartAnimation:n.chartAnimation},activeMediaInfoIndex:e.activeMediaInfoIndex||0,attributes:u,isAggregate:null===r||void 0===r?void 0:r.isAggregate,layer:a,fieldInfoMap:o,formattedAttributes:{...null===c||void 0===c?void 0:c.global,...null===c||void 0===c?void 0:c.content[t]},expressionAttributes:d,mediaInfos:h,popupTemplate:s,relatedInfos:l,...this._compileTitleAndDesc({title:v,description:p})}}_compileMedia(e,t){const i=e.clone(),n=new b.A(this._createMediaVMParams(e,t));return i.mediaInfos=n.formattedMediaInfos.slice(0),this.contentViewModels[t]=n,i}_createTextVMParams(e){const{graphic:t,_fieldInfoMap:i,_sourceLayer:n,_expressionAttributes:r}=this;if(e&&e.text){var o,s,l;const a=null!==(o=null===t||void 0===t?void 0:t.attributes)&&void 0!==o?o:{},d=null!==(s=null===(l=this.formattedAttributes)||void 0===l?void 0:l.global)&&void 0!==s?s:{};e.text=(0,C.u2)({attributes:a,fieldInfoMap:i,globalAttributes:d,expressionAttributes:r,layer:n,text:e.text})}return{graphic:t,creator:e.text}}_compileText(e,t){const i=e.clone();return this.contentViewModels[t]=new y.A(this._createTextVMParams(i)),i}_compileLastEditInfo(){const{_effectivePopupTemplate:e,_sourceLayer:t,graphic:i,timeZone:n}=this;if(!e)return;const{lastEditInfoEnabled:r}=e,o=null===t||void 0===t?void 0:t.editFieldsInfo;return r&&o?(0,C.a$)(o,null===i||void 0===i?void 0:i.attributes,n,t):void 0}_compileTitle(e){var t,i,n;const{_fieldInfoMap:r,_sourceLayer:o,graphic:s,_expressionAttributes:l}=this,a=null!==(t=null===s||void 0===s?void 0:s.attributes)&&void 0!==t?t:{},d=null!==(i=null===(n=this.formattedAttributes)||void 0===n?void 0:n.global)&&void 0!==i?i:{};return(0,C.u2)({attributes:a,fieldInfoMap:r,globalAttributes:d,expressionAttributes:l,layer:o,text:e})}async _getTitle(){const{_effectivePopupTemplate:e,graphic:t}=this;if(!t)return null;const i=null===e||void 0===e?void 0:e.title;return(0,C.AB)(i,{graphic:t})}async _getContent(){const{_effectivePopupTemplate:e,graphic:t}=this;if(!t)return null;const i=null===e||void 0===e?void 0:e.content;return(0,C.AB)(i,{graphic:t})}async _queryFeature(e){const{_featureAbortController:t,_sourceLayer:i,graphic:n,_effectivePopupTemplate:r}=this,s=this.map,l=this.view,a=this.spatialReference,d=this.location;if(t!==this._featureAbortController||!n)return;await(0,C.c3)({graphic:n,popupTemplate:r,layer:i,spatialReference:a},e);const{content:{value:u},title:{value:p}}=await(0,c.Lx)({content:this._getContent(),title:this._getTitle()}),{expressionAttributes:{value:h}}=await(0,c.Lx)({checkForRelatedFeatures:this._checkForRelatedFeatures(e),expressionAttributes:(0,A.XL)({expressionInfos:null===r||void 0===r?void 0:r.expressionInfos,spatialReference:a,graphic:n,map:s,interceptor:o.interceptor,view:l,options:e,location:d})});t===this._featureAbortController&&n&&(this._expressionAttributes=h,this._graphicExpressionAttributes={...n.attributes,...h},this._set("formattedAttributes",this._createFormattedAttributes(u)),this._set("title",this._compileTitle(p)),this._set("lastEditInfo",this._compileLastEditInfo()||null),this._set("content",this._compileContent(u)||null))}_createMediaFormattedAttributes(e){let{contentElement:t,contentElementIndex:i,formattedAttributes:n}=e;const{_effectivePopupTemplate:r,graphic:o,relatedInfos:s,_sourceLayer:l,_fieldInfoMap:a,_graphicExpressionAttributes:d,timeZone:c}=this;n.content[i]=(0,C.x1)({fieldInfos:null===r||void 0===r?void 0:r.fieldInfos,graphic:o,attributes:{...d,...t.attributes},layer:l,fieldInfoMap:a,relatedInfos:s,timeZone:c})}_createFieldsFormattedAttributes(e){let{contentElement:t,contentElementIndex:i,formattedAttributes:n}=e;if(t.fieldInfos){const{graphic:e,relatedInfos:r,_sourceLayer:o,_fieldInfoMap:s,_graphicExpressionAttributes:l,timeZone:a}=this;n.content[i]=(0,C.x1)({fieldInfos:t.fieldInfos,graphic:e,attributes:{...l,...t.attributes},layer:o,fieldInfoMap:s,relatedInfos:r,timeZone:a})}}_createFormattedAttributes(e){const{_effectivePopupTemplate:t,graphic:i,relatedInfos:n,_sourceLayer:r,_fieldInfoMap:o,_graphicExpressionAttributes:s,timeZone:l}=this,a=null===t||void 0===t?void 0:t.fieldInfos,d={global:(0,C.x1)({fieldInfos:a,graphic:i,attributes:s,layer:r,fieldInfoMap:o,relatedInfos:n,timeZone:l}),content:[]};return Array.isArray(e)&&e.forEach(((e,t)=>{"fields"===e.type&&this._createFieldsFormattedAttributes({contentElement:e,contentElementIndex:t,formattedAttributes:d}),"media"===e.type&&this._createMediaFormattedAttributes({contentElement:e,contentElementIndex:t,formattedAttributes:d})})),d}_checkForRelatedFeatures(e){const{graphic:t,_effectivePopupTemplate:i}=this;return this._queryRelatedInfos(t,(0,C.ld)(i),e)}async _queryRelatedInfos(e,t,i){const{relatedInfos:n,_sourceLayer:r}=this;n.clear();const o=null!=(null===r||void 0===r?void 0:r.associatedLayer)?await(null===r||void 0===r?void 0:r.associatedLayer.load(i)):r;if(!o||!e)return;const s=t.filter((e=>e&&(0,C.s$)(e.fieldName)));if(null===s||void 0===s||!s.length)return;t.forEach((e=>this._configureRelatedInfo(e,o)));const l=await(0,x.Xx)({relatedInfos:n,layer:o},i);Object.keys(l).forEach((e=>{var t;const i=n.get(e.toString()),r=null===(t=l[e])||void 0===t?void 0:t.value;i&&r&&(i.layerInfo=r.data)}));const a=await(0,x.hM)({graphic:e,relatedInfos:n,layer:o},i);Object.keys(a).forEach((e=>{var t;(0,x.nD)(null===(t=a[e])||void 0===t?void 0:t.value,n.get(e.toString()))}))}_configureRelatedInfo(e,t){const{relatedInfos:i}=this,n=(0,x.kC)(e.fieldName);if(!n)return;const{layerId:r,fieldName:o}=n;if(!r)return;const s=i.get(r.toString())||(0,x.cl)(r,t);s&&((0,x.LI)({relatedInfo:s,fieldName:o,fieldInfo:e}),this.relatedInfos.set(r,s))}};Z.interceptor=new class{constructor(e,t){this.preLayerQueryCallback=e,this.preRequestCallback=t,this.preLayerQueryCallback||(this.preLayerQueryCallback=e=>{}),this.preRequestCallback||(this.preLayerQueryCallback=e=>{})}}(C.Ao,C.q6),(0,n._)([(0,h.MZ)()],Z.prototype,"_error",void 0),(0,n._)([(0,h.MZ)()],Z.prototype,"_featureAbortController",void 0),(0,n._)([(0,h.MZ)({readOnly:!0})],Z.prototype,"_effectivePopupTemplate",null),(0,n._)([(0,h.MZ)({readOnly:!0})],Z.prototype,"_fieldInfoMap",null),(0,n._)([(0,h.MZ)({readOnly:!0})],Z.prototype,"_sourceLayer",null),(0,n._)([(0,h.MZ)()],Z.prototype,"abilities",void 0),(0,n._)([(0,v.w)("abilities")],Z.prototype,"castAbilities",null),(0,n._)([(0,h.MZ)({readOnly:!0})],Z.prototype,"content",void 0),(0,n._)([(0,h.MZ)({readOnly:!0})],Z.prototype,"contentViewModels",void 0),(0,n._)([(0,h.MZ)()],Z.prototype,"description",void 0),(0,n._)([(0,h.MZ)({type:Boolean})],Z.prototype,"defaultPopupTemplateEnabled",void 0),(0,n._)([(0,h.MZ)({readOnly:!0})],Z.prototype,"isTable",null),(0,n._)([(0,h.MZ)({readOnly:!0})],Z.prototype,"state",null),(0,n._)([(0,h.MZ)({readOnly:!0})],Z.prototype,"formattedAttributes",void 0),(0,n._)([(0,h.MZ)({type:r.A,value:null})],Z.prototype,"graphic",null),(0,n._)([(0,h.MZ)({readOnly:!0})],Z.prototype,"lastEditInfo",void 0),(0,n._)([(0,h.MZ)({type:F.A})],Z.prototype,"location",void 0),(0,n._)([(0,h.MZ)({readOnly:!0})],Z.prototype,"relatedInfos",void 0),(0,n._)([(0,h.MZ)()],Z.prototype,"spatialReference",null),(0,n._)([(0,h.MZ)()],Z.prototype,"timeZone",null),(0,n._)([(0,h.MZ)({readOnly:!0})],Z.prototype,"title",void 0),(0,n._)([(0,h.MZ)()],Z.prototype,"map",null),(0,n._)([(0,h.MZ)({readOnly:!0})],Z.prototype,"waitingForContent",null),(0,n._)([(0,h.MZ)()],Z.prototype,"view",void 0),Z=o=(0,n._)([(0,f.$)("esri.widgets.Feature.FeatureViewModel")],Z);const L=Z},54062:(e,t,i)=>{i.d(t,{A:()=>r});const n="esri-feature",r={base:n,container:"".concat(n,"__size-container"),title:"".concat(n,"__title"),main:"".concat(n,"__main-container"),btn:"".concat(n,"__button"),icon:"".concat(n,"__icon"),content:"".concat(n,"__content"),contentNode:"".concat(n,"__content-node"),contentNodeText:"".concat(n,"__content-node--text"),contentElement:"".concat(n,"__content-element"),text:"".concat(n,"__text"),lastEditedInfo:"".concat(n,"__last-edited-info"),fields:"".concat(n,"__fields"),fieldHeader:"".concat(n,"__field-header"),fieldData:"".concat(n,"__field-data"),fieldDataDate:"".concat(n,"__field-data--date"),loadingSpinnerContainer:"".concat(n,"__loading-container"),spinner:"".concat(n,"__loading-spinner")}},30899:(e,t,i)=>{i.d(t,{j:()=>a});var n=i(35143),r=(i(76460),i(81806),i(47249),i(50076),i(85842)),o=i(54062),s=i(95752),l=i(54761);const a=e=>{let t=class extends e{constructor(){super(...arguments),this.renderNodeContent=e=>(0,s.p4)(e)&&!e.destroyed?(0,l.K)("div",{class:o.A.contentNode,key:e},e.render()):e instanceof HTMLElement?(0,l.K)("div",{afterCreate:this._attachToNode,bind:e,class:o.A.contentNode,key:e}):(0,s.xk)(e)?(0,l.K)("div",{afterCreate:this._attachToNode,bind:e.domNode,class:o.A.contentNode,key:e}):null}_attachToNode(e){e.appendChild(this)}};return t=(0,n._)([(0,r.$)("esri.widgets.Feature.ContentMixin")],t),t}},12744:(e,t,i)=>{i.d(t,{U1:()=>p,XL:()=>h,lw:()=>c});var n=i(76460),r=i(50346),o=i(38451),s=i(9912),l=i(98108);const a=()=>n.A.getLogger("esri.widgets.Feature.support.arcadeFeatureUtils");function d(e){return"string"==typeof e?(0,s.Uu)((0,s.bG)(e)):Array.isArray(e)?function(e){return'<ul class="esri-widget__list">'.concat(e.map((e=>"<li>".concat("string"==typeof e?(0,s.Uu)((0,s.bG)(e)):e,"</li>"))).join(""),"</ul>")}(e):"esri.arcade.Dictionary"===(null===e||void 0===e?void 0:e.declaredClass)?function(e){const t=e.keys().map((t=>{const i=e.field(t);return"<tr><th>".concat(t,"</th><td>").concat("string"==typeof i?(0,s.Uu)((0,s.bG)(i)):i,"</td></tr>")})).join("");return'<table class="'.concat(l.D.table,'">').concat(t,"</table>")}(e):e}function c(){return Promise.all([i.e(3620),i.e(30550)]).then(i.bind(i,30550))}async function u(e){let{graphic:t,view:i,options:n}=e;const{isAggregate:r,layer:o}=t;if(!r||!o||"2d"!==(null===i||void 0===i?void 0:i.type))return[];const s=await i.whenLayerView(o);if(!function(e){return"createQuery"in e&&"queryFeatures"in e}(s))return[];const l=s.createQuery(),a=t.getObjectId();l.aggregateIds=null!=a?[a]:[];const{features:d}=await s.queryFeatures(l,n);return d}async function p(e){var t,i,n;let{expressionInfo:r,arcade:s,interceptor:l,spatialReference:d,map:c,graphic:p,location:h,view:v,options:f}=e;if(null===r||void 0===r||!r.expression)return null;const{isAggregate:m}=p,_=null!==(t=p.sourceLayer||p.layer)&&void 0!==t?t:void 0,g=m?"feature-reduction-popup":"popup",y=s.createArcadeProfile(g),M=s.createArcadeExecutor(r.expression,y).catch((e=>a().error("arcade-executor-error",{error:e,expressionInfo:r}))),[w,b]=await Promise.all([u({graphic:p,view:v,options:f}),M]);if(!b)return null;const I="feature-reduction-popup"===g?function(e){let{layer:t,aggregatedFeatures:i,interceptor:n}=e;const{fields:r,objectIdField:s,geometryType:l,spatialReference:a,displayField:d}=t;return new o.default({fields:r,objectIdField:s,geometryType:l,spatialReference:a,displayField:d,interceptor:n,..."feature"===t.type?{templates:t.templates,typeIdField:t.typeIdField,types:t.types}:null,source:i})}({layer:_,aggregatedFeatures:w,interceptor:l}):void 0,A={..."feature-reduction-popup"===g?{$aggregatedFeatures:I}:{$datastore:null===_||void 0===_?void 0:_.url,$layer:"feature"===(null===_||void 0===_?void 0:_.type)||"subtype-sublayer"===(null===_||void 0===_?void 0:_.type)?_:"scene"===(null===_||void 0===_?void 0:_.type)&&null!=_.associatedLayer?_.associatedLayer:void 0,$map:c,$userInput:h,$graph:"knowledge-graph-sublayer"===(null===_||void 0===_?void 0:_.type)?null===_||void 0===_||null===(i=_.parentCompositeLayer)||void 0===i?void 0:i.knowledgeGraph:void 0},$feature:p},C={abortSignal:null!==(n=null===f||void 0===f?void 0:f.signal)&&void 0!==n?n:void 0,interceptor:null!==l&&void 0!==l?l:void 0,rawOutput:!0,spatialReference:null!==d&&void 0!==d?d:void 0,timeZone:null===v||void 0===v?void 0:v.timeZone};return await b.executeAsync(A,C).catch((e=>a().error("arcade-execution-error",{error:e,graphic:p,expressionInfo:r}))).finally((()=>null===I||void 0===I?void 0:I.destroy()))}async function h(e){let{expressionInfos:t,spatialReference:i,graphic:n,interceptor:o,map:s,view:l,location:a,options:u}=e;if(null===t||void 0===t||!t.length)return{};const h=await c(),v={};for(const r of t)v["expression/".concat(r.name)]=p({expressionInfo:r,arcade:h,interceptor:o,spatialReference:i,map:s,graphic:n,location:a,view:l,options:u});const f=await(0,r.Lx)(v),m={};for(const r in f)m[r]=d(f[r].value);return m}},58287:(e,t,i)=>{i.d(t,{LI:()=>b,Xx:()=>M,cl:()=>_,hM:()=>w,kC:()=>m,nD:()=>g});var n=i(3825),r=i(18690),o=i(50076),s=i(76460),l=i(50346),a=i(53430),d=(i(81806),i(89551),i(14009)),c=(i(86560),i(55171),i(90534),i(31633),i(34111),i(80963),i(42294),i(15941),i(76797),i(89189),i(66388),i(13904),i(65215),i(23701),i(73548),i(13312),i(14556),i(35238),i(29234),i(77725),i(68295)),u=(i(88084),i(9708),i(58289)),p=(i(58672),i(21820)),h=i(9912);const v=()=>s.A.getLogger("esri.widgets.Feature.support.relatedFeatureUtils"),f=new Map;function m(e){if(!(0,h.s$)(e))return null;const[t,i]=e.split("/").slice(1);return{layerId:t,fieldName:i}}function _(e,t){const i=function(e,t){if(!t.relationships)return null;let i=null;const{relationships:n}=t;return n.some((t=>t.id===parseInt(e,10)&&(i=t,!0))),i}(e,t);if(i)return{url:"".concat(t.url,"/").concat(i.relatedTableId),sourceSpatialReference:t.spatialReference,relation:i,relatedFields:[],outStatistics:[]}}function g(e,t){if(!t)return;if(!e)return;const{features:i,statsFeatures:n}=e,r=null===i||void 0===i?void 0:i.value;t.relatedFeatures=r?r.features:[];const o=null===n||void 0===n?void 0:n.value;t.relatedStatsFeatures=o?o.features:[]}async function y(e,t,i,n){const o=i.layerId.toString(),{layerInfo:s,relation:p,relatedFields:h,outStatistics:v,url:f,sourceSpatialReference:m}=t,_=function(e){return e?(0,r.Am)(e):void 0}(h),g=function(e){return e?(0,r.Am)(e,((e,t)=>JSON.stringify(e.toJSON())===JSON.stringify(t.toJSON()))):void 0}(v);if(!s||!p)return null;const y=function(e){var t;let{originRelationship:i,relationships:n,layerId:r}=e;return null!==(t=n.find((e=>{let{relatedTableId:t,id:n}=e;return"".concat(t)===r&&n===(null===i||void 0===i?void 0:i.id)})))&&void 0!==t?t:null}({originRelationship:p,relationships:s.relationships,layerId:o});if(null!==y&&void 0!==y&&y.relationshipTableId&&y.keyFieldInRelationshipTable){const t=(await function(e,t,i,n){var r,o;const s=new u.default;return s.outFields=["*"],s.relationshipId="number"==typeof t.id?t.id:parseInt(t.id,10),s.objectIds=[e.attributes[i.objectIdField]],null!==(r=null===(o=i.queryRelatedFeatures)||void 0===o?void 0:o.call(i,s,n))&&void 0!==r?r:Promise.resolve({})}(e,y,i,n))[e.attributes[i.objectIdField]];if(!t)return null;const r=t.features.map((e=>e.attributes[s.objectIdField]));if(null!==g&&void 0!==g&&g.length&&s.supportsStatistics){const e=new c.A;e.where=function(e,t,i){let n=0;const r=[];for(;n<t.length;)r.push("".concat(e," IN (").concat(t.slice(n,i+n),")")),n+=i;return r.join(" OR ")}(s.objectIdField,r,1e3),e.outFields=_,e.outStatistics=g,e.sourceSpatialReference=m;const i={features:Promise.resolve(t),statsFeatures:(0,d.s)(f,e)};return(0,l.Lx)(i)}}const M=null===y||void 0===y?void 0:y.keyField;if(M){const t=(0,a.WA)(function(e,t){if(null!=e){t=t.toLowerCase();for(const i of e)if(i&&i.name.toLowerCase()===t)return i}return null}(s.fields,M)),i=function(e,t){const i=t.toLowerCase();for(const n in e)if(n.toLowerCase()===i)return e[n];return null}(e.attributes,p.keyField),r=t?"".concat(M,"=").concat(i):"".concat(M,"='").concat(i,"'"),o=(0,d.s)(f,new c.A({where:r,outFields:_,sourceSpatialReference:m}),n),u=null!==g&&void 0!==g&&g.length&&s.supportsStatistics?(0,d.s)(f,new c.A({where:r,outFields:_,outStatistics:g,sourceSpatialReference:m}),n):null,h={features:o};return u&&(h.statsFeatures=u),(0,l.Lx)(h)}return null}function M(e,t){let{relatedInfos:i,layer:r}=e;const s={};return i.forEach(((e,t)=>{const{relation:i}=e;if(!i){const e=new o.A("relation-required","A relation is required on a layer to retrieve related records.");throw v().error(e),e}const{relatedTableId:l}=i;if("number"!=typeof l){const e=new o.A("A related table ID is required on a layer to retrieve related records.");throw v().error(e),e}const a="".concat(r.url,"/").concat(l),d=f.get(a),c=null!==d&&void 0!==d?d:function(e,t){return(0,n.A)(e,{query:{f:"json"},signal:null===t||void 0===t?void 0:t.signal})}(a);d||f.set(a,c),s[t]=c})),(0,l.qr)((0,l.Lx)(s),t)}function w(e,t){let{graphic:i,relatedInfos:n,layer:r}=e;const o={};return n.forEach(((e,n)=>{e.layerInfo&&(o[n]=y(i,e,r,t))})),(0,l.Lx)(o)}function b(e){var t;let{relatedInfo:i,fieldName:n,fieldInfo:r}=e;if(null!==(t=i.relatedFields)&&void 0!==t&&t.push(n),r.statisticType){var o;const e=new p.A({statisticType:r.statisticType,onStatisticField:n,outStatisticFieldName:n});null===(o=i.outStatistics)||void 0===o||o.push(e)}}},95843:(e,t,i)=>{i.d(t,{Q:()=>o});var n=i(88685);const r=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];function o(e,t){if("string"!=typeof t||!t)return t;const i=r.find((e=>e.pattern.test(t)));if(!i)return t;const o=t.match(i.pattern),s=o&&o[2],l=(0,n.HC)((0,n.HC)(i.label,{messages:e,hierPart:s}),{appName:i.appName}),a=i.target?' target="'.concat(i.target,'"'):"",d="_blank"===i.target?' rel="noreferrer"':"";return t.replace(i.pattern,"<a".concat(a,' href="$1"').concat(d,">").concat(l,"</a>"))}},95752:(e,t,i)=>{i.d(t,{p4:()=>n,xk:()=>r});i(20459),i(54761),i(76099);function n(e){return e&&"function"==typeof e.render}function r(e){return e&&"function"==typeof e.postMixInProperties&&"function"==typeof e.buildRendering&&"function"==typeof e.postCreate&&"function"==typeof e.startup}}}]);
//# sourceMappingURL=49963.87760796.chunk.js.map